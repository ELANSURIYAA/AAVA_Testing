```python
=============================================
Author:        Ascendion AVA+
Created on:    10-Apr-2025
Description:   Extracts healthcare plan data, applies marketing eligibility logic, joins provider network details, and exports the final dataset for marketing campaign use.
=============================================

import logging
import pandas as pd
import sqlalchemy
from sqlalchemy import create_engine

# Configure logging
logging.basicConfig(level=logging.INFO, format='%(asctime)s %(levelname)s %(message)s')

# --- SAS Equivalent: libname tdata teradata ---
def connect_to_teradata():
    """
    Establishes a secure connection to Teradata using SQLAlchemy.
    """
    logging.info("Step 1: Secure Teradata connection using metadata-authenticated libref")
    try:
        # Replace with your Teradata connection string and credentials
        teradata_conn_str = "teradata://username:password@your_server_name/database"
        engine = create_engine(teradata_conn_str)
        connection = engine.connect()
        logging.info("Teradata connection established successfully.")
        return connection
    except Exception as e:
        logging.error(f"Failed to connect to Teradata: {e}")
        raise

# --- SAS Equivalent: proc sql; create table work.marketing_extract as ... ---
def create_marketing_extract(connection):
    """
    Creates a work table with enriched data and business rules.
    """
    logging.info("Step 2: Create work table with enriched data and business rules")
    try:
        sql_query = """
        SELECT 
            hp.member_id,
            TRIM(hp.member_first_name) || ' ' || TRIM(hp.member_last_name) AS member_full_name,
            hp.member_age,
            CASE 
                WHEN hp.member_age BETWEEN 25 AND 35 THEN 'YOUNG_ADULT'
                WHEN hp.member_age BETWEEN 36 AND 50 THEN 'MID_AGE'
                WHEN hp.member_age > 50 THEN 'SENIOR'
                ELSE 'UNKNOWN'
            END AS age_group,
            hp.plan_id,
            hp.plan_type,
            hp.region,
            pn.network_type,
            UPPER(hp.plan_type) || '-' || hp.region AS marketing_segment,
            -- Campaign eligibility logic
            CASE 
                WHEN hp.plan_status = 'ACTIVE' 
                     AND hp.member_age BETWEEN 25 AND 60 
                     AND hp.plan_type IN ('PPO', 'HMO') 
                     AND hp.region IN ('WEST', 'SOUTH')
                     AND pn.network_type = 'IN_NETWORK'
                THEN 1
                ELSE 0
            END AS is_campaign_eligible
        FROM tdata.healthcare_plans hp
        LEFT JOIN tdata.provider_network pn
            ON hp.plan_id = pn.plan_id
        WHERE hp.plan_status = 'ACTIVE'
          AND hp.member_age IS NOT NULL
        """
        df = pd.read_sql(sql_query, connection)
        logging.info(f"marketing_extract table created with {len(df)} rows.")
        return df
    except Exception as e:
        logging.error(f"Failed to create marketing_extract table: {e}")
        raise

# --- SAS Equivalent: data work.final_campaign_list; set work.marketing_extract; if is_campaign_eligible = 1; run; ---
def filter_eligible_members(marketing_extract_df):
    """
    Filters only eligible members for the campaign.
    """
    logging.info("Step 3: Filter only eligible members")
    try:
        final_campaign_list = marketing_extract_df[marketing_extract_df['is_campaign_eligible'] == 1].copy()
        logging.info(f"Filtered final_campaign_list with {len(final_campaign_list)} eligible members.")
        return final_campaign_list
    except Exception as e:
        logging.error(f"Failed to filter eligible members: {e}")
        raise

# --- SAS Equivalent: proc export data=work.final_campaign_list outfile="&outpath" dbms=csv replace; run; ---
def export_final_file(final_campaign_list_df, outpath):
    """
    Exports the final campaign list to a CSV file.
    """
    logging.info("Step 4: Export final file")
    try:
        final_campaign_list_df.to_csv(outpath, index=False)
        logging.info(f"Exported final campaign list to {outpath}")
    except Exception as e:
        logging.error(f"Failed to export final campaign list: {e}")
        raise

# --- SAS Equivalent: %let outpath = /folders/myfolders/final_marketing_campaign_extract_2025.csv; ---
def get_output_path():
    """
    Returns the output path for the final CSV file.
    """
    # --- SAS Commented Logic ---
    # %let outpath = /folders/myfolders/final_marketing_campaign_extract_2025.csv;
    return "/folders/myfolders/final_marketing_campaign_extract_2025.csv"

# Main workflow
def main():
    connection = connect_to_teradata()
    marketing_extract_df = create_marketing_extract(connection)
    final_campaign_list_df = filter_eligible_members(marketing_extract_df)
    outpath = get_output_path()
    export_final_file(final_campaign_list_df, outpath)
    connection.close()

if __name__ == "__main__":
    main()
```