```

```markdown
=============================================
Author:        Ascendion AVA+
Created on:   
Description:   Test cases and Pytest script to validate the correctness of Python code converted from marketing_healthcare_extract.sas script.
=============================================

# Test Case Document:
## Test Case ID: TC001
### Description:
Validate the correctness of the data extraction logic from Teradata in the Python script.
### Expected Result:
The extracted data should match the structure and content as defined in the SAS script.

## Test Case ID: TC002
### Description:
Verify the correctness of the join operation between healthcare_plans and provider_network.
### Expected Result:
The resulting dataframe should have all columns from both tables with correct mappings.

## Test Case ID: TC003
### Description:
Test the age group classification logic.
### Expected Result:
Age groups should be classified as 'YOUNG_ADULT', 'MID_AGE', 'SENIOR', or 'UNKNOWN' based on the member's age.

## Test Case ID: TC004
### Description:
Validate the marketing segment creation logic.
### Expected Result:
The marketing_segment column should concatenate plan_type and region in uppercase.

## Test Case ID: TC005
### Description:
Test the campaign eligibility logic.
### Expected Result:
The is_campaign_eligible column should correctly identify eligible members based on the defined conditions.

## Test Case ID: TC006
### Description:
Verify the filtering of eligible members.
### Expected Result:
The final dataframe should only contain rows where is_campaign_eligible = 1.

## Test Case ID: TC007
### Description:
Test the export functionality.
### Expected Result:
The final dataframe should be exported to a CSV file at the specified location.

---

# Pytest Script:
```python
# =============================================
# Author:        Ascendion AVA+
# Created on:   
# Description:   Pytest script to validate the correctness of Python code converted from marketing_healthcare_extract.sas script.
# =============================================

import pytest
import pandas as pd

@pytest.fixture
def setup_data():
    # Setup input dataframes
    healthcare_plans = pd.DataFrame({
        "member_id": [1, 2, 3],
        "member_first_name": ["John", "Jane", "Doe"],
        "member_last_name": ["Doe", "Smith", "Johnson"],
        "member_age": [30, 45, 60],
        "plan_id": [101, 102, 103],
        "plan_type": ["PPO", "HMO", "POS"],
        "region": ["WEST", "SOUTH", "EAST"],
        "plan_status": ["ACTIVE", "ACTIVE", "INACTIVE"]
    })

    provider_network = pd.DataFrame({
        "plan_id": [101, 102, 103],
        "network_type": ["IN_NETWORK", "IN_NETWORK", "OUT_NETWORK"]
    })

    return healthcare_plans, provider_network

def test_data_extraction(setup_data):
    healthcare_plans, provider_network = setup_data
    assert not healthcare_plans.empty, "Healthcare plans data should not be empty."
    assert not provider_network.empty, "Provider network data should not be empty."

def test_join_operation(setup_data):
    healthcare_plans, provider_network = setup_data
    marketing_extract = pd.merge(healthcare_plans, provider_network, on="plan_id", how="left")
    assert "network_type" in marketing_extract.columns, "Join operation failed to include network_type column."

def test_age_group_classification(setup_data):
    healthcare_plans, _ = setup_data
    healthcare_plans["age_group"] = healthcare_plans["member_age"].apply(
        lambda age: "YOUNG_ADULT" if 25 <= age <= 35 else
                    "MID_AGE" if 36 <= age <= 50 else
                    "SENIOR" if age > 50 else "UNKNOWN"
    )
    assert healthcare_plans.loc[0, "age_group"] == "YOUNG_ADULT", "Age group classification failed for YOUNG_ADULT."
    assert healthcare_plans.loc[1, "age_group"] == "MID_AGE", "Age group classification failed for MID_AGE."
    assert healthcare_plans.loc[2, "age_group"] == "SENIOR", "Age group classification failed for SENIOR."

def test_marketing_segment_creation(setup_data):
    healthcare_plans, _ = setup_data
    healthcare_plans["marketing_segment"] = healthcare_plans["plan_type"].str.upper() + "-" + healthcare_plans["region"]
    assert healthcare_plans.loc[0, "marketing_segment"] == "PPO-WEST", "Marketing segment creation failed."

def test_campaign_eligibility_logic(setup_data):
    healthcare_plans, provider_network = setup_data
    marketing_extract = pd.merge(healthcare_plans, provider_network, on="plan_id", how="left")
    marketing_extract["is_campaign_eligible"] = (
        (marketing_extract["plan_status"] == "ACTIVE") &
        (marketing_extract["member_age"].between(25, 60)) &
        (marketing_extract["plan_type"].isin(["PPO", "HMO"])) &
        (marketing_extract["region"].isin(["WEST", "SOUTH"])) &
        (marketing_extract["network_type"] == "IN_NETWORK")
    ).astype(int)
    assert marketing_extract["is_campaign_eligible"].sum() == 2, "Campaign eligibility logic failed."

def test_filter_eligible_members(setup_data):
    healthcare_plans, provider_network = setup_data
    marketing_extract = pd.merge(healthcare_plans, provider_network, on="plan_id", how="left")
    marketing_extract["is_campaign_eligible"] = (
        (marketing_extract["plan_status"] == "ACTIVE") &
        (marketing_extract["member_age"].between(25, 60)) &
        (marketing_extract["plan_type"].isin(["PPO", "HMO"])) &
        (marketing_extract["region"].isin(["WEST", "SOUTH"])) &
        (marketing_extract["network_type"] == "IN_NETWORK")
    ).astype(int)
    final_campaign_list = marketing_extract[marketing_extract["is_campaign_eligible"] == 1]
    assert len(final_campaign_list) == 2, "Filtering eligible members failed."

def test_export_functionality(setup_data, tmp_path):
    healthcare_plans, provider_network = setup_data
    marketing_extract = pd.merge(healthcare_plans, provider_network, on="plan_id", how="left")
    marketing_extract["is_campaign_eligible"] = (
        (marketing_extract["plan_status"] == "ACTIVE") &
        (marketing_extract["member_age"].between(25, 60)) &
        (marketing_extract["plan_type"].isin(["PPO", "HMO"])) &
        (marketing_extract["region"].isin(["WEST", "SOUTH"])) &
        (marketing_extract["network_type"] == "IN_NETWORK")
    ).astype(int)
    final_campaign_list = marketing_extract[marketing_extract["is_campaign_eligible"] == 1]
    outpath = tmp_path / "final_marketing_campaign_extract_2025.csv"
    final_campaign_list.to_csv(outpath, index=False)
    assert outpath.exists(), "Export functionality failed."

```

---

# API Cost Consumption:
apiCost: 0.00 USD