=============================================
Author:        Ascendion AVA+
Date:   
Description:   Technical documentation for SAS script marketing_healthcare_extract.sas, detailing healthcare plan data extraction, transformation, and campaign eligibility logic for marketing automation.
=============================================

## Overview of Program

The `marketing_healthcare_extract.sas` code is designed to automate the extraction, transformation, and preparation of healthcare plan data for marketing campaigns. It connects securely to a Teradata database, applies business rules to identify eligible members, enriches data with provider network details, and outputs a campaign-ready dataset. The business problem addressed is the efficient identification and segmentation of healthcare plan members who are eligible for targeted marketing, ensuring compliance with eligibility criteria and maximizing campaign effectiveness. This solution streamlines data processing, reduces manual intervention, and supports scalable marketing operations in the healthcare domain.

## Code Structure and Design

The program is structured into four main steps: (1) establishing a secure Teradata connection, (2) extracting and transforming data using PROC SQL, (3) filtering eligible members with a Data Step, and (4) exporting the final dataset for marketing use. The primary components include source tables (`healthcare_plans`, `provider_network`), a work table (`marketing_extract`), and the final output table (`final_campaign_list`). Key operations involve SQL joins, conditional logic for eligibility, field transformations, and data export. The flow is modular, with clear separation between data extraction, transformation, and output, supporting maintainability and scalability.

## Data Flow and Processing Logic

**Processed Datasets:**
- tdata.healthcare_plans
- tdata.provider_network
- work.marketing_extract
- work.final_campaign_list

**Data Flow:**
Raw data is sourced from Teradata tables (`healthcare_plans` and `provider_network`). The SQL step joins and transforms these datasets, applying business rules to create enriched records in `marketing_extract`. The Data Step then filters for campaign-eligible members, producing `final_campaign_list`. Finally, the dataset is exported as a CSV file for downstream marketing use. The flow ensures only active, eligible members are included, with relevant segmentation and campaign logic applied.

## Data Mapping

| Target Table Name      | Target Column Name   | Source Table Name   | Source Column Name   | Remarks                                      |
|----------------------- |---------------------|---------------------|---------------------|----------------------------------------------|
| work.marketing_extract | member_id           | healthcare_plans    | member_id           | 1 to 1 mapping                              |
| work.marketing_extract | member_full_name    | healthcare_plans    | member_first_name, member_last_name | Transformation: Concatenation               |
| work.marketing_extract | member_age          | healthcare_plans    | member_age          | 1 to 1 mapping                              |
| work.marketing_extract | age_group           | healthcare_plans    | member_age          | Transformation: Age bucket classification    |
| work.marketing_extract | plan_id             | healthcare_plans    | plan_id             | 1 to 1 mapping                              |
| work.marketing_extract | plan_type           | healthcare_plans    | plan_type           | 1 to 1 mapping                              |
| work.marketing_extract | region              | healthcare_plans    | region              | 1 to 1 mapping                              |
| work.marketing_extract | network_type        | provider_network    | network_type        | 1 to 1 mapping (via join on plan_id)         |
| work.marketing_extract | marketing_segment   | healthcare_plans    | plan_type, region   | Transformation: Concatenation & upcase       |
| work.marketing_extract | is_campaign_eligible| healthcare_plans, provider_network | plan_status, member_age, plan_type, region, network_type | Validation: Eligibility logic                |
| work.final_campaign_list | All columns        | work.marketing_extract | All columns        | Filter: Only where is_campaign_eligible = 1  |

## Complexity Analysis

| Metric                   | Value                                |
|--------------------------|--------------------------------------|
| Number of Lines          | 47                                   |
| Datasets Used            | 4                                    |
| Joins Used               | LEFT JOIN                            |
| TRANSFORM Functions      | 4 (concatenation, upcase, age_group, eligibility logic) |
| RECORD Definitions       | 2 (marketing_extract, final_campaign_list) |
| OUTPUT Statements        | 1 (PROC EXPORT)                      |
| Conditional Logic        | 2 (age_group CASE, eligibility CASE) |
| Indexing and Lookups     | None                                 |
| Function Calls           | 1 macro variable, 1 PROC EXPORT      |
| Performance Controls     | WHERE clause filtering, left join    |
| External Dependencies    | Teradata libname, CSV export         |
| Overall Complexity Score | 35                                   |

## Key Outputs

- `final_campaign_list`: Contains only campaign-eligible healthcare plan members, segmented and enriched for marketing use.
- CSV file export: `/folders/myfolders/final_marketing_campaign_extract_2025.csv` for downstream campaign automation.

These outputs align with business goals by providing a ready-to-use, compliant, and segmented list of eligible members for targeted marketing, supporting reporting and campaign execution.

## API Cost

API cost with proper calculation: 0.01 $