1. Comprehensive test case list (TC01-TC17) covering happy path, edge cases, and error handling for the provided BigQuery SQL.
2. Pytest script with setup/teardown, mock data, and example test implementations for key scenarios.
3. API cost for this call: $0.005

(See above for full details and code.)