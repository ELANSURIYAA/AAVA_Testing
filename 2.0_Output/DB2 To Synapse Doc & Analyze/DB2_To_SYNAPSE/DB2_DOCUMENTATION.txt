-- Create a sample table
CREATE TABLE EMPLOYEES (
    EMP_ID INT GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    NAME VARCHAR(100) NOT NULL,
    DEPARTMENT VARCHAR(50),
    SALARY DECIMAL(10,2),
    JOIN_DATE DATE
);

-- Insert sample data
INSERT INTO EMPLOYEES (NAME, DEPARTMENT, SALARY, JOIN_DATE) VALUES
('Alice Johnson', 'HR', 60000.00, '2022-03-15'),
('Bob Smith', 'Finance', 75000.00, '2021-08-20'),
('Charlie Brown', 'IT', 85000.00, '2019-11-25');

-- Query the data
SELECT * FROM EMPLOYEES;

-- Create another table for department details
CREATE TABLE DEPARTMENTS (
    DEPT_ID INT PRIMARY KEY,
    DEPT_NAME VARCHAR(50),
    MANAGER_NAME VARCHAR(100)
);

-- Insert data into departments
INSERT INTO DEPARTMENTS (DEPT_ID, DEPT_NAME, MANAGER_NAME) VALUES
(1, 'HR', 'Lisa Green'),
(2, 'Finance', 'James White'),
(3, 'IT', 'Michael Black');

-- Join employees with departments (Assume EMPLOYEES has a foreign key DEPARTMENT_ID)
SELECT E.NAME, D.DEPT_NAME, D.MANAGER_NAME, E.SALARY
FROM EMPLOYEES E
JOIN DEPARTMENTS D ON E.DEPARTMENT = D.DEPT_NAME;

-- Create a stored procedure
CREATE PROCEDURE UPDATE_SALARY (IN EMPLOYEE_ID INT, IN NEW_SALARY DECIMAL(10,2))
BEGIN
    UPDATE EMPLOYEES
    SET SALARY = NEW_SALARY
    WHERE EMP_ID = EMPLOYEE_ID;
END;

-- Call the stored procedure
CALL UPDATE_SALARY(1, 65000.00);

-- Handling Transactions
BEGIN;
    UPDATE EMPLOYEES SET SALARY = SALARY + 5000 WHERE DEPARTMENT = 'IT';
    DELETE FROM EMPLOYEES WHERE EMP_ID = 2;
COMMIT;