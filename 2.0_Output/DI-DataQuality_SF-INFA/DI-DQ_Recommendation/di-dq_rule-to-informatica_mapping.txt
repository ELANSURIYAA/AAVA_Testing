<?xml version="1.0" encoding="UTF-8"?>
<!-- Informatica PowerCenter Mapping: DQ_VALIDATION_MEMBERSDATA -->
<MAPPING DESCRIPTION="Executes DQ validation checks on MEMBERSDATA and routes violations to DQ_ISSUE_LOG"
          ISVALID="YES" NAME="m_DQ_VALIDATION_MEMBERSDATA" OBJECTVERSION="1" VERSIONNUMBER="1">
  <!-- Source Definition -->
  <SOURCE BUSINESSNAME="" DATABASETYPE="Flat File" DBDNAME="" DESCRIPTION="" NAME="MEMBERSDATA" OBJECTVERSION="1" OWNERNAME="" VERSIONNUMBER="1">
    <FLATFILE>
      <FIELD DATATYPE="string" DESCRIPTION="" FIELDNUMBER="1" KEYTYPE="NOT A KEY" LENGTH="100" LEVEL="" NAME="FIRSTNAME" NULLABLE="YES" OCCURS="0" OFFSET="0" PHYSICALLENGTH="100" PHYSICALOFFSET="0" PICTURETEXT="" PRECISION="100" SCALE="0" USAGE=""/>
      <FIELD DATATYPE="string" DESCRIPTION="" FIELDNUMBER="2" KEYTYPE="NOT A KEY" LENGTH="100" LEVEL="" NAME="LASTNAME" NULLABLE="YES" OCCURS="0" OFFSET="0" PHYSICALLENGTH="100" PHYSICALOFFSET="0" PICTURETEXT="" PRECISION="100" SCALE="0" USAGE=""/>
      <FIELD DATATYPE="string" DESCRIPTION="" FIELDNUMBER="3" KEYTYPE="NOT A KEY" LENGTH="255" LEVEL="" NAME="COMPANY" NULLABLE="YES" OCCURS="0" OFFSET="0" PHYSICALLENGTH="255" PHYSICALOFFSET="0" PICTURETEXT="" PRECISION="255" SCALE="0" USAGE=""/>
      <FIELD DATATYPE="string" DESCRIPTION="" FIELDNUMBER="4" KEYTYPE="NOT A KEY" LENGTH="16777216" LEVEL="" NAME="ADDRESS" NULLABLE="YES" OCCURS="0" OFFSET="0" PHYSICALLENGTH="16777216" PHYSICALOFFSET="0" PICTURETEXT="" PRECISION="16777216" SCALE="0" USAGE=""/>
      <FIELD DATATYPE="string" DESCRIPTION="" FIELDNUMBER="5" KEYTYPE="NOT A KEY" LENGTH="100" LEVEL="" NAME="CITY" NULLABLE="YES" OCCURS="0" OFFSET="0" PHYSICALLENGTH="100" PHYSICALOFFSET="0" PICTURETEXT="" PRECISION="100" SCALE="0" USAGE=""/>
      <FIELD DATATYPE="string" DESCRIPTION="" FIELDNUMBER="6" KEYTYPE="NOT A KEY" LENGTH="100" LEVEL="" NAME="COUNTRY" NULLABLE="YES" OCCURS="0" OFFSET="0" PHYSICALLENGTH="100" PHYSICALOFFSET="0" PICTURETEXT="" PRECISION="100" SCALE="0" USAGE=""/>
      <FIELD DATATYPE="string" DESCRIPTION="" FIELDNUMBER="7" KEYTYPE="NOT A KEY" LENGTH="100" LEVEL="" NAME="STATE" NULLABLE="YES" OCCURS="0" OFFSET="0" PHYSICALLENGTH="100" PHYSICALOFFSET="0" PICTURETEXT="" PRECISION="100" SCALE="0" USAGE=""/>
      <FIELD DATATYPE="string" DESCRIPTION="" FIELDNUMBER="8" KEYTYPE="NOT A KEY" LENGTH="20" LEVEL="" NAME="ZIP" NULLABLE="YES" OCCURS="0" OFFSET="0" PHYSICALLENGTH="20" PHYSICALOFFSET="0" PICTURETEXT="" PRECISION="20" SCALE="0" USAGE=""/>
      <FIELD DATATYPE="string" DESCRIPTION="" FIELDNUMBER="9" KEYTYPE="NOT A KEY" LENGTH="50" LEVEL="" NAME="PHONENUMBER1" NULLABLE="YES" OCCURS="0" OFFSET="0" PHYSICALLENGTH="50" PHYSICALOFFSET="0" PICTURETEXT="" PRECISION="50" SCALE="0" USAGE=""/>
      <FIELD DATATYPE="string" DESCRIPTION="" FIELDNUMBER="10" KEYTYPE="NOT A KEY" LENGTH="50" LEVEL="" NAME="PHONENUMBER2" NULLABLE="YES" OCCURS="0" OFFSET="0" PHYSICALLENGTH="50" PHYSICALOFFSET="0" PICTURETEXT="" PRECISION="50" SCALE="0" USAGE=""/>
      <FIELD DATATYPE="string" DESCRIPTION="" FIELDNUMBER="11" KEYTYPE="NOT A KEY" LENGTH="255" LEVEL="" NAME="EMAIL" NULLABLE="YES" OCCURS="0" OFFSET="0" PHYSICALLENGTH="255" PHYSICALOFFSET="0" PICTURETEXT="" PRECISION="255" SCALE="0" USAGE=""/>
      <FIELD DATATYPE="string" DESCRIPTION="" FIELDNUMBER="12" KEYTYPE="NOT A KEY" LENGTH="255" LEVEL="" NAME="WEB" NULLABLE="YES" OCCURS="0" OFFSET="0" PHYSICALLENGTH="255" PHYSICALOFFSET="0" PICTURETEXT="" PRECISION="255" SCALE="0" USAGE=""/>
      <FIELD DATATYPE="decimal" DESCRIPTION="" FIELDNUMBER="13" KEYTYPE="NOT A KEY" LENGTH="8" LEVEL="" NAME="MEMBER_ID" NULLABLE="YES" OCCURS="0" OFFSET="0" PHYSICALLENGTH="8" PHYSICALOFFSET="0" PICTURETEXT="" PRECISION="8" SCALE="0" USAGE=""/>
    </FLATFILE>
  </SOURCE>

  <!-- Expression Transformation for DQ Checks -->
  <TRANSFORMATION DESCRIPTION="DQ Expression Checks" NAME="EXP_DQ_CHECKS" OBJECTVERSION="1" REUSABLE="NO" TYPE="Expression" VERSIONNUMBER="1">
    <TRANSFORMFIELD DATATYPE="string" DEFAULTVALUE="" DESCRIPTION="Check FIRSTNAME not null" EXPRESSION="IIF(ISNULL(FIRSTNAME), 'Y', 'N')" EXPRESSIONTYPE="GENERAL" NAME="DQ_FIRSTNAME_NULL" PORTTYPE="OUTPUT" PRECISION="1" SCALE="0"/>
    <TRANSFORMFIELD DATATYPE="string" DEFAULTVALUE="" DESCRIPTION="Check LASTNAME not null" EXPRESSION="IIF(ISNULL(LASTNAME), 'Y', 'N')" EXPRESSIONTYPE="GENERAL" NAME="DQ_LASTNAME_NULL" PORTTYPE="OUTPUT" PRECISION="1" SCALE="0"/>
    <TRANSFORMFIELD DATATYPE="string" DEFAULTVALUE="" DESCRIPTION="Check COMPANY length" EXPRESSION="IIF(LENGTH(COMPANY) &gt; 255, 'Y', 'N')" EXPRESSIONTYPE="GENERAL" NAME="DQ_COMPANY_LEN" PORTTYPE="OUTPUT" PRECISION="1" SCALE="0"/>
    <TRANSFORMFIELD DATATYPE="string" DEFAULTVALUE="" DESCRIPTION="Check ADDRESS length" EXPRESSION="IIF(LENGTH(ADDRESS) &gt; 16777216, 'Y', 'N')" EXPRESSIONTYPE="GENERAL" NAME="DQ_ADDRESS_LEN" PORTTYPE="OUTPUT" PRECISION="1" SCALE="0"/>
    <TRANSFORMFIELD DATATYPE="string" DEFAULTVALUE="" DESCRIPTION="Check CITY value" EXPRESSION="IIF(ISNULL(CITY) OR (CITY != 'Los Angeles' AND CITY != 'New York' AND CITY != 'London'), 'Y', 'N')" EXPRESSIONTYPE="GENERAL" NAME="DQ_CITY_VALUE" PORTTYPE="OUTPUT" PRECISION="1" SCALE="0"/>
    <TRANSFORMFIELD DATATYPE="string" DEFAULTVALUE="" DESCRIPTION="Check COUNTRY not null" EXPRESSION="IIF(ISNULL(COUNTRY), 'Y', 'N')" EXPRESSIONTYPE="GENERAL" NAME="DQ_COUNTRY_NULL" PORTTYPE="OUTPUT" PRECISION="1" SCALE="0"/>
    <TRANSFORMFIELD DATATYPE="string" DEFAULTVALUE="" DESCRIPTION="Check STATE length" EXPRESSION="IIF(LENGTH(STATE) &gt; 100, 'Y', 'N')" EXPRESSIONTYPE="GENERAL" NAME="DQ_STATE_LEN" PORTTYPE="OUTPUT" PRECISION="1" SCALE="0"/>
    <TRANSFORMFIELD DATATYPE="string" DEFAULTVALUE="" DESCRIPTION="Check ZIP format" EXPRESSION="IIF(NOT REG_MATCH(ZIP, '^[A-Za-z0-9-]+$'), 'Y', 'N')" EXPRESSIONTYPE="GENERAL" NAME="DQ_ZIP_FORMAT" PORTTYPE="OUTPUT" PRECISION="1" SCALE="0"/>
    <TRANSFORMFIELD DATATYPE="string" DEFAULTVALUE="" DESCRIPTION="Check PHONENUMBER1 not null" EXPRESSION="IIF(ISNULL(PHONENUMBER1), 'Y', 'N')" EXPRESSIONTYPE="GENERAL" NAME="DQ_PHONE1_NULL" PORTTYPE="OUTPUT" PRECISION="1" SCALE="0"/>
    <TRANSFORMFIELD DATATYPE="string" DEFAULTVALUE="" DESCRIPTION="Check PHONENUMBER2 != PHONENUMBER1" EXPRESSION="IIF(NOT ISNULL(PHONENUMBER2) AND PHONENUMBER2 = PHONENUMBER1, 'Y', 'N')" EXPRESSIONTYPE="GENERAL" NAME="DQ_PHONE2_UNIQUE" PORTTYPE="OUTPUT" PRECISION="1" SCALE="0"/>
    <TRANSFORMFIELD DATATYPE="string" DEFAULTVALUE="" DESCRIPTION="Check EMAIL format" EXPRESSION="IIF(NOT ISNULL(EMAIL) AND NOT REG_MATCH(EMAIL, '^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[A-Za-z]{2,}$'), 'Y', 'N')" EXPRESSIONTYPE="GENERAL" NAME="DQ_EMAIL_FORMAT" PORTTYPE="OUTPUT" PRECISION="1" SCALE="0"/>
    <TRANSFORMFIELD DATATYPE="string" DEFAULTVALUE="" DESCRIPTION="Check WEB format" EXPRESSION="IIF(NOT ISNULL(WEB) AND NOT REG_MATCH(WEB, '^(https?://)?[A-Za-z0-9.-]+\\.[A-Za-z]{2,}(/.*)?$'), 'Y', 'N')" EXPRESSIONTYPE="GENERAL" NAME="DQ_WEB_FORMAT" PORTTYPE="OUTPUT" PRECISION="1" SCALE="0"/>
    <TRANSFORMFIELD DATATYPE="string" DEFAULTVALUE="" DESCRIPTION="Check MEMBER_ID range" EXPRESSION="IIF(MEMBER_ID &lt; 10000000 OR MEMBER_ID &gt; 99999999, 'Y', 'N')" EXPRESSIONTYPE="GENERAL" NAME="DQ_MEMBERID_RANGE" PORTTYPE="OUTPUT" PRECISION="1" SCALE="0"/>
    <TRANSFORMFIELD DATATYPE="string" DEFAULTVALUE="" DESCRIPTION="Check at least one contact" EXPRESSION="IIF(ISNULL(PHONENUMBER1) AND ISNULL(EMAIL) AND ISNULL(WEB), 'Y', 'N')" EXPRESSIONTYPE="GENERAL" NAME="DQ_CONTACT_ATLEASTONE" PORTTYPE="OUTPUT" PRECISION="1" SCALE="0"/>
    <!-- Pass-through fields -->
    <TRANSFORMFIELD DATATYPE="string" NAME="FIRSTNAME" PORTTYPE="INPUT/OUTPUT" PRECISION="100" SCALE="0"/>
    <TRANSFORMFIELD DATATYPE="string" NAME="LASTNAME" PORTTYPE="INPUT/OUTPUT" PRECISION="100" SCALE="0"/>
    <TRANSFORMFIELD DATATYPE="string" NAME="COMPANY" PORTTYPE="INPUT/OUTPUT" PRECISION="255" SCALE="0"/>
    <TRANSFORMFIELD DATATYPE="string" NAME="ADDRESS" PORTTYPE="INPUT/OUTPUT" PRECISION="16777216" SCALE="0"/>
    <TRANSFORMFIELD DATATYPE="string" NAME="CITY" PORTTYPE="INPUT/OUTPUT" PRECISION="100" SCALE="0"/>
    <TRANSFORMFIELD DATATYPE="string" NAME="COUNTRY" PORTTYPE="INPUT/OUTPUT" PRECISION="100" SCALE="0"/>
    <TRANSFORMFIELD DATATYPE="string" NAME="STATE" PORTTYPE="INPUT/OUTPUT" PRECISION="100" SCALE="0"/>
    <TRANSFORMFIELD DATATYPE="string" NAME="ZIP" PORTTYPE="INPUT/OUTPUT" PRECISION="20" SCALE="0"/>
    <TRANSFORMFIELD DATATYPE="string" NAME="PHONENUMBER1" PORTTYPE="INPUT/OUTPUT" PRECISION="50" SCALE="0"/>
    <TRANSFORMFIELD DATATYPE="string" NAME="PHONENUMBER2" PORTTYPE="INPUT/OUTPUT" PRECISION="50" SCALE="0"/>
    <TRANSFORMFIELD DATATYPE="string" NAME="EMAIL" PORTTYPE="INPUT/OUTPUT" PRECISION="255" SCALE="0"/>
    <TRANSFORMFIELD DATATYPE="string" NAME="WEB" PORTTYPE="INPUT/OUTPUT" PRECISION="255" SCALE="0"/>
    <TRANSFORMFIELD DATATYPE="decimal" NAME="MEMBER_ID" PORTTYPE="INPUT/OUTPUT" PRECISION="8" SCALE="0"/>
  </TRANSFORMATION>

  <!-- Aggregator for MEMBER_ID uniqueness -->
  <TRANSFORMATION DESCRIPTION="Check MEMBER_ID Uniqueness" NAME="AGG_MEMBERID_UNIQ" OBJECTVERSION="1" REUSABLE="NO" TYPE="Aggregator" VERSIONNUMBER="1">
    <GROUPBYFIELD FIELD="MEMBER_ID"/>
    <TRANSFORMFIELD DATATYPE="decimal" NAME="MEMBER_ID" PORTTYPE="INPUT/OUTPUT" PRECISION="8" SCALE="0"/>
    <TRANSFORMFIELD DATATYPE="integer" DESCRIPTION="Count of MEMBER_ID" EXPRESSION="COUNT(MEMBER_ID)" NAME="MEMBER_ID_COUNT" PORTTYPE="OUTPUT" PRECISION="10" SCALE="0"/>
  </TRANSFORMATION>

  <!-- Joiner to bring uniqueness result back to main flow -->
  <TRANSFORMATION DESCRIPTION="Join Uniqueness Result" NAME="JN_MEMBERID_UNIQ" OBJECTVERSION="1" REUSABLE="NO" TYPE="Joiner" VERSIONNUMBER="1">
    <TRANSFORMFIELD DATATYPE="decimal" NAME="MEMBER_ID" PORTTYPE="INPUT/OUTPUT" PRECISION="8" SCALE="0"/>
    <TRANSFORMFIELD DATATYPE="integer" NAME="MEMBER_ID_COUNT" PORTTYPE="INPUT/OUTPUT" PRECISION="10" SCALE="0"/>
    <!-- All other fields as passthrough -->
  </TRANSFORMATION>

  <!-- Router Transformation for DQ Routing -->
  <TRANSFORMATION DESCRIPTION="Route Valid/Invalid Rows" NAME="RTR_DQ_ROUTER" OBJECTVERSION="1" REUSABLE="NO" TYPE="Router" VERSIONNUMBER="1">
    <GROUP DESCRIPTION="Valid Rows" NAME="VALID_ROWS" EXPRESSION="DQ_FIRSTNAME_NULL = 'N' AND DQ_LASTNAME_NULL = 'N' AND DQ_COMPANY_LEN = 'N' AND DQ_ADDRESS_LEN = 'N' AND DQ_CITY_VALUE = 'N' AND DQ_COUNTRY_NULL = 'N' AND DQ_STATE_LEN = 'N' AND DQ_ZIP_FORMAT = 'N' AND DQ_PHONE1_NULL = 'N' AND DQ_PHONE2_UNIQUE = 'N' AND DQ_EMAIL_FORMAT = 'N' AND DQ_WEB_FORMAT = 'N' AND DQ_MEMBERID_RANGE = 'N' AND DQ_CONTACT_ATLEASTONE = 'N' AND (MEMBER_ID_COUNT IS NULL OR MEMBER_ID_COUNT = 1)"/>
    <GROUP DESCRIPTION="Rejected Rows" NAME="REJECTED_ROWS" EXPRESSION="DQ_FIRSTNAME_NULL = 'Y' OR DQ_LASTNAME_NULL = 'Y' OR DQ_COMPANY_LEN = 'Y' OR DQ_ADDRESS_LEN = 'Y' OR DQ_CITY_VALUE = 'Y' OR DQ_COUNTRY_NULL = 'Y' OR DQ_STATE_LEN = 'Y' OR DQ_ZIP_FORMAT = 'Y' OR DQ_PHONE1_NULL = 'Y' OR DQ_PHONE2_UNIQUE = 'Y' OR DQ_EMAIL_FORMAT = 'Y' OR DQ_WEB_FORMAT = 'Y' OR DQ_MEMBERID_RANGE = 'Y' OR DQ_CONTACT_ATLEASTONE = 'Y' OR (MEMBER_ID_COUNT &gt; 1)"/>
    <!-- All fields as passthrough -->
  </TRANSFORMATION>

  <!-- Target Definitions -->
  <TARGET BUSINESSNAME="" DATABASETYPE="Flat File" DBDNAME="" DESCRIPTION="Valid Members" NAME="MEMBERSDATA_VALID" OBJECTVERSION="1" OWNERNAME="" TABLEOPTIONS="" VERSIONNUMBER="1">
    <FLATFILE>
      <FIELD DATATYPE="string" NAME="FIRSTNAME" PRECISION="100" SCALE="0"/>
      <FIELD DATATYPE="string" NAME="LASTNAME" PRECISION="100" SCALE="0"/>
      <FIELD DATATYPE="string" NAME="COMPANY" PRECISION="255" SCALE="0"/>
      <FIELD DATATYPE="string" NAME="ADDRESS" PRECISION="16777216" SCALE="0"/>
      <FIELD DATATYPE="string" NAME="CITY" PRECISION="100" SCALE="0"/>
      <FIELD DATATYPE="string" NAME="COUNTRY" PRECISION="100" SCALE="0"/>
      <FIELD DATATYPE="string" NAME="STATE" PRECISION="100" SCALE="0"/>
      <FIELD DATATYPE="string" NAME="ZIP" PRECISION="20" SCALE="0"/>
      <FIELD DATATYPE="string" NAME="PHONENUMBER1" PRECISION="50" SCALE="0"/>
      <FIELD DATATYPE="string" NAME="PHONENUMBER2" PRECISION="50" SCALE="0"/>
      <FIELD DATATYPE="string" NAME="EMAIL" PRECISION="255" SCALE="0"/>
      <FIELD DATATYPE="string" NAME="WEB" PRECISION="255" SCALE="0"/>
      <FIELD DATATYPE="decimal" NAME="MEMBER_ID" PRECISION="8" SCALE="0"/>
    </FLATFILE>
  </TARGET>

  <TARGET BUSINESSNAME="" DATABASETYPE="Flat File" DBDNAME="" DESCRIPTION="DQ Issue Log" NAME="DQ_ISSUE_LOG" OBJECTVERSION="1" OWNERNAME="" TABLEOPTIONS="" VERSIONNUMBER="1">
    <FLATFILE>
      <FIELD DATATYPE="string" NAME="TABLE_NAME" PRECISION="100" SCALE="0"/>
      <FIELD DATATYPE="string" NAME="COLUMN_NAME" PRECISION="100" SCALE="0"/>
      <FIELD DATATYPE="string" NAME="RULE_DESCRIPTION" PRECISION="255" SCALE="0"/>
      <FIELD DATATYPE="string" NAME="SEVERITY" PRECISION="10" SCALE="0"/>
      <FIELD DATATYPE="string" NAME="LOGGED_AT" PRECISION="30" SCALE="0"/>
      <FIELD DATATYPE="decimal" NAME="MEMBER_ID" PRECISION="8" SCALE="0"/>
    </FLATFILE>
  </TARGET>

  <!-- Connectors (high-level, for illustration) -->
  <CONNECTOR FROMFIELD="*" FROMINSTANCE="MEMBERSDATA" FROMINSTANCETYPE="Source Definition" TOFIELD="*" TOINSTANCE="EXP_DQ_CHECKS" TOINSTANCETYPE="Expression"/>
  <CONNECTOR FROMFIELD="*" FROMINSTANCE="EXP_DQ_CHECKS" FROMINSTANCETYPE="Expression" TOFIELD="*" TOINSTANCE="AGG_MEMBERID_UNIQ" TOINSTANCETYPE="Aggregator"/>
  <CONNECTOR FROMFIELD="*" FROMINSTANCE="AGG_MEMBERID_UNIQ" FROMINSTANCETYPE="Aggregator" TOFIELD="*" TOINSTANCE="JN_MEMBERID_UNIQ" TOINSTANCETYPE="Joiner"/>
  <CONNECTOR FROMFIELD="*" FROMINSTANCE="EXP_DQ_CHECKS" FROMINSTANCETYPE="Expression" TOFIELD="*" TOINSTANCE="JN_MEMBERID_UNIQ" TOINSTANCETYPE="Joiner"/>
  <CONNECTOR FROMFIELD="*" FROMINSTANCE="JN_MEMBERID_UNIQ" FROMINSTANCETYPE="Joiner" TOFIELD="*" TOINSTANCE="RTR_DQ_ROUTER" TOINSTANCETYPE="Router"/>
  <CONNECTOR FROMFIELD="*" FROMINSTANCE="RTR_DQ_ROUTER" FROMINSTANCETYPE="Router" TOFIELD="*" TOINSTANCE="MEMBERSDATA_VALID" TOINSTANCETYPE="Target Definition" GROUP="VALID_ROWS"/>
  <CONNECTOR FROMFIELD="*" FROMINSTANCE="RTR_DQ_ROUTER" FROMINSTANCETYPE="Router" TOFIELD="*" TOINSTANCE="DQ_ISSUE_LOG" TOINSTANCETYPE="Target Definition" GROUP="REJECTED_ROWS"/>
</MAPPING>