```
=============================================
Author:        Ascendion AVA+
Created on:   
Description:   Pytest script to validate Snowflake SQL logic for backing up employee data by joining Employee and Salary tables, ensuring correct table creation, data integrity, and edge case handling.
=============================================

**Test Case Document:**
```markdown
| Test Case ID | Description                                 | Expected Result |
|--------------|---------------------------------------------|-----------------|
| TC001        | Validate backup table creation               | Table employee_bkup created with correct schema |
| TC002        | Validate correct join and data insertion     | employee_bkup contains correct joined records |
| TC003        | Handle NULL values in Salary.NetPay          | employee_bkup NetPay is NULL for those employees |
| TC004        | Handle missing Employee in Salary            | Those employees not present in employee_bkup |
| TC005        | Handle empty Employee and Salary tables      | employee_bkup is empty |
| TC006        | Validate unique constraint on EmployeeNo     | Error or rejection due to unique constraint |
| TC007        | Validate table drop idempotency              | Table is dropped and recreated without error |
| TC008        | Validate data types and boundary conditions  | Data inserted and retrieved correctly |
```

**Pytest Script:**
```python
import pytest
from snowflake.connector import connect

@pytest.fixture(scope="module")
def snowflake_connection():
    conn = connect(
        user='YOUR_USER',
        password='YOUR_PASSWORD',
        account='YOUR_ACCOUNT',
        warehouse='YOUR_WAREHOUSE',
        database='YOUR_DATABASE',
        schema='YOUR_SCHEMA'
    )
    yield conn
    conn.close()

@pytest.fixture(scope="function")
def setup_employee_and_salary(snowflake_connection):
    cursor = snowflake_connection.cursor()
    # Create Employee table
    cursor.execute("""
        CREATE OR REPLACE TEMP TABLE Employee (
            EmployeeNo INTEGER,
            FirstName VARCHAR(30),
            LastName VARCHAR(30),
            DepartmentNo SMALLINT
        );
    """)
    # Create Salary table
    cursor.execute("""
        CREATE OR REPLACE TEMP TABLE Salary (
            EmployeeNo INTEGER,
            NetPay INTEGER
        );
    """)
    yield cursor
    cursor.execute("DROP TABLE IF EXISTS Employee;")
    cursor.execute("DROP TABLE IF EXISTS Salary;")
    cursor.close()

def test_table_creation(snowflake_connection):
    cursor = snowflake_connection.cursor()
    cursor.execute("DROP TABLE IF EXISTS employee_bkup;")
    cursor.execute("""
        CREATE TABLE employee_bkup (
            EmployeeNo INTEGER,
            FirstName VARCHAR(30),
            LastName VARCHAR(30),
            DepartmentNo SMALLINT,
            NetPay INTEGER,
            CONSTRAINT employee_bkup_unique_employee_no UNIQUE (EmployeeNo)
        );
    """)
    cursor.execute("""
        SELECT column_name, data_type
        FROM information_schema.columns
        WHERE table_name = 'EMPLOYEE_BKUP'
        ORDER BY ordinal_position;
    """)
    columns = cursor.fetchall()
    assert columns == [
        ('EMPLOYEENO', 'NUMBER'),
        ('FIRSTNAME', 'VARCHAR'),
        ('LASTNAME', 'VARCHAR'),
        ('DEPARTMENTNO', 'NUMBER'),
        ('NETPAY', 'NUMBER')
    ], "Table schema does not match expected"
    cursor.execute("DROP TABLE IF EXISTS employee_bkup;")
    cursor.close()

def test_join_and_insert(setup_employee_and_salary):
    cursor = setup_employee_and_salary
    cursor.execute("INSERT INTO Employee VALUES (1, 'John', 'Doe', 10), (2, 'Jane', 'Smith', 20);")
    cursor.execute("INSERT INTO Salary VALUES (1, 5000), (2, 6000);")
    cursor.execute("DROP TABLE IF EXISTS employee_bkup;")
    cursor.execute("""
        CREATE TABLE employee_bkup (
            EmployeeNo INTEGER,
            FirstName VARCHAR(30),
            LastName VARCHAR(30),
            DepartmentNo SMALLINT,
            NetPay INTEGER,
            CONSTRAINT employee_bkup_unique_employee_no UNIQUE (EmployeeNo)
        );
    """)
    cursor.execute("""
        INSERT INTO employee_bkup (EmployeeNo, FirstName, LastName, DepartmentNo, NetPay)
        SELECT a.EmployeeNo, a.FirstName, a.LastName, a.DepartmentNo, b.NetPay
        FROM Employee a INNER JOIN Salary b ON a.EmployeeNo = b.EmployeeNo;
    """)
    cursor.execute("SELECT * FROM employee_bkup ORDER BY EmployeeNo;")
    results = cursor.fetchall()
    assert results == [
        (1, 'John', 'Doe', 10, 5000),
        (2, 'Jane', 'Smith', 20, 6000)
    ], "Join and insert logic failed"

def test_null_netpay(setup_employee_and_salary):
    cursor = setup_employee_and_salary
    cursor.execute("INSERT INTO Employee VALUES (3, 'Alice', 'Wonder', 30);")
    cursor.execute("INSERT INTO Salary VALUES (3, NULL);")
    cursor.execute("DROP TABLE IF EXISTS employee_bkup;")
    cursor.execute("""
        CREATE TABLE employee_bkup (
            EmployeeNo INTEGER,
            FirstName VARCHAR(30),
            LastName VARCHAR(30),
            DepartmentNo SMALLINT,
            NetPay INTEGER,
            CONSTRAINT employee_bkup_unique_employee_no UNIQUE (EmployeeNo)
        );
    """)
    cursor.execute("""
        INSERT INTO employee_bkup (EmployeeNo, FirstName, LastName, DepartmentNo, NetPay)
        SELECT a.EmployeeNo, a.FirstName, a.LastName, a.DepartmentNo, b.NetPay
        FROM Employee a INNER JOIN Salary b ON a.EmployeeNo = b.EmployeeNo;
    """)
    cursor.execute("SELECT NetPay FROM employee_bkup WHERE EmployeeNo = 3;")
    result = cursor.fetchone()
    assert result[0] is None, "NULL NetPay not handled correctly"

def test_missing_salary(setup_employee_and_salary):
    cursor = setup_employee_and_salary
    cursor.execute("INSERT INTO Employee VALUES (4, 'Bob', 'Builder', 40);")
    # No Salary for EmployeeNo=4
    cursor.execute("DROP TABLE IF EXISTS employee_bkup;")
    cursor.execute("""
        CREATE TABLE employee_bkup (
            EmployeeNo INTEGER,
            FirstName VARCHAR(30),
            LastName VARCHAR(30),
            DepartmentNo SMALLINT,
            NetPay INTEGER,
            CONSTRAINT employee_bkup_unique_employee_no UNIQUE (EmployeeNo)
        );
    """)
    cursor.execute("""
        INSERT INTO employee_bkup (EmployeeNo, FirstName, LastName, DepartmentNo, NetPay)
        SELECT a.EmployeeNo, a.FirstName, a.LastName, a.DepartmentNo, b.NetPay
        FROM Employee a INNER JOIN Salary b ON a.EmployeeNo = b.EmployeeNo;
    """)
    cursor.execute("SELECT COUNT(*) FROM employee_bkup WHERE EmployeeNo = 4;")
    result = cursor.fetchone()
    assert result[0] == 0, "Employee without salary should not be present"

def test_empty_tables(setup_employee_and_salary):
    cursor = setup_employee_and_salary
    cursor.execute("DROP TABLE IF EXISTS employee_bkup;")
    cursor.execute("""
        CREATE TABLE employee_bkup (
            EmployeeNo INTEGER,
            FirstName VARCHAR(30),
            LastName VARCHAR(30),
            DepartmentNo SMALLINT,
            NetPay INTEGER,
            CONSTRAINT employee_bkup_unique_employee_no UNIQUE (EmployeeNo)
        );
    """)
    cursor.execute("""
        INSERT INTO employee_bkup (EmployeeNo, FirstName, LastName, DepartmentNo, NetPay)
        SELECT a.EmployeeNo, a.FirstName, a.LastName, a.DepartmentNo, b.NetPay
        FROM Employee a INNER JOIN Salary b ON a.EmployeeNo = b.EmployeeNo;
    """)
    cursor.execute("SELECT COUNT(*) FROM employee_bkup;")
    result = cursor.fetchone()
    assert result[0] == 0, "employee_bkup should be empty when source tables are empty"

def test_unique_constraint(setup_employee_and_salary):
    cursor = setup_employee_and_salary
    cursor.execute("INSERT INTO Employee VALUES (5, 'Eve', 'Adams', 50);")
    cursor.execute("INSERT INTO Salary VALUES (5, 7000);")
    cursor.execute("DROP TABLE IF EXISTS employee_bkup;")
    cursor.execute("""
        CREATE TABLE employee_bkup (
            EmployeeNo INTEGER,
            FirstName VARCHAR(30),
            LastName VARCHAR(30),
            DepartmentNo SMALLINT,
            NetPay INTEGER,
            CONSTRAINT employee_bkup_unique_employee_no UNIQUE (EmployeeNo)
        );
    """)
    cursor.execute("""
        INSERT INTO employee_bkup (EmployeeNo, FirstName, LastName, DepartmentNo, NetPay)
        VALUES (5, 'Eve', 'Adams', 50, 7000);
    """)
    with pytest.raises(Exception):
        cursor.execute("""
            INSERT INTO employee_bkup (EmployeeNo, FirstName, LastName, DepartmentNo, NetPay)
            VALUES (5, 'Eve', 'Adams', 50, 7000);
        """)

def test_boundary_conditions(setup_employee_and_salary):
    cursor = setup_employee_and_salary
    cursor.execute("INSERT INTO Employee VALUES (2147483647, 'LongFirstName'*3, 'LongLastName'*3, 32767);")
    cursor.execute("INSERT INTO Salary VALUES (2147483647, 999999999);")
    cursor.execute("DROP TABLE IF EXISTS employee_bkup;")
    cursor.execute("""
        CREATE TABLE employee_bkup (
            EmployeeNo INTEGER,
            FirstName VARCHAR(30),
            LastName VARCHAR(30),
            DepartmentNo SMALLINT,
            NetPay INTEGER,
            CONSTRAINT employee_bkup_unique_employee_no UNIQUE (EmployeeNo)
        );
    """)
    cursor.execute("""
        INSERT INTO employee_bkup (EmployeeNo, FirstName, LastName, DepartmentNo, NetPay)
        SELECT a.EmployeeNo, a.FirstName, a.LastName, a.DepartmentNo, b.NetPay
        FROM Employee a INNER JOIN Salary b ON a.EmployeeNo = b.EmployeeNo;
    """)
    cursor.execute("SELECT * FROM employee_bkup WHERE EmployeeNo = 2147483647;")
    result = cursor.fetchone()
    assert result[0] == 2147483647
    assert result[1].startswith('LongFirstName')
    assert result[2].startswith('LongLastName')
    assert result[3] == 32767
    assert result[4] == 999999999

def test_table_drop_idempotency(snowflake_connection):
    cursor = snowflake_connection.cursor()
    cursor.execute("""
        CREATE TABLE IF NOT EXISTS employee_bkup (
            EmployeeNo INTEGER,
            FirstName VARCHAR(30),
            LastName VARCHAR(30),
            DepartmentNo SMALLINT,
            NetPay INTEGER,
            CONSTRAINT employee_bkup_unique_employee_no UNIQUE (EmployeeNo)
        );
    """)
    cursor.execute("DROP TABLE IF EXISTS employee_bkup;")
    cursor.execute("""
        CREATE TABLE employee_bkup (
            EmployeeNo INTEGER,
            FirstName VARCHAR(30),
            LastName VARCHAR(30),
            DepartmentNo SMALLINT,
            NetPay INTEGER,
            CONSTRAINT employee_bkup_unique_employee_no UNIQUE (EmployeeNo)
        );
    """)
    cursor.execute("SELECT COUNT(*) FROM information_schema.tables WHERE table_name = 'EMPLOYEE_BKUP';")
    result = cursor.fetchone()
    assert result[0] == 1, "Table was not recreated successfully"
    cursor.execute("DROP TABLE IF EXISTS employee_bkup;")
    cursor.close()
```

**Cost Analysis:**
API Cost: $0.0028
```