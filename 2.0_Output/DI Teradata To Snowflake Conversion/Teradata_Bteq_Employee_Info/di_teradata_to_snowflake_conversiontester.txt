=============================================
Author:        Ascendion AVA+
Created on:   
Description:   Snowflake SQL script to back up employee data by creating and populating employee_bkup from Employee and Salary tables, with idempotent table handling.
=============================================

**Test Case Document:**
```markdown
|Test Case ID|Description|Expected Result|
|TC001|Validate syntax changes for DROP TABLE and CREATE TABLE statements|Snowflake script executes without syntax errors|
|TC002|Validate removal of Teradata-specific scripting (.LOGON, .IF, .GOTO, .LABEL, .EXIT)|No unsupported scripting commands in Snowflake SQL; script runs successfully|
|TC003|Logical equivalence: Employee with matching Salary|employee_bkup contains correct joined data for matching EmployeeNo|
|TC004|Employee without matching Salary|employee_bkup does not contain EmployeeNo values with no matching Salary|
|TC005|Salary without matching Employee|employee_bkup does not contain Salary rows with no matching Employee|
|TC006|NULL EmployeeNo in Employee or Salary|Rows with NULL EmployeeNo are not inserted into employee_bkup|
|TC007|Empty Employee and Salary tables|employee_bkup is created and remains empty|
|TC008|Duplicate EmployeeNo in Salary|employee_bkup contains all joined combinations for duplicate EmployeeNo|
|TC009|Semi-structured (VARIANT/JSON) column in Employee|Script ignores extra columns and inserts only defined columns|
|TC010|Role-based access control (RBAC) validation|Script fails with permission error if user lacks CREATE/INSERT privileges|
|TC011|Performance: Large dataset|Script completes within acceptable time for 10,000 rows|
```

**Pytest Script:**
```python
import pytest
import snowflake.connector

@pytest.fixture(scope="module")
def snowflake_connection():
    conn = snowflake.connector.connect(
        user='YOUR_USER',
        password='YOUR_PASSWORD',
        account='YOUR_ACCOUNT',
        warehouse='YOUR_WAREHOUSE',
        database='YOUR_DATABASE',
        schema='PUBLIC'
    )
    yield conn
    conn.close()

@pytest.fixture(autouse=True)
def cleanup_tables(snowflake_connection):
    cursor = snowflake_connection.cursor()
    cursor.execute("DROP TABLE IF EXISTS employee_bkup;")
    cursor.execute("DROP TABLE IF EXISTS Employee;")
    cursor.execute("DROP TABLE IF EXISTS Salary;")
    yield
    cursor.execute("DROP TABLE IF EXISTS employee_bkup;")
    cursor.execute("DROP TABLE IF EXISTS Employee;")
    cursor.execute("DROP TABLE IF EXISTS Salary;")

def run_script(cursor):
    cursor.execute("DROP TABLE IF EXISTS employee_bkup;")
    cursor.execute("""
        CREATE TABLE employee_bkup (
            EmployeeNo INTEGER,
            FirstName VARCHAR(30),
            LastName VARCHAR(30),
            DepartmentNo SMALLINT,
            NetPay INTEGER
        );
    """)
    cursor.execute("""
        INSERT INTO employee_bkup
        SELECT 
            a.EmployeeNo,
            a.FirstName,
            a.LastName,
            a.DepartmentNo,
            b.NetPay
        FROM 
            Employee a
            INNER JOIN Salary b
                ON a.EmployeeNo = b.EmployeeNo;
    """)

def fetch_all(cursor, query):
    cursor.execute(query)
    return cursor.fetchall()

def test_syntax_and_unsupported_commands(snowflake_connection):
    cursor = snowflake_connection.cursor()
    # The script should not contain unsupported commands and should run without syntax errors
    try:
        run_script(cursor)
    except Exception as e:
        pytest.fail(f"Script failed with error: {e}")

def test_logical_equivalence_matching_employee_salary(snowflake_connection):
    cursor = snowflake_connection.cursor()
    cursor.execute("CREATE TABLE Employee (EmployeeNo INTEGER, FirstName VARCHAR(30), LastName VARCHAR(30), DepartmentNo SMALLINT);")
    cursor.execute("CREATE TABLE Salary (EmployeeNo INTEGER, NetPay INTEGER);")
    cursor.execute("INSERT INTO Employee VALUES (1, 'John', 'Doe', 10), (2, 'Jane', 'Smith', 20);")
    cursor.execute("INSERT INTO Salary VALUES (1, 1000), (2, 2000);")
    run_script(cursor)
    results = fetch_all(cursor, "SELECT * FROM employee_bkup ORDER BY EmployeeNo;")
    assert results == [(1, 'John', 'Doe', 10, 1000), (2, 'Jane', 'Smith', 20, 2000)]

def test_employee_without_matching_salary(snowflake_connection):
    cursor = snowflake_connection.cursor()
    cursor.execute("CREATE TABLE Employee (EmployeeNo INTEGER, FirstName VARCHAR(30), LastName VARCHAR(30), DepartmentNo SMALLINT);")
    cursor.execute("CREATE TABLE Salary (EmployeeNo INTEGER, NetPay INTEGER);")
    cursor.execute("INSERT INTO Employee VALUES (1, 'John', 'Doe', 10), (2, 'Jane', 'Smith', 20);")
    cursor.execute("INSERT INTO Salary VALUES (1, 1000);")
    run_script(cursor)
    results = fetch_all(cursor, "SELECT * FROM employee_bkup;")
    assert results == [(1, 'John', 'Doe', 10, 1000)]

def test_salary_without_matching_employee(snowflake_connection):
    cursor = snowflake_connection.cursor()
    cursor.execute("CREATE TABLE Employee (EmployeeNo INTEGER, FirstName VARCHAR(30), LastName VARCHAR(30), DepartmentNo SMALLINT);")
    cursor.execute("CREATE TABLE Salary (EmployeeNo INTEGER, NetPay INTEGER);")
    cursor.execute("INSERT INTO Employee VALUES (1, 'John', 'Doe', 10);")
    cursor.execute("INSERT INTO Salary VALUES (1, 1000), (2, 2000);")
    run_script(cursor)
    results = fetch_all(cursor, "SELECT * FROM employee_bkup;")
    assert results == [(1, 'John', 'Doe', 10, 1000)]

def test_null_employee_no(snowflake_connection):
    cursor = snowflake_connection.cursor()
    cursor.execute("CREATE TABLE Employee (EmployeeNo INTEGER, FirstName VARCHAR(30), LastName VARCHAR(30), DepartmentNo SMALLINT);")
    cursor.execute("CREATE TABLE Salary (EmployeeNo INTEGER, NetPay INTEGER);")
    cursor.execute("INSERT INTO Employee VALUES (NULL, 'Null', 'Emp', 10), (2, 'Jane', 'Smith', 20);")
    cursor.execute("INSERT INTO Salary VALUES (2, 2000), (NULL, 9999);")
    run_script(cursor)
    results = fetch_all(cursor, "SELECT * FROM employee_bkup;")
    assert results == [(2, 'Jane', 'Smith', 20, 2000)]

def test_empty_tables(snowflake_connection):
    cursor = snowflake_connection.cursor()
    cursor.execute("CREATE TABLE Employee (EmployeeNo INTEGER, FirstName VARCHAR(30), LastName VARCHAR(30), DepartmentNo SMALLINT);")
    cursor.execute("CREATE TABLE Salary (EmployeeNo INTEGER, NetPay INTEGER);")
    run_script(cursor)
    results = fetch_all(cursor, "SELECT * FROM employee_bkup;")
    assert results == []

def test_duplicate_employee_no_in_salary(snowflake_connection):
    cursor = snowflake_connection.cursor()
    cursor.execute("CREATE TABLE Employee (EmployeeNo INTEGER, FirstName VARCHAR(30), LastName VARCHAR(30), DepartmentNo SMALLINT);")
    cursor.execute("CREATE TABLE Salary (EmployeeNo INTEGER, NetPay INTEGER);")
    cursor.execute("INSERT INTO Employee VALUES (1, 'John', 'Doe', 10);")
    cursor.execute("INSERT INTO Salary VALUES (1, 1000), (1, 1100);")
    run_script(cursor)
    results = fetch_all(cursor, "SELECT * FROM employee_bkup ORDER BY NetPay;")
    assert results == [(1, 'John', 'Doe', 10, 1000), (1, 'John', 'Doe', 10, 1100)]

def test_semi_structured_data_ignored(snowflake_connection):
    cursor = snowflake_connection.cursor()
    cursor.execute("CREATE TABLE Employee (EmployeeNo INTEGER, FirstName VARCHAR(30), LastName VARCHAR(30), DepartmentNo SMALLINT, Extra VARIANT);")
    cursor.execute("CREATE TABLE Salary (EmployeeNo INTEGER, NetPay INTEGER);")
    cursor.execute("INSERT INTO Employee (EmployeeNo, FirstName, LastName, DepartmentNo, Extra) VALUES (1, 'John', 'Doe', 10, PARSE_JSON('{\"info\": \"test\"}'));")
    cursor.execute("INSERT INTO Salary VALUES (1, 1000);")
    run_script(cursor)
    results = fetch_all(cursor, "SELECT EmployeeNo, FirstName, LastName, DepartmentNo, NetPay FROM employee_bkup;")
    assert results == [(1, 'John', 'Doe', 10, 1000)]

def test_rbac_validation(snowflake_connection):
    cursor = snowflake_connection.cursor()
    # Try to run script with a user lacking privileges (simulate by revoking privileges if possible)
    # For demonstration, expect an error if privileges are missing
    try:
        cursor.execute("REVOKE ALL PRIVILEGES ON TABLE employee_bkup FROM ROLE PUBLIC;")
        with pytest.raises(Exception):
            run_script(cursor)
    except Exception:
        pass  # Privilege change may not be allowed in test context

def test_large_dataset_performance(snowflake_connection):
    import time
    cursor = snowflake_connection.cursor()
    cursor.execute("CREATE TABLE Employee (EmployeeNo INTEGER, FirstName VARCHAR(30), LastName VARCHAR(30), DepartmentNo SMALLINT);")
    cursor.execute("CREATE TABLE Salary (EmployeeNo INTEGER, NetPay INTEGER);")
    cursor.execute("INSERT INTO Employee SELECT seq4(), 'First', 'Last', 1 FROM TABLE(GENERATOR(ROWCOUNT => 10000));")
    cursor.execute("INSERT INTO Salary SELECT seq4(), 1000 FROM TABLE(GENERATOR(ROWCOUNT => 10000));")
    start = time.time()
    run_script(cursor)
    duration = time.time() - start
    cursor.execute("SELECT COUNT(*) FROM employee_bkup;")
    count = cursor.fetchone()[0]
    assert count == 10000
    assert duration < 60  # Should complete within 1 minute
```

**Cost Analysis:**
API Cost: $0.0028