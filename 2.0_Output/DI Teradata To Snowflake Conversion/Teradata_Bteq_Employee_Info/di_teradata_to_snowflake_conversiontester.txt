```
=============================================
Author:        Ascendion AVA+
Created on:   
Description:   Pytest script and test case list for validating Snowflake SQL logic that creates a backup table by joining Employee and Salary tables, ensuring correct data population, handling edge cases, and verifying error handling.
=============================================

**Test Case List:**
| Test Case ID | Description                                   | Input Data Description                                     | Expected Outcome                                   |
|--------------|-----------------------------------------------|------------------------------------------------------------|----------------------------------------------------|
| TC001        | Validate correct join and data population     | Employee and Salary tables with matching EmployeeNo values  | employee_bkup contains correct joined records       |
| TC002        | Handle missing Employee in Salary table       | Employee table with EmployeeNo not present in Salary table  | Those employees not present in employee_bkup        |
| TC003        | Handle missing Salary in Employee table       | Salary table with EmployeeNo not present in Employee table  | Those salaries not present in employee_bkup         |
| TC004        | Handle NULL values in join keys               | Employee or Salary table with NULL EmployeeNo               | Rows with NULL EmployeeNo excluded from employee_bkup|
| TC005        | Handle empty Employee table                   | Empty Employee table, populated Salary table                | employee_bkup is empty                              |
| TC006        | Handle empty Salary table                     | Populated Employee table, empty Salary table                | employee_bkup is empty                              |
| TC007        | Validate NetPay data type and boundary values | Salary table with extreme NetPay values (0, max int)        | employee_bkup contains correct NetPay values        |
| TC008        | Validate table recreation logic               | employee_bkup exists before script runs                     | Table dropped and recreated successfully            |

**Pytest Script:**
```python
import pytest
from snowflake.connector import connect

@pytest.fixture(scope="module")
def snowflake_connection():
    conn = connect(
        user='YOUR_USER',
        password='YOUR_PASSWORD',
        account='YOUR_ACCOUNT',
        warehouse='YOUR_WAREHOUSE',
        database='YOUR_DATABASE',
        schema='YOUR_SCHEMA'
    )
    yield conn
    conn.close()

@pytest.fixture(autouse=True)
def setup_and_teardown_tables(snowflake_connection):
    cursor = snowflake_connection.cursor()
    # Drop tables if exist
    cursor.execute("DROP TABLE IF EXISTS employee_bkup;")
    cursor.execute("DROP TABLE IF EXISTS Employee;")
    cursor.execute("DROP TABLE IF EXISTS Salary;")
    yield
    # Cleanup
    cursor.execute("DROP TABLE IF EXISTS employee_bkup;")
    cursor.execute("DROP TABLE IF EXISTS Employee;")
    cursor.execute("DROP TABLE IF EXISTS Salary;")

def test_correct_join_and_data_population(snowflake_connection):
    cursor = snowflake_connection.cursor()
    cursor.execute("""
        CREATE TABLE Employee (
            EmployeeNo INTEGER,
            FirstName VARCHAR(30),
            LastName VARCHAR(30),
            DepartmentNo SMALLINT
        );
    """)
    cursor.execute("""
        CREATE TABLE Salary (
            EmployeeNo INTEGER,
            NetPay INTEGER
        );
    """)
    cursor.execute("""
        INSERT INTO Employee VALUES
        (1, 'John', 'Doe', 10),
        (2, 'Jane', 'Smith', 20);
    """)
    cursor.execute("""
        INSERT INTO Salary VALUES
        (1, 5000),
        (2, 6000);
    """)
    cursor.execute("""
        DROP TABLE IF EXISTS employee_bkup;
        CREATE TABLE employee_bkup (
            EmployeeNo INTEGER,
            FirstName VARCHAR(30),
            LastName VARCHAR(30),
            DepartmentNo SMALLINT,
            NetPay INTEGER
        );
        INSERT INTO employee_bkup
        SELECT a.EmployeeNo, a.FirstName, a.LastName, a.DepartmentNo, b.NetPay
        FROM Employee a INNER JOIN Salary b ON a.EmployeeNo = b.EmployeeNo;
    """)
    cursor.execute("SELECT * FROM employee_bkup ORDER BY EmployeeNo;")
    results = cursor.fetchall()
    assert results == [
        (1, 'John', 'Doe', 10, 5000),
        (2, 'Jane', 'Smith', 20, 6000)
    ], "Join or data population failed"

def test_missing_employee_in_salary(snowflake_connection):
    cursor = snowflake_connection.cursor()
    cursor.execute("""
        CREATE TABLE Employee (
            EmployeeNo INTEGER,
            FirstName VARCHAR(30),
            LastName VARCHAR(30),
            DepartmentNo SMALLINT
        );
    """)
    cursor.execute("""
        CREATE TABLE Salary (
            EmployeeNo INTEGER,
            NetPay INTEGER
        );
    """)
    cursor.execute("""
        INSERT INTO Employee VALUES
        (1, 'John', 'Doe', 10),
        (2, 'Jane', 'Smith', 20),
        (3, 'Bob', 'Brown', 30);
    """)
    cursor.execute("""
        INSERT INTO Salary VALUES
        (1, 5000),
        (2, 6000);
    """)
    cursor.execute("""
        DROP TABLE IF EXISTS employee_bkup;
        CREATE TABLE employee_bkup (
            EmployeeNo INTEGER,
            FirstName VARCHAR(30),
            LastName VARCHAR(30),
            DepartmentNo SMALLINT,
            NetPay INTEGER
        );
        INSERT INTO employee_bkup
        SELECT a.EmployeeNo, a.FirstName, a.LastName, a.DepartmentNo, b.NetPay
        FROM Employee a INNER JOIN Salary b ON a.EmployeeNo = b.EmployeeNo;
    """)
    cursor.execute("SELECT EmployeeNo FROM employee_bkup;")
    results = set(row[0] for row in cursor.fetchall())
    assert results == {1, 2}, "Employees without salary should not be present"

def test_missing_salary_in_employee(snowflake_connection):
    cursor = snowflake_connection.cursor()
    cursor.execute("""
        CREATE TABLE Employee (
            EmployeeNo INTEGER,
            FirstName VARCHAR(30),
            LastName VARCHAR(30),
            DepartmentNo SMALLINT
        );
    """)
    cursor.execute("""
        CREATE TABLE Salary (
            EmployeeNo INTEGER,
            NetPay INTEGER
        );
    """)
    cursor.execute("""
        INSERT INTO Employee VALUES
        (1, 'John', 'Doe', 10),
        (2, 'Jane', 'Smith', 20);
    """)
    cursor.execute("""
        INSERT INTO Salary VALUES
        (1, 5000),
        (2, 6000),
        (3, 7000);
    """)
    cursor.execute("""
        DROP TABLE IF EXISTS employee_bkup;
        CREATE TABLE employee_bkup (
            EmployeeNo INTEGER,
            FirstName VARCHAR(30),
            LastName VARCHAR(30),
            DepartmentNo SMALLINT,
            NetPay INTEGER
        );
        INSERT INTO employee_bkup
        SELECT a.EmployeeNo, a.FirstName, a.LastName, a.DepartmentNo, b.NetPay
        FROM Employee a INNER JOIN Salary b ON a.EmployeeNo = b.EmployeeNo;
    """)
    cursor.execute("SELECT EmployeeNo FROM employee_bkup;")
    results = set(row[0] for row in cursor.fetchall())
    assert results == {1, 2}, "Salaries without employees should not be present"

def test_null_employee_no(snowflake_connection):
    cursor = snowflake_connection.cursor()
    cursor.execute("""
        CREATE TABLE Employee (
            EmployeeNo INTEGER,
            FirstName VARCHAR(30),
            LastName VARCHAR(30),
            DepartmentNo SMALLINT
        );
    """)
    cursor.execute("""
        CREATE TABLE Salary (
            EmployeeNo INTEGER,
            NetPay INTEGER
        );
    """)
    cursor.execute("""
        INSERT INTO Employee VALUES
        (NULL, 'Ghost', 'Null', 99),
        (1, 'John', 'Doe', 10);
    """)
    cursor.execute("""
        INSERT INTO Salary VALUES
        (1, 5000),
        (NULL, 0);
    """)
    cursor.execute("""
        DROP TABLE IF EXISTS employee_bkup;
        CREATE TABLE employee_bkup (
            EmployeeNo INTEGER,
            FirstName VARCHAR(30),
            LastName VARCHAR(30),
            DepartmentNo SMALLINT,
            NetPay INTEGER
        );
        INSERT INTO employee_bkup
        SELECT a.EmployeeNo, a.FirstName, a.LastName, a.DepartmentNo, b.NetPay
        FROM Employee a INNER JOIN Salary b ON a.EmployeeNo = b.EmployeeNo;
    """)
    cursor.execute("SELECT EmployeeNo FROM employee_bkup;")
    results = set(row[0] for row in cursor.fetchall())
    assert results == {1}, "Rows with NULL EmployeeNo should be excluded"

def test_empty_employee_table(snowflake_connection):
    cursor = snowflake_connection.cursor()
    cursor.execute("""
        CREATE TABLE Employee (
            EmployeeNo INTEGER,
            FirstName VARCHAR(30),
            LastName VARCHAR(30),
            DepartmentNo SMALLINT
        );
    """)
    cursor.execute("""
        CREATE TABLE Salary (
            EmployeeNo INTEGER,
            NetPay INTEGER
        );
    """)
    cursor.execute("""
        INSERT INTO Salary VALUES
        (1, 5000);
    """)
    cursor.execute("""
        DROP TABLE IF EXISTS employee_bkup;
        CREATE TABLE employee_bkup (
            EmployeeNo INTEGER,
            FirstName VARCHAR(30),
            LastName VARCHAR(30),
            DepartmentNo SMALLINT,
            NetPay INTEGER
        );
        INSERT INTO employee_bkup
        SELECT a.EmployeeNo, a.FirstName, a.LastName, a.DepartmentNo, b.NetPay
        FROM Employee a INNER JOIN Salary b ON a.EmployeeNo = b.EmployeeNo;
    """)
    cursor.execute("SELECT COUNT(*) FROM employee_bkup;")
    count = cursor.fetchone()[0]
    assert count == 0, "employee_bkup should be empty if Employee table is empty"

def test_empty_salary_table(snowflake_connection):
    cursor = snowflake_connection.cursor()
    cursor.execute("""
        CREATE TABLE Employee (
            EmployeeNo INTEGER,
            FirstName VARCHAR(30),
            LastName VARCHAR(30),
            DepartmentNo SMALLINT
        );
    """)
    cursor.execute("""
        CREATE TABLE Salary (
            EmployeeNo INTEGER,
            NetPay INTEGER
        );
    """)
    cursor.execute("""
        INSERT INTO Employee VALUES
        (1, 'John', 'Doe', 10);
    """)
    cursor.execute("""
        DROP TABLE IF EXISTS employee_bkup;
        CREATE TABLE employee_bkup (
            EmployeeNo INTEGER,
            FirstName VARCHAR(30),
            LastName VARCHAR(30),
            DepartmentNo SMALLINT,
            NetPay INTEGER
        );
        INSERT INTO employee_bkup
        SELECT a.EmployeeNo, a.FirstName, a.LastName, a.DepartmentNo, b.NetPay
        FROM Employee a INNER JOIN Salary b ON a.EmployeeNo = b.EmployeeNo;
    """)
    cursor.execute("SELECT COUNT(*) FROM employee_bkup;")
    count = cursor.fetchone()[0]
    assert count == 0, "employee_bkup should be empty if Salary table is empty"

def test_netpay_boundary_values(snowflake_connection):
    cursor = snowflake_connection.cursor()
    cursor.execute("""
        CREATE TABLE Employee (
            EmployeeNo INTEGER,
            FirstName VARCHAR(30),
            LastName VARCHAR(30),
            DepartmentNo SMALLINT
        );
    """)
    cursor.execute("""
        CREATE TABLE Salary (
            EmployeeNo INTEGER,
            NetPay INTEGER
        );
    """)
    cursor.execute("""
        INSERT INTO Employee VALUES
        (1, 'John', 'Doe', 10),
        (2, 'Jane', 'Smith', 20);
    """)
    cursor.execute("""
        INSERT INTO Salary VALUES
        (1, 0),
        (2, 2147483647);
    """)
    cursor.execute("""
        DROP TABLE IF EXISTS employee_bkup;
        CREATE TABLE employee_bkup (
            EmployeeNo INTEGER,
            FirstName VARCHAR(30),
            LastName VARCHAR(30),
            DepartmentNo SMALLINT,
            NetPay INTEGER
        );
        INSERT INTO employee_bkup
        SELECT a.EmployeeNo, a.FirstName, a.LastName, a.DepartmentNo, b.NetPay
        FROM Employee a INNER JOIN Salary b ON a.EmployeeNo = b.EmployeeNo;
    """)
    cursor.execute("SELECT NetPay FROM employee_bkup ORDER BY EmployeeNo;")
    results = [row[0] for row in cursor.fetchall()]
    assert results == [0, 2147483647], "NetPay boundary values not handled correctly"

def test_table_recreation(snowflake_connection):
    cursor = snowflake_connection.cursor()
    cursor.execute("""
        CREATE TABLE employee_bkup (
            EmployeeNo INTEGER,
            FirstName VARCHAR(30),
            LastName VARCHAR(30),
            DepartmentNo SMALLINT,
            NetPay INTEGER
        );
    """)
    cursor.execute("""
        DROP TABLE IF EXISTS employee_bkup;
        CREATE TABLE employee_bkup (
            EmployeeNo INTEGER,
            FirstName VARCHAR(30),
            LastName VARCHAR(30),
            DepartmentNo SMALLINT,
            NetPay INTEGER
        );
    """)
    cursor.execute("SHOW TABLES LIKE 'employee_bkup';")
    tables = cursor.fetchall()
    assert any('EMPLOYEE_BKUP' in row for row in tables), "employee_bkup table was not recreated"

```

**Cost Analysis**
API Cost: $0.0028
```