====================================================
Author:        Ascendion AAVA
Date:          
Description:   Informatica mapping and workflow documentation for PS_VENDOR vendor data ingestion and processing
====================================================

# 1. Overview of Graph/Component

This Informatica mapping and workflow (`m_aufi016d_PS_Vendor` / `wkf_aufi016d_PS_Vendor`) ingests vendor master data from a delimited flat file (`profrec_vendor.txt`), applies audit and load date enrichment, and loads the data into the `PS_VENDOR` table in the Profit Recovery Oracle database. The process ensures that vendor data from PeopleSoft is accurately transferred, with audit and operational metadata, to support downstream reporting and analytics.

# 2. Component Structure and Design

- **Source Definition:** `PS_VENDOR_S4` (Flat File, delimited by `||`)
- **Source Qualifier:** `SQ_PS_VENDOR_S4` (reads and passes all fields from source)
- **Expression Transformation:** `exp_Vendor` (adds audit year and load date, passes through all other fields)
- **Target Definition:** `PS_VENDOR` (Oracle table)
- **Session:** `s_m_aufi016d_PS_Vendor` (handles file reading, target loading, logging, and error management)
- **Workflow:** `wkf_aufi016d_PS_Vendor` (orchestrates the session execution)

**Logical Flow:**
- Source file → Source Qualifier → Expression → Target Table

**Key Components:**
- Input File: `profrec_vendor.txt`
- Transformations: Source Qualifier, Expression
- Output: Oracle Table `PS_VENDOR`
- Parameters: `$$Audit_Year` (default 2019), session and workflow variables for logging and error tracking

# 3. Data Flow and Processing Logic

**Processed Datasets:**
- Source: `profrec_vendor.txt` (delimited flat file)
- Target: `PS_VENDOR` (Oracle table)

**Data Flow:**
1. **Ingestion:** The session reads the vendor data from the flat file using the Source Definition and Source Qualifier.
2. **Transformation:** The Expression transformation sets the audit year (`AUD_YR_NBR`) from the parameter `$$Audit_Year` and the load date (`LOAD_DT`) from `SESSSTARTTIME`. All other fields are mapped directly.
3. **Loading:** The processed data is loaded into the `PS_VENDOR` Oracle table. The session is configured to insert new records and truncate the target table before loading.

# 4. Data Mapping (Lineage)

| Target Table Name | Target Column Name      | Source Table Name | Source Column Name      | Remarks                                   |
|-------------------|------------------------|-------------------|------------------------|--------------------------------------------|
| PS_VENDOR         | AUD_YR_NBR             | (Parameter)       | $$Audit_Year           | Transformation: Set from parameter         |
| PS_VENDOR         | SET_ID                 | PS_VENDOR_S4      | SET_ID                 | 1:1 Mapping                               |
| PS_VENDOR         | VENDOR_NBR_ID          | PS_VENDOR_S4      | VENDOR_NBR_ID          | 1:1 Mapping                               |
| PS_VENDOR         | VENDOR_SHORT_NAME      | PS_VENDOR_S4      | VENDOR_SHORT_NAME      | 1:1 Mapping                               |
| PS_VENDOR         | VENDOR_SHORT_USR_NAME  | PS_VENDOR_S4      | VENDOR_SHORT_USR_NAME  | 1:1 Mapping                               |
| PS_VENDOR         | NAME_1                 | PS_VENDOR_S4      | NAME_1                 | 1:1 Mapping                               |
| PS_VENDOR         | NAME_2                 | PS_VENDOR_S4      | NAME_2                 | 1:1 Mapping                               |
| PS_VENDOR         | VENDOR_STAT_CD         | PS_VENDOR_S4      | VENDOR_STAT_CD         | 1:1 Mapping                               |
| PS_VENDOR         | VENDOR_CLASS_CD        | PS_VENDOR_S4      | VENDOR_CLASS_CD        | 1:1 Mapping                               |
| PS_VENDOR         | REMIT_SET_ID           | PS_VENDOR_S4      | REMIT_SET_ID           | 1:1 Mapping                               |
| PS_VENDOR         | REMIT_VENDOR_ID        | PS_VENDOR_S4      | REMIT_VENDOR_ID        | 1:1 Mapping                               |
| PS_VENDOR         | CORP_SET_ID            | PS_VENDOR_S4      | CORP_SET_ID            | 1:1 Mapping                               |
| PS_VENDOR         | CORP_VENDOR_ID         | PS_VENDOR_S4      | CORP_VENDOR_ID         | 1:1 Mapping                               |
| PS_VENDOR         | ENTERED_BY_ID          | PS_VENDOR_S4      | ENTERED_BY_ID          | 1:1 Mapping                               |
| PS_VENDOR         | WTHD_SW_CD             | PS_VENDOR_S4      | WTHD_SW_CD             | 1:1 Mapping                               |
| PS_VENDOR         | PRIM_VENDOR_ID         | PS_VENDOR_S4      | PRIM_VENDOR_ID         | 1:1 Mapping                               |
| PS_VENDOR         | LOAD_DT                | (System Variable) | SESSSTARTTIME          | Transformation: Set to session start time  |
| PS_VENDOR         | ACCOUNT_GROUP          | PS_VENDOR_S4      | ACCOUNT_GROUP          | 1:1 Mapping                               |

# 5. Transformation Logic

- **Source Qualifier (`SQ_PS_VENDOR_S4`):** Passes all fields from the flat file source to the next stage.
- **Expression (`exp_Vendor`):**
    - `AUD_YR_NBR`: Set to `$$Audit_Year` (mapping parameter, default 2019).
    - `LOAD_DT`: Set to `SESSSTARTTIME` (session start time).
    - All other fields: Direct mapping (pass-through).
- **No joins, lookups, or aggregations are used.**

# 6. Complexity Analysis

- **Number of Mappings:** 1 (`m_aufi016d_PS_Vendor`)
- **Number of Lines of Code (in transformation or workflow):** ~400 (XML lines, including all definitions)
- **Transform Functions Used:** 2 (Source Qualifier, Expression)
- **Joins Used:** None
- **Lookup Files or Datasets:** None
- **Parameter Sets (session) or Plan Files Used:** 1 (`$$Audit_Year`)
- **Number of Output Datasets:** 1 (`PS_VENDOR`)
- **Conditional Logic or `if-else` flows:** 0
- **External Dependencies:** Oracle JDBC connection (`BAT_AUFI_RWH`), source file directory (`$PMSourceFileDir/corp/SrcFiles/`), session and workflow log directories
- **Overall Complexity Score:** 15 (Simple, direct mapping with minimal transformation)

# 7. Key Outputs

- **Target:** `PS_VENDOR` Oracle table
- **Format:** Relational table (Oracle), all fields mapped from source, with audit year and load date enrichment
- **Intended Use:** Downstream reporting, analytics, and regulatory processes

# 8. Error Handling and Logging

- **Reject Handling:** Bad records are written to `$PMBadFileDir/corp/BadFiles/ps_vendor1.bad`
- **Logging:** Session logs are written to `$PMSessionLogDir/corp/SessLogs/s_aufi016d_PS_Vendor.log`
- **Workflow logs:** `$PMWorkflowLogDir/corp/WorkflowLogs/wkf_aufi016d_PS_Vendor.log`
- **Error Management:** Session is configured to not abort on errors (`Rollback Transactions on Errors=NO`), and to continue workflow on failure (`Recovery Strategy=Fail task and continue workflow`)
- **No explicit reject or error transformation, but Informatica's session-level error and reject handling is used**

# 9. API Cost (Optional for Cloud Informatica Deployments)

**Not applicable for on-premises PowerCenter.**  
For cloud:  
- **Estimated Compute/IO Cost:**  
  - Data volume: Number of rows in `profrec_vendor.txt` × 18 columns × average row size (bytes)
  - Components: 2 transformations (minimal compute), 1 file read, 1 table write
  - Formula: `Cost = (Input MB + Output MB) × $/GB rate + session runtime × $/vCPU-hour`
  - For a typical 10,000-row file (~20KB/row): ~200MB processed; minimal transformation logic.
  - **Estimated Cost:** Low (<< $1 per run for standard Informatica Cloud rates)

---