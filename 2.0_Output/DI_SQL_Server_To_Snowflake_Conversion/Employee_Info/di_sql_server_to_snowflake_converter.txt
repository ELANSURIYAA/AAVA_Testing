=============================================
Author:        Ascendion AVA+
Created on:   
Description:   Snowflake script to create and populate a backup copy of Employee master data for troubleshooting and recovery, with error handling and conditional logic.
=============================================

-- Snowflake-Compatible Query:
```sql
-- Snowflake script to create a backup table and populate it from Employee and Salary tables.
-- Handles conditional population and error relay.

-- Drop the backup table if it exists
DROP TABLE IF EXISTS EMPLOYEE_BKUP;

-- Create the backup table
CREATE TABLE EMPLOYEE_BKUP (
    EmployeeNo INT NOT NULL PRIMARY KEY,
    FirstName STRING NOT NULL,
    LastName STRING NOT NULL,
    DepartmentNo SMALLINT,
    NetPay INT
);

-- Check if Employee table has rows and populate backup table accordingly
-- Snowflake does not support procedural IF EXISTS outside of scripting blocks,
-- so use scripting with exception handling.

-- Use Snowflake scripting (anonymous block)
BEGIN
    -- Check if Employee table has rows
    IF (SELECT COUNT(*) FROM EMPLOYEE) > 0 THEN
        -- Populate the backup table
        INSERT INTO EMPLOYEE_BKUP (EmployeeNo, FirstName, LastName, DepartmentNo, NetPay)
        SELECT e.EmployeeNo,
               e.FirstName,
               e.LastName,
               e.DepartmentNo,
               s.NetPay
        FROM EMPLOYEE AS e
        INNER JOIN SALARY AS s
            ON e.EmployeeNo = s.EmployeeNo;
    ELSE
        -- Drop the backup table if no rows found
        DROP TABLE IF EXISTS EMPLOYEE_BKUP;
    END IF;
EXCEPTION
    WHEN ANY THEN
        -- Relay error (Snowflake scripting automatically relays errors)
        -- Optionally, you can log or handle errors here
        -- For demonstration, re-raise the error
        RAISE;
END;

-- Optional: Update statistics is not required in Snowflake, as statistics are managed automatically.
-- Consider retention and purge policy using Snowflake's Time Travel and data lifecycle features.

```

API Cost Calculations
apiCost: 0.005 USD