=============================================
Author:        Ascendion AVA+
Created on:   
Description:   Snowflake script to create (or recreate) a backup copy of Employee master data keyed by EmployeeNo for troubleshooting, comparison, and recovery use-cases.
=============================================

-- Snowflake-Compatible Query:
```sql
-- Drop the backup table if it exists
DROP TABLE IF EXISTS employee_bkup;

-- Create the backup table
CREATE TABLE employee_bkup (
    EmployeeNo INT NOT NULL PRIMARY KEY,
    FirstName STRING NOT NULL,
    LastName STRING NOT NULL,
    DepartmentNo SMALLINT,
    NetPay INT
);

-- Populate the backup table if Employee table has rows
-- Snowflake does not support procedural IF EXISTS in pure SQL, so use a multi-step approach:
-- Step 1: Check if Employee table has rows (for scripting, this would be handled in Snowflake's Snowflake Scripting or via a client tool)

-- For pure SQL, insert if rows exist (the insert will do nothing if no rows exist)
INSERT INTO employee_bkup (EmployeeNo, FirstName, LastName, DepartmentNo, NetPay)
SELECT e.EmployeeNo,
       e.FirstName,
       e.LastName,
       e.DepartmentNo,
       s.NetPay
FROM Employee AS e
INNER JOIN Salary AS s
    ON e.EmployeeNo = s.EmployeeNo;

-- Optional: If you want to drop the table if no rows were inserted, you can check row count in Snowflake Scripting:
-- Example (Snowflake Scripting):
-- BEGIN
--   IF (SELECT COUNT(*) FROM employee_bkup) = 0 THEN
--     DROP TABLE employee_bkup;
--   END IF;
-- END;

-- Comments:
-- - Removed SQL Server-specific constructs (USE, GO, SET NOCOUNT ON, TRY/CATCH).
-- - Snowflake does not support procedural error handling in pure SQL; use Snowflake Scripting for advanced logic.
-- - Data types mapped: CHAR(30) → STRING, INT → INT, SMALLINT → SMALLINT.
-- - PRIMARY KEY is informational in Snowflake (not enforced).
-- - All logic is compatible with Snowflake SQL.

API Cost Calculations
apiCost: 0.002 USD