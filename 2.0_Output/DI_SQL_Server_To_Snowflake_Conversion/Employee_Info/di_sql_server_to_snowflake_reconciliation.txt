```
=============================================
Author:        Ascendion AVA+
Created on:   
Description:   Pytest script and test case suite for validating the Snowflake-compatible SQL script that creates/recreates a backup of Employee master data, keyed by EmployeeNo, for troubleshooting, point-in-time comparison, and recovery use-cases.
=============================================

import pytest
import snowflake.connector

# Helper fixture to setup and teardown Snowflake connection and test data
@pytest.fixture(scope="function")
def snowflake_test_env():
    # Setup Snowflake connection (replace with actual credentials/environment)
    conn = snowflake.connector.connect(
        user='YOUR_USER',
        password='YOUR_PASSWORD',
        account='YOUR_ACCOUNT',
        warehouse='YOUR_WAREHOUSE',
        database='YOUR_DATABASE',
        schema='YOUR_SCHEMA'
    )
    cur = conn.cursor()
    # Cleanup any existing test tables
    cur.execute("DROP TABLE IF EXISTS Employee")
    cur.execute("DROP TABLE IF EXISTS Salary")
    cur.execute("DROP TABLE IF EXISTS employee_bkup")
    yield cur
    # Teardown: Drop all test tables
    cur.execute("DROP TABLE IF EXISTS Employee")
    cur.execute("DROP TABLE IF EXISTS Salary")
    cur.execute("DROP TABLE IF EXISTS employee_bkup")
    cur.close()
    conn.close()

# Helper function to run the backup script
def run_backup_script(cur):
    # Simulate the converted Snowflake script logic
    cur.execute(\"""
        DROP TABLE IF EXISTS employee_bkup;
        CREATE TABLE employee_bkup AS
        SELECT e.EmployeeNo, e.Name, s.Salary
        FROM Employee e
        INNER JOIN Salary s ON e.EmployeeNo = s.EmployeeNo;
    \""")

# TC01: Happy Path - Standard backup creation
def test_backup_creation_happy_path(snowflake_test_env):
    cur = snowflake_test_env
    # Setup Employee and Salary tables
    cur.execute("CREATE TABLE Employee (EmployeeNo INT, Name STRING)")
    cur.execute("INSERT INTO Employee VALUES (1, 'Alice'), (2, 'Bob'), (3, 'Charlie')")
    cur.execute("CREATE TABLE Salary (EmployeeNo INT, Salary FLOAT)")
    cur.execute("INSERT INTO Salary VALUES (1, 50000), (2, 60000), (3, 55000)")
    run_backup_script(cur)
    cur.execute("SELECT * FROM employee_bkup ORDER BY EmployeeNo")
    result = cur.fetchall()
    assert result == [(1, 'Alice', 50000.0), (2, 'Bob', 60000.0), (3, 'Charlie', 55000.0)], "Backup table should contain all employees with correct salaries"

# TC02: Edge Case - Salary table missing EmployeeNo
def test_backup_creation_missing_salary(snowflake_test_env):
    cur = snowflake_test_env
    cur.execute("CREATE TABLE Employee (EmployeeNo INT, Name STRING)")
    cur.execute("INSERT INTO Employee VALUES (1, 'Alice'), (2, 'Bob'), (3, 'Charlie')")
    cur.execute("CREATE TABLE Salary (EmployeeNo INT, Salary FLOAT)")
    cur.execute("INSERT INTO Salary VALUES (1, 50000), (2, 60000)")  # Missing EmployeeNo 3
    run_backup_script(cur)
    cur.execute("SELECT * FROM employee_bkup ORDER BY EmployeeNo")
    result = cur.fetchall()
    assert result == [(1, 'Alice', 50000.0), (2, 'Bob', 60000.0)], "Backup table should only contain employees with matching salary records"

# TC03: Null Salary value
def test_backup_creation_null_salary(snowflake_test_env):
    cur = snowflake_test_env
    cur.execute("CREATE TABLE Employee (EmployeeNo INT, Name STRING)")
    cur.execute("INSERT INTO Employee VALUES (1, 'Alice'), (2, 'Bob')")
    cur.execute("CREATE TABLE Salary (EmployeeNo INT, Salary FLOAT)")
    cur.execute("INSERT INTO Salary VALUES (1, NULL), (2, 60000)")
    run_backup_script(cur)
    cur.execute("SELECT * FROM employee_bkup ORDER BY EmployeeNo")
    result = cur.fetchall()
    assert result == [(1, 'Alice', None), (2, 'Bob', 60000.0)], "Backup table should handle NULL salary values"

# TC04: Empty Employee table
def test_backup_creation_empty_employee(snowflake_test_env):
    cur = snowflake_test_env
    cur.execute("CREATE TABLE Employee (EmployeeNo INT, Name STRING)")
    cur.execute("CREATE TABLE Salary (EmployeeNo INT, Salary FLOAT)")
    cur.execute("INSERT INTO Salary VALUES (1, 50000)")
    run_backup_script(cur)
    cur.execute("SELECT COUNT(*) FROM employee_bkup")
    count = cur.fetchone()[0]
    assert count == 0, "Backup table should be empty if Employee table is empty"

# TC05: Empty Salary table
def test_backup_creation_empty_salary(snowflake_test_env):
    cur = snowflake_test_env
    cur.execute("CREATE TABLE Employee (EmployeeNo INT, Name STRING)")
    cur.execute("INSERT INTO Employee VALUES (1, 'Alice')")
    cur.execute("CREATE TABLE Salary (EmployeeNo INT, Salary FLOAT)")
    run_backup_script(cur)
    cur.execute("SELECT COUNT(*) FROM employee_bkup")
    count = cur.fetchone()[0]
    assert count == 0, "Backup table should be empty if Salary table is empty"

# TC06: Drop and recreate employee_bkup table
def test_backup_drop_and_recreate(snowflake_test_env):
    cur = snowflake_test_env
    cur.execute("CREATE TABLE Employee (EmployeeNo INT, Name STRING)")
    cur.execute("INSERT INTO Employee VALUES (1, 'Alice')")
    cur.execute("CREATE TABLE Salary (EmployeeNo INT, Salary FLOAT)")
    cur.execute("INSERT INTO Salary VALUES (1, 50000)")
    # Create old backup table
    cur.execute("CREATE TABLE employee_bkup (EmployeeNo INT, Name STRING, Salary FLOAT)")
    cur.execute("INSERT INTO employee_bkup VALUES (99, 'Old', 99999)")
    run_backup_script(cur)
    cur.execute("SELECT * FROM employee_bkup ORDER BY EmployeeNo")
    result = cur.fetchall()
    assert result == [(1, 'Alice', 50000.0)], "Backup table should be dropped and recreated with new data"

# TC07: Snowflake syntax compliance
def test_snowflake_syntax_compliance(snowflake_test_env):
    cur = snowflake_test_env
    try:
        cur.execute("CREATE TABLE Employee (EmployeeNo INT, Name STRING)")
        cur.execute("CREATE TABLE Salary (EmployeeNo INT, Salary FLOAT)")
        run_backup_script(cur)
    except Exception as e:
        pytest.fail(f"Snowflake syntax error: {e}")

# TC08: Performance for large dataset
def test_backup_creation_performance_large_dataset(snowflake_test_env):
    cur = snowflake_test_env
    cur.execute("CREATE TABLE Employee (EmployeeNo INT, Name STRING)")
    cur.execute("CREATE TABLE Salary (EmployeeNo INT, Salary FLOAT)")
    # Insert 10,000 records
    for i in range(1, 10001):
        cur.execute(f"INSERT INTO Employee VALUES ({i}, 'Emp{i}')")
        cur.execute(f"INSERT INTO Salary VALUES ({i}, {50000 + i})")
    import time
    start = time.time()
    run_backup_script(cur)
    duration = time.time() - start
    cur.execute("SELECT COUNT(*) FROM employee_bkup")
    count = cur.fetchone()[0]
    assert count == 10000, "Backup table should contain all records"
    assert duration < 10, "Backup creation should be efficient (<10s for 10,000 records)"

# Note: Replace Snowflake credentials and connection details with real values.
# Each test case is logically grouped and includes comments for clarity.

# API Cost Calculation
# apiCost: 0.0042 USD
```
apiCost: 0.0042 USD