Below is the complete Python script:

```python
import os
import pandas as pd
import pyarrow.parquet as pq
import ibm_db
import cx_Oracle
from datetime import datetime
import logging

# Configure logging
logging.basicConfig(level=logging.INFO, format='%(asctime)s - %(levelname)s - %(message)s')

# Environment variables for credentials
DB2_CREDENTIALS = {
    "dsn": os.getenv("DB2_DSN"),
    "user": os.getenv("DB2_USER"),
    "password": os.getenv("DB2_PASSWORD")
}

ORACLE_CREDENTIALS = {
    "dsn": cx_Oracle.makedsn(os.getenv("ORACLE_HOST"), os.getenv("ORACLE_PORT"), service_name=os.getenv("ORACLE_SERVICE")),
    "user": os.getenv("ORACLE_USER"),
    "password": os.getenv("ORACLE_PASSWORD")
}

# Step 1: DB2 SQL Execution
def execute_db2_sql(sql_code):
    conn = ibm_db.connect(DB2_CREDENTIALS["dsn"], DB2_CREDENTIALS["user"], DB2_CREDENTIALS["password"])
    stmt = ibm_db.exec_immediate(conn, sql_code)
    rows = []
    result = ibm_db.fetch_assoc(stmt)
    while result:
        rows.append(result)
        result = ibm_db.fetch_assoc(stmt)
    ibm_db.close(conn)
    return rows

# Step 2: Export DB2 Data to CSV and Parquet
def export_db2_to_parquet(data, table_name):
    timestamp = datetime.now().strftime("%Y%m%d%H%M%S")
    csv_file = f"{table_name}_{timestamp}.csv"
    parquet_file = f"{table_name}_{timestamp}.parquet"
    df = pd.DataFrame(data)
    df.to_csv(csv_file, index=False)
    df.to_parquet(parquet_file, index=False)
    return parquet_file

# Step 3: Transfer Parquet Files to Oracle Exadata
def transfer_to_oracle(parquet_file):
    # Assuming SCP or similar method for file transfer
    os.system(f"scp {parquet_file} oracle_user@oracle_host:/oracle_staging/")
    logging.info(f"Transferred {parquet_file} to Oracle Exadata staging area.")

# Step 4: Create Oracle External Tables
def create_oracle_external_table(parquet_file, table_name):
    conn = cx_Oracle.connect(ORACLE_CREDENTIALS["user"], ORACLE_CREDENTIALS["password"], ORACLE_CREDENTIALS["dsn"])
    cursor = conn.cursor()
    external_table_sql = f"""
    CREATE TABLE {table_name}_ext (
        -- Define columns here based on DB2 schema
    )
    ORGANIZATION EXTERNAL
    (TYPE ORACLE_LOADER DEFAULT DIRECTORY oracle_staging
    ACCESS PARAMETERS (FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"')
    LOCATION ('{parquet_file}'))
    REJECT LIMIT UNLIMITED;
    """
    cursor.execute(external_table_sql)
    conn.commit()
    conn.close()
    logging.info(f"Created external table {table_name}_ext in Oracle Exadata.")

# Step 5: Execute Oracle SQL Code
def execute_oracle_sql(sql_code):
    conn = cx_Oracle.connect(ORACLE_CREDENTIALS["user"], ORACLE_CREDENTIALS["password"], ORACLE_CREDENTIALS["dsn"])
    cursor = conn.cursor()
    cursor.execute(sql_code)
    rows = cursor.fetchall()
    conn.close()
    return rows

# Step 6: Compare Results
def compare_results(db2_data, oracle_data):
    db2_df = pd.DataFrame(db2_data)
    oracle_df = pd.DataFrame(oracle_data)
    comparison = db2_df.equals(oracle_df)
    return comparison

# Step 7: Generate Report
def generate_report(comparison_results):
    report = {
        "match_status": "MATCH" if comparison_results else "NO MATCH",
        "details": "Comparison successful" if comparison_results else "Discrepancies found"
    }
    report_file = "comparison_report.json"
    with open(report_file, "w") as f:
        f.write(str(report))
    logging.info(f"Generated comparison report: {report_file}")

# Main function
def main():
    # Read DB2 and Oracle SQL from files
    with open("DB2_Sales_Performance.txt", "r") as f:
        db2_sql = f.read()
    with open("DB2_to_Oracle_Analyzer_Output.txt", "r") as f:
        oracle_sql = f.read()

    # Execute DB2 SQL
    db2_data = execute_db2_sql(db2_sql)

    # Export DB2 data to Parquet
    parquet_file = export_db2_to_parquet(db2_data, "sales_performance")

    # Transfer Parquet file to Oracle
    transfer_to_oracle(parquet_file)

    # Create Oracle external table
    create_oracle_external_table(parquet_file, "sales_performance")

    # Execute Oracle SQL
    oracle_data = execute_oracle_sql(oracle_sql)

    # Compare results
    comparison_results = compare_results(db2_data, oracle_data)

    # Generate report
    generate_report(comparison_results)

if __name__ == "__main__":
    main()
```