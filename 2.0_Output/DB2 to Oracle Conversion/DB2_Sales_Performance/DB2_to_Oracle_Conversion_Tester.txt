1. Test Case Document:

| Test Case ID | Description | Preconditions | Test Steps | Expected Result | Actual Result | Pass/Fail Status |
|--------------|-------------|---------------|------------|-----------------|---------------|-------------------|
| TC001        | Validate the correct categorization of customers into age groups based on their age. | DB2 SQL and Oracle SQL scripts are available. | 1. Execute the Oracle SQL script. 2. Verify the age group categorization in the output. | Customers are correctly categorized into '18-25', '26-35', '36-45', '46-55', or '55+' age groups. | TBD | TBD |
| TC002        | Verify the aggregation of sales data for each customer, including total orders, total revenue, and average order value. | DB2 SQL and Oracle SQL scripts are available. | 1. Execute the Oracle SQL script. 2. Verify the aggregated sales data in the output. | Aggregated sales data matches the expected values for each customer. | TBD | TBD |
| TC003        | Ensure proper handling of NULL values in the sales transactions data. | DB2 SQL and Oracle SQL scripts are available. | 1. Execute the Oracle SQL script. 2. Verify the handling of NULL values in the output. | NULL values do not cause errors, and calculations handle them gracefully. | TBD | TBD |
| TC004        | Validate the calculation of customer lifetime value and segmentation into 'Premium', 'Gold', 'Silver', and 'Bronze'. | DB2 SQL and Oracle SQL scripts are available. | 1. Execute the Oracle SQL script. 2. Verify the customer segmentation in the output. | Customers are correctly segmented based on their total revenue. | TBD | TBD |
| TC005        | Verify the ranking of customers based on their comprehensive performance score. | DB2 SQL and Oracle SQL scripts are available. | 1. Execute the Oracle SQL script. 2. Verify the customer ranking in the output. | Customers are ranked correctly, and the top 100 customers per segment are selected. | TBD | TBD |
| TC006        | Test the performance of the SQL script with a large dataset. | DB2 SQL and Oracle SQL scripts are available. | 1. Execute the Oracle SQL script with a large dataset. 2. Measure the execution time. | The script executes within an acceptable time frame without errors. | TBD | TBD |

2. Pytest Script for Each Test Case:

```python
import pytest
import cx_Oracle

# Database connection setup
@pytest.fixture(scope="module")
def db_connection():
    dsn = cx_Oracle.makedsn("host", "port", service_name="service")
    connection = cx_Oracle.connect(user="username", password="password", dsn=dsn)
    yield connection
    connection.close()

# Test Case TC001
def test_age_group_categorization(db_connection):
    cursor = db_connection.cursor()
    cursor.execute("SELECT age, age_group FROM customer_dimension")
    results = cursor.fetchall()
    for age, age_group in results:
        if 18 <= age <= 25:
            assert age_group == '18-25'
        elif 26 <= age <= 35:
            assert age_group == '26-35'
        elif 36 <= age <= 45:
            assert age_group == '36-45'
        elif 46 <= age <= 55:
            assert age_group == '46-55'
        else:
            assert age_group == '55+'

# Test Case TC002
def test_sales_aggregation(db_connection):
    cursor = db_connection.cursor()
    cursor.execute("SELECT customer_id, total_orders, total_revenue, average_order_value FROM sales_analysis")
    results = cursor.fetchall()
    for customer_id, total_orders, total_revenue, average_order_value in results:
        assert total_orders >= 0
        assert total_revenue >= 0
        assert average_order_value >= 0

# Test Case TC003
def test_null_handling(db_connection):
    cursor = db_connection.cursor()
    cursor.execute("SELECT * FROM sales_transactions WHERE total_sale_amount IS NULL")
    results = cursor.fetchall()
    assert len(results) == 0  # Assuming NULL values are not allowed

# Test Case TC004
def test_customer_segmentation(db_connection):
    cursor = db_connection.cursor()
    cursor.execute("SELECT customer_id, total_revenue, customer_segment FROM customer_lifetime_value")
    results = cursor.fetchall()
    for customer_id, total_revenue, customer_segment in results:
        if total_revenue > 10000:
            assert customer_segment == 'Premium'
        elif 5000 <= total_revenue <= 10000:
            assert customer_segment == 'Gold'
        elif 1000 <= total_revenue < 5000:
            assert customer_segment == 'Silver'
        else:
            assert customer_segment == 'Bronze'

# Test Case TC005
def test_customer_ranking(db_connection):
    cursor = db_connection.cursor()
    cursor.execute("SELECT customer_id, segment_rank FROM ranked_customers WHERE segment_rank <= 100")
    results = cursor.fetchall()
    assert len(results) <= 100  # Ensure only top 100 customers are selected

# Test Case TC006
def test_script_performance(db_connection):
    import time
    start_time = time.time()
    cursor = db_connection.cursor()
    cursor.execute("SELECT * FROM ranked_customers")
    results = cursor.fetchall()
    end_time = time.time()
    execution_time = end_time - start_time
    assert execution_time < 60  # Ensure the script executes within 60 seconds
```

3. Cost Consumed:
   - API Cost: 0.0437 USD