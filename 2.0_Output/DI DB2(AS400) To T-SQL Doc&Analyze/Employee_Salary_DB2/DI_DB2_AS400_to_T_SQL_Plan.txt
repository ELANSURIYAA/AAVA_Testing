=====================================================
Author:        AAVA
Date:          
Description:   Returns total salary and bonus count for a department
=====================================================

1. Code Fixing and Data Recon Testing Effort Estimation

1.1 Manual Code Fixes and Data Recon Testing Effort (in hours)

Manual Code Fixes:
- Exception Handling: DB2's `DECLARE EXIT HANDLER FOR SQLEXCEPTION` must be rewritten as T-SQL `TRY/CATCH` blocks. Estimated effort: 1 hour.
- Cursor Handling: DB2 cursor declaration, opening, fetching, and loop (`WHILE END_TABLE = 0 DO`) must be translated to T-SQL equivalents (`DECLARE CURSOR`, `OPEN`, `FETCH NEXT`, `WHILE @@FETCH_STATUS = 0`). Estimated effort: 1 hour.
- Block Labels: Remove `P1:` label as T-SQL does not support block labels. Estimated effort: 0.25 hour.
- Variable Declarations: Adjust `DECLARE` syntax and default value assignment to T-SQL style. Estimated effort: 0.5 hour.
- OUT Parameter Syntax: Adjust procedure parameter definition to T-SQL style. Estimated effort: 0.25 hour.
- IF/WHILE Syntax: Adjust control flow syntax to T-SQL. Estimated effort: 0.5 hour.
- SET Assignments: Ensure T-SQL assignment style (`SET` or `SELECT`). Estimated effort: 0.25 hour.

Total Manual Code Fixing Effort: 3.75 hours

Data Reconciliation and Validation Testing Effort:
- Number of Queries: 1 (cursor SELECT)
- Data Volume: Depends on department size; assuming moderate (hundreds to thousands of rows per department).
- Use of Base Tables: 1 (`CORPDATA.EMPLOYEE`)
- Temporary Tables: 0
- Aggregation Logic: Procedural sum and count, requires validation against set-based aggregation in T-SQL.
- Test Cases:
  - Validate total salary and bonus count for multiple departments.
  - Edge cases: Departments with no employees, employees with no bonus, all employees with bonus.
  - Compare output between DB2 and T-SQL for sample data sets.
  - Validate error handling (e.g., invalid department number).
- Data Reconciliation Steps:
  - Extract results from DB2 and T-SQL for same input.
  - Compare outputs for salary and bonus count.
  - Document discrepancies and investigate root cause.
  - Regression testing after fixes.

Estimated Data Reconciliation and Validation Testing Effort: 6 hours

Total Effort Estimation:
- Manual Code Fixes: 3.75 hours
- Data Reconciliation and Validation Testing: 6 hours

**Grand Total: 9.75 hours**

(rounded up for planning: 10 hours)

---

**Effort Breakdown:**
| Activity                                 | Estimated Hours |
|-------------------------------------------|-----------------|
| Manual Code Fixes                        | 3.75            |
| Data Recon & Validation Testing           | 6.00            |
| **Total**                                | **9.75**        |

---

**Notes:**
- Effort assumes moderate data volume and no unforeseen schema issues.
- Does not include basic syntax translation (handled by automated tools).
- Includes manual intervention for procedural logic, data type mapping, and exception handling.
- Testing effort includes validation of business logic and output correctness.

**End of Estimation**