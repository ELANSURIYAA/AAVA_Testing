Converted Query : Delta Script

```sql
-- Delta SQL Script Equivalent

-- Step 1: Filter sales data for the last 12 months
WITH FilteredSales AS (
    SELECT 
        s.order_id,
        s.product_id,
        p.category_id,
        r.region_id,
        s.order_date,
        CAST(s.quantity * s.price AS DECIMAL(10,2)) AS revenue
    FROM sales s
    INNER JOIN products p ON s.product_id = p.product_id
    INNER JOIN regions r ON s.region_id = r.region_id
    WHERE s.order_date >= DATE_ADD(CURRENT_DATE(), -365)
),

-- Step 2: Calculate total revenue and average order value for each category within each region
CategoryRevenue AS (
    SELECT 
        f.region_id,
        f.category_id,
        SUM(f.revenue) AS total_revenue,
        AVG(f.revenue) AS avg_order_value
    FROM FilteredSales f
    GROUP BY f.region_id, f.category_id
),

-- Step 3: Rank categories within each region based on total revenue
RankedCategories AS (
    SELECT 
        cr.region_id,
        cr.category_id,
        cr.total_revenue,
        cr.avg_order_value,
        RANK() OVER (PARTITION BY cr.region_id ORDER BY cr.total_revenue DESC) AS category_rank
    FROM CategoryRevenue cr
)

-- Step 4: Select top 3 categories for each region and order the results
SELECT 
    rc.region_id,
    rc.category_id,
    rc.total_revenue,
    rc.avg_order_value,
    rc.category_rank
FROM RankedCategories rc
WHERE rc.category_rank <= 3
ORDER BY rc.region_id, rc.category_rank;
```