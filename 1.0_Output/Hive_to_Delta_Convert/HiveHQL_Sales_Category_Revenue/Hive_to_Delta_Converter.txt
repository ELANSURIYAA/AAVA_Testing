Converted Query : Delta Script

```sql
-- Delta Script: Calculate total revenue and average order value for each product category within each region over the past 12 months.
-- This script ranks categories within regions based on total revenue and selects the top 3 categories.

WITH FilteredSales AS (
    SELECT 
        s.order_id,
        s.product_id,
        p.category_id,
        r.region_id,
        s.order_date,
        CAST(s.quantity * s.price AS DECIMAL(10,2)) AS revenue
    FROM sales s
    INNER JOIN products p ON s.product_id = p.product_id
    INNER JOIN regions r ON s.region_id = r.region_id
    WHERE s.order_date >= DATEADD(MONTH, -12, CURRENT_DATE())
),
CategoryRevenue AS (
    SELECT 
        f.region_id,
        f.category_id,
        SUM(f.revenue) AS total_revenue,
        AVG(f.revenue) AS avg_order_value
    FROM FilteredSales f
    GROUP BY f.region_id, f.category_id
),
RankedCategories AS (
    SELECT 
        cr.region_id,
        cr.category_id,
        cr.total_revenue,
        cr.avg_order_value,
        RANK() OVER (PARTITION BY cr.region_id ORDER BY cr.total_revenue DESC) AS category_rank
    FROM CategoryRevenue cr
)
SELECT 
    rc.region_id,
    rc.category_id,
    rc.total_revenue,
    rc.avg_order_value,
    rc.category_rank
FROM RankedCategories rc
WHERE rc.category_rank <= 3
ORDER BY rc.region_id, rc.category_rank;

-- Notes:
-- 1. The Hive function `ADD_MONTHS` is replaced with Delta's `DATEADD` function.
-- 2. The `CAST` function is retained as it is compatible with Delta.
-- 3. The `RANK` window function is directly supported in Delta.
-- 4. The script uses Delta's native SQL syntax for joins and window functions.
-- 5. Ensure that the `sales`, `products`, and `regions` tables are in Delta format.
```