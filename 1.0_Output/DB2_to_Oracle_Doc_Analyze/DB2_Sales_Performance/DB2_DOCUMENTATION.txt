# Db2 Database Documentation

## Database Overview
This database is designed to support customer segmentation, sales analysis, and performance metrics. It includes various dimensions and fact tables to analyze customer behavior, sales trends, product performance, and regional performance. The database also calculates advanced metrics such as customer lifetime value and comprehensive performance scores.

---

## Schema Details

### Tables and Views
Below are the key tables and views defined in the database:

#### 1. `customer_master`
**Description**: Stores customer demographic and registration information.

| Column Name       | Data Type | Description                       |
|--------------------|-----------|-----------------------------------|
| `customer_id`      | INT       | Unique identifier for customers. |
| `first_name`       | VARCHAR   | Customer's first name.           |
| `last_name`        | VARCHAR   | Customer's last name.            |
| `email`            | VARCHAR   | Customer's email address.        |
| `state`            | VARCHAR   | State of residence.              |
| `age`              | INT       | Customer's age.                  |
| `registration_date`| DATE      | Date of registration.            |

#### 2. `sales_transactions`
**Description**: Stores sales transaction details.

| Column Name          | Data Type | Description                              |
|-----------------------|-----------|------------------------------------------|
| `order_id`           | INT       | Unique identifier for orders.           |
| `customer_id`        | INT       | Identifier linking to `customer_master`.|
| `product_category`   | VARCHAR   | Category of the product sold.           |
| `total_sale_amount`  | DECIMAL   | Total sale amount for the transaction.  |
| `order_date`         | DATE      | Date of the order.                      |
| `quantity_sold`      | INT       | Quantity of items sold.                 |
| `unit_price`         | DECIMAL   | Price per unit of the product.          |

---

### Views and Derived Metrics

#### 1. `customer_dimension`
**Description**: Prepares customer demographic data with age group categorization.

| Derived Columns      | Description                                   |
|-----------------------|-----------------------------------------------|
| `age_group`          | Categorizes customers into age groups.       |

#### 2. `sales_analysis`
**Description**: Aggregates sales data for each customer.

| Derived Columns         | Description                                  |
|--------------------------|----------------------------------------------|
| `total_orders`          | Total number of orders placed by a customer.|
| `total_revenue`         | Total revenue generated by a customer.      |
| `average_order_value`   | Average value of orders placed.             |
| `unique_product_categories`| Number of unique product categories purchased.|
| `first_purchase_date`   | Date of the first purchase.                 |
| `last_purchase_date`    | Date of the most recent purchase.           |
| `total_units_sold`      | Total quantity of items sold.               |

#### 3. `product_performance`
**Description**: Analyzes product category performance.

| Derived Columns           | Description                                |
|----------------------------|--------------------------------------------|
| `category_total_revenue`  | Total revenue for each product category.  |
| `category_total_units`    | Total units sold for each product category.|
| `average_unit_price`      | Average price per unit in the category.   |
| `unique_products`         | Number of unique products in the category.|

#### 4. `seasonal_sales`
**Description**: Tracks sales trends over time.

| Derived Columns       | Description                                   |
|------------------------|-----------------------------------------------|
| `sales_year`          | Year of the transaction.                     |
| `sales_month`         | Month of the transaction.                    |
| `monthly_revenue`     | Total revenue for the month.                 |
| `monthly_units_sold`  | Total units sold in the month.               |
| `active_customers`    | Number of unique customers in the month.     |

#### 5. `regional_performance`
**Description**: Analyzes sales performance by region.

| Derived Columns           | Description                                |
|----------------------------|--------------------------------------------|
| `state_total_revenue`     | Total revenue generated in the state.     |
| `state_total_customers`   | Number of unique customers in the state.  |
| `state_average_order_value`| Average order value in the state.        |

#### 6. `customer_lifetime_value`
**Description**: Calculates customer lifetime value and segments customers.

| Derived Columns           | Description                                |
|----------------------------|--------------------------------------------|
| `customer_segment`        | Categorizes customers into segments (e.g., Premium, Gold).|
| `customer_value_score`    | Scoring based on revenue and order frequency.|

#### 7. `customer_segmentation`
**Description**: Combines customer demographics, sales analysis, and lifetime value.

| Derived Columns               | Description                            |
|--------------------------------|----------------------------------------|
| `revenue_rank`               | Rank based on total revenue.           |
| `order_frequency_percentile` | Percentile rank based on order frequency.|
| `purchase_behavior`          | Categorizes customers based on order frequency.|
| `months_since_last_purchase` | Months since the last purchase.        |
| `category_diversity_index`   | Measures cross-category engagement.    |

#### 8. `comprehensive_performance`
**Description**: Combines all metrics for a comprehensive performance score.

| Derived Columns                   | Description                          |
|------------------------------------|--------------------------------------|
| `comprehensive_performance_score`| Weighted score based on multiple factors.|

#### 9. `ranked_customers`
**Description**: Ranks customers within each segment.

| Derived Columns   | Description                                       |
|--------------------|---------------------------------------------------|
| `segment_rank`    | Rank within the customer segment.                 |

---

## Relationships and Dependencies
- **`customer_master`** is the primary source for customer demographic data.
- **`sales_transactions`** links to `customer_master` via `customer_id`.
- Derived views such as `customer_dimension`, `sales_analysis`, and `product_performance` depend on these base tables.

---

## Advanced Metrics
- **Customer Lifetime Value (CLV)**: Combines revenue, order frequency, and segment multipliers.
- **Comprehensive Performance Score**: Weighted score based on revenue, orders, and product diversity.

---

## Challenges and Recommendations
### Challenges
1. **Conversion to Oracle Exadata**:
   - Functions like `DAYS` and `INT` need to be replaced with Oracle equivalents.
   - `NULLIF` and `ROUND` functions should be reviewed for compatibility.

2. **Performance Optimization**:
   - Complex joins and window functions may require optimization in Oracle.

### Recommendations
- Use Oracle's `MONTHS_BETWEEN` for date calculations.
- Replace `INT` with `CAST` or `TRUNC` in Oracle.
- Optimize window functions using Oracle's advanced analytical capabilities.

---

This documentation provides a detailed overview of the Db2 database structure, derived metrics, and recommendations for transitioning to Oracle Exadata.