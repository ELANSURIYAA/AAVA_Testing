## 1. Field Mapping Table

| API Payload Field                  | Database Column (from Mapping Sheet)         | Notes/Transformations                          |
|------------------------------------|----------------------------------------------|------------------------------------------------|
| accountNumber                      | MaskedAccountNumber                          | Masked, string                                 |
| customerId                         | CustomerID                                   | String                                         |
| customerName.firstName             | FirstName                                    | String                                         |
| customerName.lastName              | LastName                                     | String                                         |
| customerName.middleInitial         | MiddleInitial                                | String                                         |
| address.line1                      | AddressLine1                                 | String                                         |
| address.line2                      | AddressLine2                                 | String                                         |
| address.city                       | City                                         | String                                         |
| address.state                      | State                                        | String                                         |
| address.postalCode                 | PostalCode                                   | String                                         |
| address.country                    | Country                                      | String                                         |
| phoneNumbers[type=Mobile].number   | PhoneMobile                                  | Map by type                                    |
| phoneNumbers[type=Home].number     | PhoneHome                                    | Map by type                                    |
| email                              | Email                                        | String                                         |
| cardStatus                         | CardStatus                                   | String                                         |
| cardType                           | CardType                                     | String                                         |
| productCode                        | ProductCode                                  | String                                         |
| billingCycleDay                    | BillingCycleDay                              | Integer                                        |
| creditLimit                        | CreditLimit                                  | Decimal                                        |
| availableCredit                    | AvailableCredit                              | Decimal                                        |
| balance                            | Balance                                      | Decimal                                        |
| paymentDueDate                     | PaymentDueDate                               | Date (YYYY-MM-DD)                              |
| lastPaymentAmount                  | LastPaymentAmount                            | Decimal                                        |
| lastPaymentDate                    | LastPaymentDate                              | Date (YYYY-MM-DD)                              |

**Notes:**
- All fields map directly, except for phoneNumbers which must be split by type.
- All fields are in a single table (as per mapping and sample data).
- No nested/joined tables are required for this payload.

---

## 2. SQL Query

```sql
SELECT
    CustomerID AS customerId,
    FirstName AS "customerName.firstName",
    LastName AS "customerName.lastName",
    MiddleInitial AS "customerName.middleInitial",
    MaskedAccountNumber AS accountNumber,
    AddressLine1 AS "address.line1",
    AddressLine2 AS "address.line2",
    City AS "address.city",
    State AS "address.state",
    PostalCode AS "address.postalCode",
    Country AS "address.country",
    PhoneMobile AS "phoneNumbers.mobile",
    PhoneHome AS "phoneNumbers.home",
    Email AS email,
    CardStatus AS cardStatus,
    CardType AS cardType,
    ProductCode AS productCode,
    BillingCycleDay AS billingCycleDay,
    CreditLimit AS creditLimit,
    AvailableCredit AS availableCredit,
    Balance AS balance,
    PaymentDueDate AS paymentDueDate,
    LastPaymentAmount AS lastPaymentAmount,
    LastPaymentDate AS lastPaymentDate
FROM
    TSYS_CustomerData
WHERE
    -- Example filter: filter by a specific CustomerID or AccountNumber
    CustomerID = 'TSYS4641708'
ORDER BY
    CustomerID
LIMIT 100 OFFSET 0; -- Pagination example
```

---

## 3. Alternative Queries

### a) Filter by Multiple CustomerIDs (from API payload array)

```sql
SELECT
    CustomerID AS customerId,
    FirstName AS "customerName.firstName",
    LastName AS "customerName.lastName",
    MiddleInitial AS "customerName.middleInitial",
    MaskedAccountNumber AS accountNumber,
    AddressLine1 AS "address.line1",
    AddressLine2 AS "address.line2",
    City AS "address.city",
    State AS "address.state",
    PostalCode AS "address.postalCode",
    Country AS "address.country",
    PhoneMobile AS "phoneNumbers.mobile",
    PhoneHome AS "phoneNumbers.home",
    Email AS email,
    CardStatus AS cardStatus,
    CardType AS cardType,
    ProductCode AS productCode,
    BillingCycleDay AS billingCycleDay,
    CreditLimit AS creditLimit,
    AvailableCredit AS availableCredit,
    Balance AS balance,
    PaymentDueDate AS paymentDueDate,
    LastPaymentAmount AS lastPaymentAmount,
    LastPaymentDate AS lastPaymentDate
FROM
    TSYS_CustomerData
WHERE
    CustomerID IN (
        'TSYS4641708',
        'TSYS8506716',
        'TSYS1436349',
        'TSYS7190229',
        'TSYS6488771',
        'TSYS7034824',
        'TSYS8755886',
        'TSYS4556238',
        'TSYS9743953',
        'TSYS1370985'
    )
ORDER BY
    CustomerID
LIMIT 100 OFFSET 0;
```

### b) Filter by Card Status (e.g., only "Active" cards)

```sql
SELECT
    CustomerID AS customerId,
    FirstName AS "customerName.firstName",
    LastName AS "customerName.lastName",
    MiddleInitial AS "customerName.middleInitial",
    MaskedAccountNumber AS accountNumber,
    AddressLine1 AS "address.line1",
    AddressLine2 AS "address.line2",
    City AS "address.city",
    State AS "address.state",
    PostalCode AS "address.postalCode",
    Country AS "address.country",
    PhoneMobile AS "phoneNumbers.mobile",
    PhoneHome AS "phoneNumbers.home",
    Email AS email,
    CardStatus AS cardStatus,
    CardType AS cardType,
    ProductCode AS productCode,
    BillingCycleDay AS billingCycleDay,
    CreditLimit AS creditLimit,
    AvailableCredit AS availableCredit,
    Balance AS balance,
    PaymentDueDate AS paymentDueDate,
    LastPaymentAmount AS lastPaymentAmount,
    LastPaymentDate AS lastPaymentDate
FROM
    TSYS_CustomerData
WHERE
    CardStatus = 'Active'
ORDER BY
    CustomerID
LIMIT 100 OFFSET 0;
```

---

## Special Considerations

- **Date/Time Formats:** If the database stores dates in a different format, use `TO_CHAR()` or `CAST()` as needed.
- **Case Sensitivity:** Use `ILIKE` or `LOWER()` for case-insensitive string comparisons if required.
- **Null Handling:** Use `COALESCE()` to provide defaults if needed (e.g., `COALESCE(AddressLine2, '')`).
- **Pagination:** Use `LIMIT` and `OFFSET` for large result sets.
- **Indexes:** Ensure indexes on `CustomerID`, `MaskedAccountNumber`, and `CardStatus` for performance.
- **Data Transformations:** If phone numbers need to be split into a separate table or normalized, consider a JOIN, but with the current mapping, all data is in one table.
- **Error Handling:** If a relationship is missing (e.g., phone type not present), return `NULL` for that field.

---

**This output provides a clear mapping, a ready-to-use SQL query, alternatives for common use cases, and best practices for handling special considerations.**