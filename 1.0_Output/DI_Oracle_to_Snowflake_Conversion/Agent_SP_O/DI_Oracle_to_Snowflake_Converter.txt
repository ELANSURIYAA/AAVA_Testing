=============================================
Author:        Ascendion AVA+
Date:          [Insert Date]
Description:   Snowflake Procedure to load agent data from staging to target table
=============================================

```sql
CREATE OR REPLACE PROCEDURE LOAD_GOLD_AGENTS()
RETURNS STRING
LANGUAGE SQL
AS
$$
DECLARE
    v_start_time TIMESTAMP;
    v_status STRING;
    v_message STRING;
BEGIN
    -- Initialize start time
    LET v_start_time = CURRENT_TIMESTAMP;

    -- Merge to handle upsert logic
    MERGE INTO GOLD_AGENTS_D AS tgt
    USING (
        SELECT 
            AGENT_ID,
            AGENT_NAME,
            SOURCE_SYSTEM
        FROM STAGE_AGENTS
    ) AS src
    ON tgt.AGENT_ID = src.AGENT_ID

    WHEN MATCHED THEN
        UPDATE SET
            AGENT_NAME = src.AGENT_NAME,
            UPDATE_DATE = CURRENT_TIMESTAMP,
            SOURCE_SYSTEM = src.SOURCE_SYSTEM

    WHEN NOT MATCHED THEN
        INSERT (
            AGENT_ID,
            AGENT_NAME,
            LOAD_DATE,
            UPDATE_DATE,
            SOURCE_SYSTEM
        ) VALUES (
            src.AGENT_ID,
            src.AGENT_NAME,
            CURRENT_TIMESTAMP,
            CURRENT_TIMESTAMP,
            src.SOURCE_SYSTEM
        );

    -- Log success
    LET v_status = 'SUCCESS';
    LET v_message = 'Agents data loaded successfully.';

    INSERT INTO AUDIT_LOG (MODULE_NAME, RUN_TIME, STATUS, MESSAGE)
    VALUES ('LOAD_GOLD_AGENTS', v_start_time, v_status, v_message);

    RETURN 'Procedure executed successfully.';

EXCEPTION
    WHEN OTHERS THEN
        LET v_status = 'FAILED';
        LET v_message = 'Error: ' || ERROR_MESSAGE();

        -- Log the error
        BEGIN
            INSERT INTO AUDIT_LOG (MODULE_NAME, RUN_TIME, STATUS, MESSAGE)
            VALUES ('LOAD_GOLD_AGENTS', v_start_time, v_status, v_message);
        EXCEPTION
            WHEN OTHERS THEN
                -- Suppress audit failure
                RETURN 'Error occurred while logging audit.';
        END;

        -- Rethrow the exception
        RETURN v_message;
END;
$$;
```

**API Cost Consumed:** 0.0023 USD