=============================================
Author: Ascendion AAVA
Date:          
Description: Fabric Cost and Testing Effort Estimator for Synapse to Fabric Conversion
=============================================

---

### 1. Cost Estimation

#### 1.1 Fabric Runtime Cost

**Detailed Cost Breakdown for Running Converted Fabric Code:**

Based on the analysis of the LOAD_FACT_EXECUTIVE_SUMMARY stored procedure conversion, the estimated Fabric runtime cost is structured as follows:

| Capacity Unit | Estimated Runtime | Cost per Hour | Estimated Cost |
|---------------|------------------|---------------|---------------|
| F32           | 2 hours          | $0.70         | $1.40         |
| F64           | 1 hour           | $1.10         | $1.10         |
| F128          | 0.5 hour         | $1.50         | $0.75         |

**Recommended Configuration: F64 Capacity**
**Estimated Fabric Runtime Cost: $1.10 per execution**

**Cost Justification:**

* **Complexity Analysis**: The stored procedure has moderate complexity (35/100 score) with 4 INNER JOINs across large dimension tables, 1 CASE statement for business rules, and temporary table processing
* **Data Volume Processing**: Approximately 650 GB of processed data (10% of total source data) requiring joins across multiple large tables including DIM_INSTITUTION (~700 GB), DIM_PRODUCT (~100 GB), DIM_DATE (~100 GB), and STG_DIMENSION_DATA (~150 GB)
* **Expected Execution Time**: 1 hour on F64 capacity, considering the data movement, complex joins, and aggregation operations
* **Performance Optimizations**: Fabric's declarative SQL structure with CTE-based approach eliminates temporary table I/O operations, leverages predicate pushdown, and optimizes join execution plans, potentially reducing runtime compared to original Synapse procedure

---

### 2. Code Fixing and Testing Effort Estimation

#### 2.1 Fabric Code Manual Fixes 

**Estimated Manual Effort: 4.0 hours**

**Breakdown of Manual Intervention Areas:**

* **Procedural Wrapper Conversion (1.0 hour)**: Converting CREATE OR ALTER PROCEDURE and BEGIN/END blocks to CTE-based declarative SQL structure compatible with Fabric
* **Variable Declaration Refactoring (0.5 hour)**: Removing @v_row_count and @error_message variable declarations and refactoring logic to use CTEs or subqueries
* **Control Flow Statement Conversion (0.5 hour)**: Replacing SET NOCOUNT ON, PRINT statements, and @@ROWCOUNT system variables with Fabric-compatible alternatives
* **Temporary Table to CTE Conversion (1.0 hour)**: Converting #staging_metrics temporary table to CTE structure and updating all downstream references
* **Join and Business Logic Review (0.5 hour)**: Manual validation of 4 INNER JOINs (DIM_DATE, DIM_INSTITUTION, DIM_CORPORATION, DIM_PRODUCT) and CASE statement for income_amount business rule
* **INSERT Operation Adjustment (0.5 hour)**: Ensuring INSERT INTO FACT_EXECUTIVE_SUMMARY operation is compatible with Fabric SQL engine

#### 2.2 Output Validation Effort

**Estimated Validation Effort: 3.0 hours**

**Validation Activities:**

* **Test Case Preparation (0.5 hour)**: Preparing representative input datasets for both Synapse and Fabric environments
* **Parallel Execution (0.5 hour)**: Running original Synapse stored procedure and converted Fabric code with identical input data
* **Result Comparison (1.0 hour)**: Comparing outputs including row counts, data values, business rule application (income_amount CASE logic), and referential integrity validation across all dimension joins
* **Edge Case Testing (0.5 hour)**: Testing with edge cases including empty datasets, NULL values, and negative income amounts to ensure business logic preservation
* **Documentation (0.5 hour)**: Documenting validation steps, test results, and resolution of any discrepancies

#### 2.3 Total Estimated Effort in Hours

**Total Manual Effort: 7.0 hours**

**Effort Calculation Justification:**
The total effort is calculated by summing individual manual intervention areas (4.0 hours) and comprehensive output validation activities (3.0 hours). The moderate complexity score (35/100) supports this estimate, as the procedure requires structural conversion from procedural to declarative patterns while preserving complex business logic including multiple dimension joins and data quality rules. No overlap adjustments are needed as code fixing and validation represent distinct sequential phases of the conversion process.

---

### 3. API Cost Consumption


apiCost: 0.0525 USD