```mermaid
flowchart TD
    %% DataStage ETL Pipeline: SCD2_DIM_POLICY_Load
    %% Nodes: Stages with type annotations
    SRC_POLICY["SRC_POLICY<br>[OracleConnector]<br>Source: policy_src"]
    LK_POLICY["LK_POLICY<br>[Lookup]<br>Lookup: dim_policy (current_flag = 'Y')"]
    TF_DETECT_CHANGES["TF_DETECT_CHANGES<br>[Transformer]<br>Detect attribute changes, match status"]
    SCD2_MANAGER["SCD2_MANAGER<br>[SlowlyChangingDimension]<br>SCD2: Insert new/changed, expire previous, set version"]
    AUDIT_BEFORE["AUDIT_BEFORE<br>[Routine]<br>Audit log before job"]
    AUDIT_AFTER["AUDIT_AFTER<br>[Routine]<br>Audit log after job"]
    REJECTS["REJECTS<br>[Rejects]<br>policy_id is null or data quality failure"]
    TARGET_DIM_POLICY["TARGET_DIM_POLICY<br>[OracleConnector]<br>Target: dim_policy"]

    %% Edges: Links with names
    AUDIT_BEFORE -->|before_job| SRC_POLICY
    SRC_POLICY -->|src_to_lk| LK_POLICY
    LK_POLICY -->|lk_to_tf| TF_DETECT_CHANGES
    SRC_POLICY -->|src_to_tf| TF_DETECT_CHANGES
    TF_DETECT_CHANGES -->|tf_to_scd2| SCD2_MANAGER
    SCD2_MANAGER -->|scd2_to_target| TARGET_DIM_POLICY
    SCD2_MANAGER -->|scd2_to_rejects| REJECTS
    SRC_POLICY -->|src_to_rejects| REJECTS
    TARGET_DIM_POLICY -->|target_to_audit| AUDIT_AFTER
    REJECTS -->|rejects_to_audit| AUDIT_AFTER

    %% Notes for transformation logic
    TF_DETECT_CHANGES:::note
    SCD2_MANAGER:::note
    REJECTS:::note
    AUDIT_BEFORE:::note
    AUDIT_AFTER:::note

    classDef note fill:#fffbe6,stroke:#b3a369,stroke-width:2px;

    %% Transformation Logic Notes
    TF_DETECT_CHANGES -->|"Note: Detect matched records and attribute changes.<br>Compare policy_holder_name, policy_type, premium_amount, start_date, end_date.<br>Set flags: matched, attr_changed."| TF_DETECT_CHANGES
    SCD2_MANAGER -->|"Note: SCD2 logic.<br>Insert new rows for changed attributes.<br>Expire previous version, increment version_no.<br>Set current_flag, effective_from, effective_to."| SCD2_MANAGER
    REJECTS -->|"Note: Data quality rejects.<br>policy_id is null or failed validation.<br>Write to rejects table."| REJECTS
    AUDIT_BEFORE -->|"Note: Audit routine before job.<br>Log batch_id, run_date, job start."| AUDIT_BEFORE
    AUDIT_AFTER -->|"Note: Audit routine after job.<br>Log batch_id, run_date, job end, row counts, errors."| AUDIT_AFTER

    %% Flow direction: Top-down for readability
    %% Source(s) → Lookup(s) → Transformer(s) → SCD Manager → Target(s)
    %% Reject/Audit flows included
```