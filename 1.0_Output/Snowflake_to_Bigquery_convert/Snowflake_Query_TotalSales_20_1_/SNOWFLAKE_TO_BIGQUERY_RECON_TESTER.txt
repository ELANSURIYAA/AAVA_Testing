# Python Script for Snowflake to BigQuery Migration Validation

```python
import os
import pandas as pd
from google.cloud import bigquery, storage
import snowflake.connector
from datetime import datetime

# Step 1: Environment Setup
# Ensure environment variables for credentials are set
SNOWFLAKE_USER = os.getenv('SNOWFLAKE_USER')
SNOWFLAKE_PASSWORD = os.getenv('SNOWFLAKE_PASSWORD')
SNOWFLAKE_ACCOUNT = os.getenv('SNOWFLAKE_ACCOUNT')
SNOWFLAKE_DATABASE = os.getenv('SNOWFLAKE_DATABASE')
SNOWFLAKE_SCHEMA = os.getenv('SNOWFLAKE_SCHEMA')

GCP_PROJECT = os.getenv('GCP_PROJECT')
GCS_BUCKET = os.getenv('GCS_BUCKET')
BIGQUERY_DATASET = os.getenv('BIGQUERY_DATASET')

# Step 2: Snowflake Connection
def execute_snowflake_query(query):
    conn = snowflake.connector.connect(
        user=SNOWFLAKE_USER,
        password=SNOWFLAKE_PASSWORD,
        account=SNOWFLAKE_ACCOUNT,
        database=SNOWFLAKE_DATABASE,
        schema=SNOWFLAKE_SCHEMA
    )
    cursor = conn.cursor()
    cursor.execute(query)
    results = cursor.fetchall()
    columns = [desc[0] for desc in cursor.description]
    cursor.close()
    conn.close()
    return pd.DataFrame(results, columns=columns)

# Step 3: Export Snowflake Data to Parquet
def export_to_parquet(df, table_name):
    timestamp = datetime.now().strftime('%Y%m%d%H%M%S')
    file_name = f"{table_name}_{timestamp}.parquet"
    df.to_parquet(file_name, index=False)
    return file_name

# Step 4: Upload Parquet to GCS
def upload_to_gcs(file_name, bucket_name):
    client = storage.Client()
    bucket = client.bucket(bucket_name)
    blob = bucket.blob(file_name)
    blob.upload_from_filename(file_name)
    return f"gs://{bucket_name}/{file_name}"

# Step 5: Create External Table in BigQuery
def create_external_table(bigquery_client, gcs_path, table_name):
    table_id = f"{GCP_PROJECT}.{BIGQUERY_DATASET}.{table_name}_external"
    external_config = bigquery.ExternalConfig("PARQUET")
    external_config.source_uris = [gcs_path]
    table = bigquery.Table(table_id)
    table.external_data_configuration = external_config
    bigquery_client.create_table(table, exists_ok=True)
    return table_id

# Step 6: Execute BigQuery Query
def execute_bigquery_query(query):
    client = bigquery.Client()
    query_job = client.query(query)
    results = query_job.result()
    return results.to_dataframe()

# Step 7: Compare Data
def compare_data(df1, df2):
    if df1.equals(df2):
        return "MATCH"
    else:
        mismatches = pd.concat([df1, df2]).drop_duplicates(keep=False)
        return mismatches

# Step 8: Main Script
def main():
    # Snowflake SQL Query
    snowflake_query = """
    WITH customer_sales AS (
        SELECT 
            c.customer_id,
            c.customer_name,
            c.region,
            c.metadata:loyalty_level::STRING AS loyalty_level,
            SUM(s.sale_amount) AS total_sales,
            COUNT(s.sale_id) AS total_orders,
            ARRAY_AGG(DISTINCT s.product_id) AS product_list
        FROM 
            Customers c
        LEFT JOIN 
            Sales s ON c.customer_id = s.customer_id
        WHERE 
            s.sale_date >= '2023-01-01' 
            AND s.sale_date < '2024-01-01'
            AND s.sale_metadata:discount_applied::BOOLEAN = TRUE
        GROUP BY 
            c.customer_id, c.customer_name, c.region, c.metadata:loyalty_level
    )
    SELECT * FROM customer_sales;
    """
    
    # BigQuery SQL Query (Converted)
    bigquery_query = """
    SELECT * FROM `project.dataset.customer_sales`;
    """
    
    # Execute Snowflake Query
    snowflake_data = execute_snowflake_query(snowflake_query)
    
    # Export Snowflake Data to Parquet
    parquet_file = export_to_parquet(snowflake_data, "customer_sales")
    
    # Upload Parquet to GCS
    gcs_path = upload_to_gcs(parquet_file, GCS_BUCKET)
    
    # Create External Table in BigQuery
    bigquery_client = bigquery.Client()
    external_table_id = create_external_table(bigquery_client, gcs_path, "customer_sales")
    
    # Execute BigQuery Query
    bigquery_data = execute_bigquery_query(bigquery_query)
    
    # Compare Data
    comparison_result = compare_data(snowflake_data, bigquery_data)
    print("Comparison Result:", comparison_result)

if __name__ == "__main__":
    main()
```