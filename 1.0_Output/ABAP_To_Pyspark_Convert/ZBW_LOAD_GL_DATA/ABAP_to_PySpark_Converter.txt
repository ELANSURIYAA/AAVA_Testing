----------------------------------------------------
# PySpark Code Converted from ABAP Code (ZBW_LOAD_GL_DATA_v2.txt)
#
# This code replicates the logic of the original ABAP code:
# 1. Loading the BKPF table data into a DataFrame.
# 2. Filtering the DataFrame for records where 'bukrs' equals '1000'.
# 3. Further filtering records where 'blart' equals 'SA'.
# 4. Selecting the columns 'belnr' and 'budat' for output.
# 5. Displaying the result using the show() method.
#
# Note: In an actual production environment, the data source (BKPF table)
# would be replaced with a proper data ingestion method, such as reading from a database or file.
#
# API Cost Consumed for this call: $0.01

from pyspark.sql import SparkSession
from pyspark.sql.functions import col

def main():
    # Initialize SparkSession
    spark = SparkSession.builder \
        .appName("ZBW_LOAD_GL_DATA Conversion") \
        .getOrCreate()

    # Load BKPF table data (assuming data is stored in a file or accessible source)
    # For example, reading from a CSV file; replace 'path_to_bkpf_data.csv' with the actual data source.
    bkpf_df = spark.read.format("csv") \
        .option("header", "true") \
        .option("inferSchema", "true") \
        .load("path_to_bkpf_data.csv")

    # Filter records where bukrs equals '1000'
    filtered_df = bkpf_df.filter(col("bukrs") == "1000")

    # Further filter records where blart equals 'SA'
    result_df = filtered_df.filter(col("blart") == "SA")

    # Select belnr and budat columns
    selected_df = result_df.select("belnr", "budat")

    # Display the results
    selected_df.show()

    # Stop the SparkSession
    spark.stop()

if __name__ == "__main__":
    main()
----------------------------------------------------
Cost Consumed by API Call: $0.01