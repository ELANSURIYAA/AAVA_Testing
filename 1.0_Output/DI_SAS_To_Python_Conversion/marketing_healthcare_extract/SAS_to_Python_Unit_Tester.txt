```
Thought: To design unit tests and write Pytest scripts for the provided Python code, I need to analyze the code for transformations, aggregations, joins, and business logic. Since the code is already provided, I will create test cases based on the logic and functionality implemented in the script. I will also ensure that the metadata is updated as per the requirements. Finally, I will provide the cost analysis for the API call.

=============================================
Author:        Ascendion AVAA
Created on:    
Description:   Python script to extract healthcare plan data, apply marketing eligibility logic, join provider network details, and export the final dataset for marketing campaign use.
=============================================

**Test Case List:**  
| Test Case ID | Description                          | Input Data Description       | Expected Outcome             |  
|--------------|--------------------------------------|------------------------------|------------------------------|  
| TC001        | Validate database connection         | Valid database credentials   | Successful connection        |  
| TC002        | Validate data extraction             | Valid SQL queries            | Correct dataframes extracted |  
| TC003        | Validate data enrichment logic       | Sample healthcare and provider network data | Correctly enriched dataframe |  
| TC004        | Validate age group classification    | Sample member ages           | Correct age group assigned   |  
| TC005        | Validate marketing segment creation  | Sample plan types and regions| Correct marketing segment created |  
| TC006        | Validate campaign eligibility logic  | Sample data with various conditions | Correct eligibility flags assigned |  
| TC007        | Validate filtering of eligible members| Sample data with eligibility flags | Only eligible members filtered |  
| TC008        | Validate final file export           | Sample eligible members data | File exported successfully   |  

**Pytest Script for Each Test Case:**  
```python
import pytest
import pandas as pd
import numpy as np
from sqlalchemy import create_engine

@pytest.fixture(scope="module")
def sample_data():
    healthcare_plans = pd.DataFrame({
        'plan_id': [1, 2, 3],
        'member_first_name': ['John', 'Jane', 'Doe'],
        'member_last_name': ['Doe', 'Smith', 'Johnson'],
        'member_age': [30, 40, 60],
        'plan_type': ['PPO', 'HMO', 'EPO'],
        'region': ['WEST', 'SOUTH', 'EAST'],
        'plan_status': ['ACTIVE', 'ACTIVE', 'INACTIVE']
    })
    provider_network = pd.DataFrame({
        'plan_id': [1, 2, 3],
        'network_type': ['IN_NETWORK', 'IN_NETWORK', 'OUT_NETWORK']
    })
    return healthcare_plans, provider_network

def test_database_connection():
    try:
        engine = create_engine('sqlite:///:memory:')
        assert engine is not None, "Database connection failed"
    except Exception as e:
        pytest.fail(f"Database connection test failed: {e}")

def test_data_extraction(sample_data):
    healthcare_plans, provider_network = sample_data
    assert not healthcare_plans.empty, "Healthcare plans data extraction failed"
    assert not provider_network.empty, "Provider network data extraction failed"

def test_data_enrichment(sample_data):
    healthcare_plans, provider_network = sample_data
    marketing_extract = healthcare_plans.merge(provider_network, on='plan_id', how='left')
    marketing_extract['member_full_name'] = marketing_extract['member_first_name'].str.strip() + ' ' + marketing_extract['member_last_name'].str.strip()
    assert 'member_full_name' in marketing_extract.columns, "Data enrichment failed"

def test_age_group_classification(sample_data):
    healthcare_plans, _ = sample_data
    healthcare_plans['age_group'] = np.where(
        (healthcare_plans['member_age'] >= 25) & (healthcare_plans['member_age'] <= 35), 'YOUNG_ADULT',
        np.where(
            (healthcare_plans['member_age'] >= 36) & (healthcare_plans['member_age'] <= 50), 'MID_AGE',
            np.where(healthcare_plans['member_age'] > 50, 'SENIOR', 'UNKNOWN')
        )
    )
    assert healthcare_plans['age_group'].iloc[0] == 'YOUNG_ADULT', "Age group classification failed"

def test_marketing_segment_creation(sample_data):
    healthcare_plans, _ = sample_data
    healthcare_plans['marketing_segment'] = healthcare_plans['plan_type'].str.upper() + '-' + healthcare_plans['region']
    assert healthcare_plans['marketing_segment'].iloc[0] == 'PPO-WEST', "Marketing segment creation failed"

def test_campaign_eligibility_logic(sample_data):
    healthcare_plans, provider_network = sample_data
    marketing_extract = healthcare_plans.merge(provider_network, on='plan_id', how='left')
    marketing_extract['is_campaign_eligible'] = np.where(
        (marketing_extract['plan_status'] == 'ACTIVE') &
        (marketing_extract['member_age'] >= 25) & (marketing_extract['member_age'] <= 60) &
        (marketing_extract['plan_type'].isin(['PPO', 'HMO'])) &
        (marketing_extract['region'].isin(['WEST', 'SOUTH'])) &
        (marketing_extract['network_type'] == 'IN_NETWORK'),
        1, 0
    )
    assert marketing_extract['is_campaign_eligible'].sum() == 2, "Campaign eligibility logic failed"

def test_filtering_eligible_members(sample_data):
    healthcare_plans, provider_network = sample_data
    marketing_extract = healthcare_plans.merge(provider_network, on='plan_id', how='left')
    marketing_extract['is_campaign_eligible'] = np.where(
        (marketing_extract['plan_status'] == 'ACTIVE') &
        (marketing_extract['member_age'] >= 25) & (marketing_extract['member_age'] <= 60) &
        (marketing_extract['plan_type'].isin(['PPO', 'HMO'])) &
        (marketing_extract['region'].isin(['WEST', 'SOUTH'])) &
        (marketing_extract['network_type'] == 'IN_NETWORK'),
        1, 0
    )
    final_campaign_list = marketing_extract[marketing_extract['is_campaign_eligible'] == 1]
    assert len(final_campaign_list) == 2, "Filtering eligible members failed"

def test_final_file_export(sample_data, tmpdir):
    healthcare_plans, provider_network = sample_data
    marketing_extract = healthcare_plans.merge(provider_network, on='plan_id', how='left')
    marketing_extract['is_campaign_eligible'] = np.where(
        (marketing_extract['plan_status'] == 'ACTIVE') &
        (marketing_extract['member_age'] >= 25) & (marketing_extract['member_age'] <= 60) &
        (marketing_extract['plan_type'].isin(['PPO', 'HMO'])) &
        (marketing_extract['region'].isin(['WEST', 'SOUTH'])) &
        (marketing_extract['network_type'] == 'IN_NETWORK'),
        1, 0
    )
    final_campaign_list = marketing_extract[marketing_extract['is_campaign_eligible'] == 1]
    outpath = tmpdir.join("final_marketing_campaign_extract.csv")
    final_campaign_list.to_csv(outpath, index=False)
    assert outpath.check(), "Final file export failed"
```

**Cost Analysis:**  
apiCost: 0.000 USD
```