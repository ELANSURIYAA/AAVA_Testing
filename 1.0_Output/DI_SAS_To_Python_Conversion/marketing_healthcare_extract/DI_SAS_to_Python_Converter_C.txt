```python
# =============================================
# Author:        Ascendion AVA+
# Created on:    10-Apr-2025
# Description:   Extract healthcare plan data, apply marketing eligibility logic, 
#                join provider network details, and export the final dataset for marketing campaign use.
# =============================================

import logging
import pandas as pd
from sqlalchemy import create_engine

# Configure logging
logging.basicConfig(level=logging.INFO, format='%(asctime)s - %(levelname)s - %(message)s')

# --- Step 1: Secure Teradata connection using metadata-authenticated libref ---
try:
    logging.info("Connecting to Teradata database...")
    engine = create_engine('teradata://your_username:your_password@your_server_name/your_database')
    logging.info("Connection to Teradata database established.")
except Exception as e:
    logging.error(f"Failed to connect to Teradata database: {e}")
    raise

# --- Step 2: Create work table with enriched data and business rules ---
try:
    logging.info("Creating work table with enriched data and business rules...")
    query = """
    SELECT 
        hp.member_id,
        TRIM(hp.member_first_name) || ' ' || TRIM(hp.member_last_name) AS member_full_name,
        hp.member_age,
        CASE 
            WHEN hp.member_age BETWEEN 25 AND 35 THEN 'YOUNG_ADULT'
            WHEN hp.member_age BETWEEN 36 AND 50 THEN 'MID_AGE'
            WHEN hp.member_age > 50 THEN 'SENIOR'
            ELSE 'UNKNOWN'
        END AS age_group,
        hp.plan_id,
        hp.plan_type,
        hp.region,
        pn.network_type,
        UPPER(hp.plan_type) || '-' || hp.region AS marketing_segment,
        CASE 
            WHEN hp.plan_status = 'ACTIVE' 
                 AND hp.member_age BETWEEN 25 AND 60 
                 AND hp.plan_type IN ('PPO', 'HMO') 
                 AND hp.region IN ('WEST', 'SOUTH')
                 AND pn.network_type = 'IN_NETWORK'
            THEN 1
            ELSE 0
        END AS is_campaign_eligible
    FROM healthcare_plans hp
    LEFT JOIN provider_network pn
        ON hp.plan_id = pn.plan_id
    WHERE hp.plan_status = 'ACTIVE'
      AND hp.member_age IS NOT NULL
    """
    marketing_extract = pd.read_sql(query, engine)
    logging.info("Work table created successfully.")
except Exception as e:
    logging.error(f"Failed to create work table: {e}")
    raise

# --- Step 3: Filter only eligible members ---
try:
    logging.info("Filtering only eligible members...")
    final_campaign_list = marketing_extract[marketing_extract['is_campaign_eligible'] == 1]
    logging.info("Filtering completed successfully.")
except Exception as e:
    logging.error(f"Failed to filter eligible members: {e}")
    raise

# --- Step 4: Export final file ---
try:
    logging.info("Exporting final file...")
    outpath = "/folders/myfolders/final_marketing_campaign_extract_2025.csv"
    final_campaign_list.to_csv(outpath, index=False)
    logging.info(f"Final file exported successfully to {outpath}.")
except Exception as e:
    logging.error(f"Failed to export final file: {e}")
    raise
```