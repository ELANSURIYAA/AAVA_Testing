=============================================
Author:        Ascendion AVA+
Created on:   
Description:   Snowflake-compatible SQL script to create or recreate a backup of Employee master data, keyed by EmployeeNo, for troubleshooting, point-in-time comparison, and recovery use-cases.
=============================================

-- Snowflake-Compatible Query:

```sql
-- Drop the backup table if it exists
DROP TABLE IF EXISTS EMPLOYEE_BKUP;

-- Create the backup table with appropriate data types and primary key
CREATE TABLE EMPLOYEE_BKUP (
    EmployeeNo INT PRIMARY KEY,
    FirstName STRING,
    LastName STRING,
    DepartmentNo INT,
    Salary NUMBER(18,2)
);

-- Insert employee master data into the backup table
INSERT INTO EMPLOYEE_BKUP (EmployeeNo, FirstName, LastName, DepartmentNo, Salary)
SELECT 
    E.EmployeeNo,
    E.FirstName,
    E.LastName,
    E.DepartmentNo,
    S.Salary
FROM EMPLOYEE E
INNER JOIN SALARY S
    ON E.EmployeeNo = S.EmployeeNo;
```

-- Notes:
-- 1. Snowflake does not support the T-SQL "USE" statement; set the database and schema context in your session as needed.
-- 2. TRY...CATCH and IF OBJECT_ID/IF EXISTS procedural logic is replaced with "DROP TABLE IF EXISTS".
-- 3. SET NOCOUNT ON is not required in Snowflake.
-- 4. All table and column names are uppercased for Snowflake best practices.
-- 5. Data types are mapped to Snowflake equivalents (STRING for NVARCHAR, NUMBER for MONEY).
-- 6. The script is idempotent and can be rerun safely.

API Cost Calculations

apiCost: 0.0042 USD