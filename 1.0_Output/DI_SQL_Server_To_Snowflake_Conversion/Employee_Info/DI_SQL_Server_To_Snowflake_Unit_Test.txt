```
=============================================
Author:        Ascendion AVA+
Created on:   
Description:   Unit test cases and Pytest script for validating the Snowflake-compatible Employee backup creation logic, including data integrity, joins, and edge cases.
=============================================

1. Test Case List:

- Test ID: TC01
  Test Description: Verify backup table creation and data insertion when Employee and Salary tables have matching records (happy path).
  Input Data: 
    Employee: [{EmployeeNo: 1, FirstName: 'John', LastName: 'Doe', DepartmentNo: 10}]
    Salary: [{EmployeeNo: 1, NetPay: 5000}]
  Expected Output: 
    employee_bkup contains one row: {EmployeeNo: 1, FirstName: 'John', LastName: 'Doe', DepartmentNo: 10, NetPay: 5000}

- Test ID: TC02
  Test Description: Verify backup table is not created when Employee table is empty.
  Input Data: 
    Employee: []
    Salary: []
  Expected Output: 
    employee_bkup table does not exist

- Test ID: TC03
  Test Description: Verify only matching EmployeeNo records are inserted (inner join logic).
  Input Data: 
    Employee: [{EmployeeNo: 1, FirstName: 'John', LastName: 'Doe', DepartmentNo: 10}, {EmployeeNo: 2, FirstName: 'Jane', LastName: 'Smith', DepartmentNo: 20}]
    Salary: [{EmployeeNo: 1, NetPay: 5000}]
  Expected Output: 
    employee_bkup contains one row: {EmployeeNo: 1, FirstName: 'John', LastName: 'Doe', DepartmentNo: 10, NetPay: 5000}

- Test ID: TC04
  Test Description: Verify backup table handles NULL DepartmentNo values.
  Input Data: 
    Employee: [{EmployeeNo: 1, FirstName: 'John', LastName: 'Doe', DepartmentNo: None}]
    Salary: [{EmployeeNo: 1, NetPay: 5000}]
  Expected Output: 
    employee_bkup contains one row: {EmployeeNo: 1, FirstName: 'John', LastName: 'Doe', DepartmentNo: None, NetPay: 5000}

- Test ID: TC05
  Test Description: Verify backup table is not created when Employee table has rows but no matching Salary records.
  Input Data: 
    Employee: [{EmployeeNo: 1, FirstName: 'John', LastName: 'Doe', DepartmentNo: 10}]
    Salary: []
  Expected Output: 
    employee_bkup table exists but is empty

- Test ID: TC06
  Test Description: Verify backup table is dropped if Employee table is empty after initial creation.
  Input Data: 
    Employee: []
    Salary: []
  Expected Output: 
    employee_bkup table does not exist

- Test ID: TC07
  Test Description: Verify multiple records are inserted correctly.
  Input Data: 
    Employee: [
      {EmployeeNo: 1, FirstName: 'John', LastName: 'Doe', DepartmentNo: 10},
      {EmployeeNo: 2, FirstName: 'Jane', LastName: 'Smith', DepartmentNo: 20}
    ]
    Salary: [
      {EmployeeNo: 1, NetPay: 5000},
      {EmployeeNo: 2, NetPay: 6000}
    ]
  Expected Output: 
    employee_bkup contains two rows:
      {EmployeeNo: 1, FirstName: 'John', LastName: 'Doe', DepartmentNo: 10, NetPay: 5000}
      {EmployeeNo: 2, FirstName: 'Jane', LastName: 'Smith', DepartmentNo: 20, NetPay: 6000}

- Test ID: TC08
  Test Description: Verify backup table does not include Salary records with no matching Employee.
  Input Data: 
    Employee: [{EmployeeNo: 1, FirstName: 'John', LastName: 'Doe', DepartmentNo: 10}]
    Salary: [{EmployeeNo: 2, NetPay: 6000}]
  Expected Output: 
    employee_bkup is empty

2. Pytest Script for each test case

```python
import pytest
import snowflake.connector

# Helper functions and fixtures

@pytest.fixture(scope="function")
def snowflake_conn():
    # Replace with your Snowflake credentials/environment
    conn = snowflake.connector.connect(
        user='USER',
        password='PASSWORD',
        account='ACCOUNT',
        warehouse='WAREHOUSE',
        database='DATABASE',
        schema='SCHEMA'
    )
    cs = conn.cursor()
    yield cs
    # Cleanup after each test
    cs.execute("DROP TABLE IF EXISTS employee_bkup")
    cs.execute("DROP TABLE IF EXISTS Employee")
    cs.execute("DROP TABLE IF EXISTS Salary")
    cs.close()
    conn.close()

def setup_employee_table(cs, employees):
    cs.execute("""
        CREATE TABLE Employee (
            EmployeeNo INT PRIMARY KEY,
            FirstName STRING,
            LastName STRING,
            DepartmentNo SMALLINT
        )
    """)
    for emp in employees:
        cs.execute(
            "INSERT INTO Employee (EmployeeNo, FirstName, LastName, DepartmentNo) VALUES (%s, %s, %s, %s)",
            (emp['EmployeeNo'], emp['FirstName'], emp['LastName'], emp['DepartmentNo'])
        )

def setup_salary_table(cs, salaries):
    cs.execute("""
        CREATE TABLE Salary (
            EmployeeNo INT PRIMARY KEY,
            NetPay INT
        )
    """)
    for sal in salaries:
        cs.execute(
            "INSERT INTO Salary (EmployeeNo, NetPay) VALUES (%s, %s)",
            (sal['EmployeeNo'], sal['NetPay'])
        )

def run_backup_script(cs):
    cs.execute("DROP TABLE IF EXISTS employee_bkup")
    cs.execute("""
        CREATE TABLE employee_bkup (
            EmployeeNo INT NOT NULL PRIMARY KEY,
            FirstName STRING NOT NULL,
            LastName STRING NOT NULL,
            DepartmentNo SMALLINT,
            NetPay INT
        )
    """)
    cs.execute("SELECT COUNT(*) AS EMPLOYEE_ROW_COUNT FROM Employee")
    row_count = cs.fetchone()[0]
    if row_count > 0:
        cs.execute("""
            INSERT INTO employee_bkup (EmployeeNo, FirstName, LastName, DepartmentNo, NetPay)
            SELECT
                e.EmployeeNo,
                e.FirstName,
                e.LastName,
                e.DepartmentNo,
                s.NetPay
            FROM Employee AS e
            INNER JOIN Salary AS s
                ON e.EmployeeNo = s.EmployeeNo
        """)
    else:
        cs.execute("DROP TABLE IF EXISTS employee_bkup")

def fetch_all(cs, table):
    cs.execute(f"SELECT * FROM {table}")
    return cs.fetchall()

def table_exists(cs, table):
    cs.execute(f"SHOW TABLES LIKE '{table}'")
    return cs.fetchone() is not None

# Test Cases

def test_TC01_happy_path(snowflake_conn):
    """Test backup creation and data insertion (happy path)."""
    setup_employee_table(snowflake_conn, [{'EmployeeNo': 1, 'FirstName': 'John', 'LastName': 'Doe', 'DepartmentNo': 10}])
    setup_salary_table(snowflake_conn, [{'EmployeeNo': 1, 'NetPay': 5000}])
    run_backup_script(snowflake_conn)
    assert table_exists(snowflake_conn, 'employee_bkup')
    rows = fetch_all(snowflake_conn, 'employee_bkup')
    assert rows == [(1, 'John', 'Doe', 10, 5000)]

def test_TC02_employee_empty(snowflake_conn):
    """Test backup table is not created when Employee table is empty."""
    setup_employee_table(snowflake_conn, [])
    setup_salary_table(snowflake_conn, [])
    run_backup_script(snowflake_conn)
    assert not table_exists(snowflake_conn, 'employee_bkup')

def test_TC03_inner_join(snowflake_conn):
    """Test only matching EmployeeNo records are inserted."""
    setup_employee_table(snowflake_conn, [
        {'EmployeeNo': 1, 'FirstName': 'John', 'LastName': 'Doe', 'DepartmentNo': 10},
        {'EmployeeNo': 2, 'FirstName': 'Jane', 'LastName': 'Smith', 'DepartmentNo': 20}
    ])
    setup_salary_table(snowflake_conn, [{'EmployeeNo': 1, 'NetPay': 5000}])
    run_backup_script(snowflake_conn)
    rows = fetch_all(snowflake_conn, 'employee_bkup')
    assert rows == [(1, 'John', 'Doe', 10, 5000)]

def test_TC04_null_department(snowflake_conn):
    """Test backup table handles NULL DepartmentNo values."""
    setup_employee_table(snowflake_conn, [{'EmployeeNo': 1, 'FirstName': 'John', 'LastName': 'Doe', 'DepartmentNo': None}])
    setup_salary_table(snowflake_conn, [{'EmployeeNo': 1, 'NetPay': 5000}])
    run_backup_script(snowflake_conn)
    rows = fetch_all(snowflake_conn, 'employee_bkup')
    assert rows == [(1, 'John', 'Doe', None, 5000)]

def test_TC05_no_salary_match(snowflake_conn):
    """Test backup table is created but empty when no matching Salary records."""
    setup_employee_table(snowflake_conn, [{'EmployeeNo': 1, 'FirstName': 'John', 'LastName': 'Doe', 'DepartmentNo': 10}])
    setup_salary_table(snowflake_conn, [])
    run_backup_script(snowflake_conn)
    assert table_exists(snowflake_conn, 'employee_bkup')
    rows = fetch_all(snowflake_conn, 'employee_bkup')
    assert rows == []

def test_TC06_drop_on_empty_employee(snowflake_conn):
    """Test backup table is dropped if Employee table is empty after initial creation."""
    setup_employee_table(snowflake_conn, [])
    setup_salary_table(snowflake_conn, [])
    run_backup_script(snowflake_conn)
    assert not table_exists(snowflake_conn, 'employee_bkup')

def test_TC07_multiple_records(snowflake_conn):
    """Test multiple records are inserted correctly."""
    setup_employee_table(snowflake_conn, [
        {'EmployeeNo': 1, 'FirstName': 'John', 'LastName': 'Doe', 'DepartmentNo': 10},
        {'EmployeeNo': 2, 'FirstName': 'Jane', 'LastName': 'Smith', 'DepartmentNo': 20}
    ])
    setup_salary_table(snowflake_conn, [
        {'EmployeeNo': 1, 'NetPay': 5000},
        {'EmployeeNo': 2, 'NetPay': 6000}
    ])
    run_backup_script(snowflake_conn)
    rows = fetch_all(snowflake_conn, 'employee_bkup')
    assert (1, 'John', 'Doe', 10, 5000) in rows
    assert (2, 'Jane', 'Smith', 20, 6000) in rows
    assert len(rows) == 2

def test_TC08_salary_no_employee(snowflake_conn):
    """Test backup table does not include Salary records with no matching Employee."""
    setup_employee_table(snowflake_conn, [{'EmployeeNo': 1, 'FirstName': 'John', 'LastName': 'Doe', 'DepartmentNo': 10}])
    setup_salary_table(snowflake_conn, [{'EmployeeNo': 2, 'NetPay': 6000}])
    run_backup_script(snowflake_conn)
    rows = fetch_all(snowflake_conn, 'employee_bkup')
    assert rows == []
```

3. API Cost Calculation

apiCost: 0.0042 USD
```