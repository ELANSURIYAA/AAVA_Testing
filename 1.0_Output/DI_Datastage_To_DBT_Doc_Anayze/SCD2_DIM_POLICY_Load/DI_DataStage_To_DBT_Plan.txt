=============================================
Author:        Ascendion AAVA
Created on: 
Description:   Cost and effort estimation for DBT model conversion
=============================================

1. Cost Estimation
1.1 Snowflake Runtime Cost
Estimate runtime cost 

Cost Breakdown:  
- Compute: $16  
- Storage: $23  
 
Total Estimated Runtime Cost per Job:  
$39 USD per run
 
Justification:
- Approximately 10% of total data volume is processed per run, based on environment notes.
- Job complexity includes aggregations, joins, and lookups, which are compute-intensive.
- Storage impact is moderate due to the size of tables (100–600 GB each).
- Incremental/partitioning optimizations are expected for some models (e.g., CUSTOMER_SUMMARY), reducing compute for those jobs.

2. Code Fixing and Testing Effort Estimation
2.1 Manual Model Fixes and Recon Testing Effort
Manual tasks required to convert DataStage logic into dbt SQL / Jinja:
- Parameter replacement (e.g., $$Audit_Year → {{ var('audit_year') }}): 1 hr
- Stage-to-model conversion (Sequential → source(), Aggregator → GROUP BY, Transformer → SELECT with derived columns): 3 hrs
- Schema and datatype alignment between source and Snowflake targets: 1 hr
- Adding dbt tests for null checks and row-count validation: 1 hr

Subtotal for Manual Code Fixes & Testing: 6 hrs

2.2 Output Validation Effort
Tasks for validating dbt outputs against DataStage results:
- Compare row counts and sample records: 1 hr
- Validate aggregations, joins, and derived columns: 2 hrs
- Execute dbt tests (unique, not_null, accepted_values): 1 hr
- Document and resolve discrepancies: 1 hr

Subtotal for Output Validation: 5 hrs

2.3 Total Estimated Effort in Hours

| Task                        | Estimated Hours | Notes                                             |
|-----------------------------|----------------|---------------------------------------------------|
| Manual Code Fixes & Testing | 6              | Moderate complexity (aggregations, joins, lookups) |
| Output Validation           | 5              | Includes documentation and discrepancy resolution  |
| Total Estimated Effort      | 11             | Moderate (21–50) complexity score                  |

Justification:
- Analyzer complexity score is moderate (21–50): 6–12 hrs expected.
- Job includes logic-heavy transformations (aggregations, joins, lookups).
- Some incremental/partitioned models reduce overall effort.

3. API Cost Consumption

apiCost: 0.00431 USD