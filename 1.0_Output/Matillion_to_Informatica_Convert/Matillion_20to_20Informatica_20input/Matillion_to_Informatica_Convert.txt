{
  "task": {
    "name": "FileToSnowflakeMappingJob",
    "type": "Mapping",
    "description": "Simple File-to-Snowflake ETL Job with Transformation",
    "steps": [
      {
        "name": "Read_Source_File",
        "type": "Source",
        "config": {
          "connection": "File_Connection",
          "source_object": "/path/to/source_file.csv",
          "file_format": "CSV",
          "delimiter": ",",
          "header_row": true
        }
      },
      {
        "name": "Transform_Data",
        "type": "Transformation",
        "config": {
          "transformation_type": "Expression",
          "steps": [
            {
              "name": "Filter_Active_Status",
              "type": "Filter",
              "config": {
                "column": "status",
                "condition": "active"
              }
            },
            {
              "name": "Rename_Column",
              "type": "Rename",
              "config": {
                "old_name": "old_column_name",
                "new_name": "new_column_name"
              }
            }
          ]
        }
      },
      {
        "name": "Load_Into_Snowflake",
        "type": "Target",
        "config": {
          "connection": "Snowflake_Connection",
          "target_object": "target_table",
          "columns": [
            {
              "source_column": "status",
              "target_column": "status"
            },
            {
              "source_column": "old_column_name",
              "target_column": "new_column_name"
            }
          ],
          "action": "insert",
          "stage": "snowflake_stage",
          "on_error": "continue",
          "truncate_target": false
        }
      }
    ],
    "connections": {
      "File_Connection": {
        "type": "File",
        "file_path": "/path/to/source_file.csv"
      },
      "Snowflake_Connection": {
        "type": "Snowflake",
        "host": "snowflake_host",
        "warehouse": "snowflake_warehouse",
        "username": "snowflake_user",
        "password": "snowflake_password",
        "database": "snowflake_database",
        "schema": "snowflake_schema"
      }
    }
  }
}