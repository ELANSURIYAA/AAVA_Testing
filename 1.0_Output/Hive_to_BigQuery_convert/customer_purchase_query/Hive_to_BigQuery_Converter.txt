1. Converted BigQuery SQL code:

```sql
-- Complex BigQuery SQL Query for Customer Purchase Pattern Analysis
-- This query analyzes purchasing behavior across regions, demographics, and time periods

WITH customer_purchase_summary AS (
  SELECT 
    c.customer_id,
    c.customer_name,
    c.age_group,
    c.gender,
    c.region_id,
    r.region_name,
    r.country,
    SUM(o.order_amount) AS total_spent,
    COUNT(DISTINCT o.order_id) AS order_count,
    MIN(o.order_date) AS first_purchase_date,
    MAX(o.order_date) AS last_purchase_date,
    DATE_DIFF(MAX(o.order_date), MIN(o.order_date), DAY) AS customer_tenure_days
  FROM `project.dataset.customers` c
  JOIN `project.dataset.orders` o ON c.customer_id = o.customer_id
  JOIN `project.dataset.regions` r ON c.region_id = r.region_id
  WHERE o.order_date BETWEEN '2024-01-01' AND '2024-12-31'
  AND o.order_status = 'COMPLETED'
  GROUP BY 
    c.customer_id, 
    c.customer_name,
    c.age_group,
    c.gender,
    c.region_id,
    r.region_name,
    r.country
),

product_category_preferences AS (
  SELECT 
    o.customer_id,
    p.category_id,
    pc.category_name,
    COUNT(DISTINCT o.order_id) AS category_purchase_count,
    SUM(oi.quantity) AS items_purchased,
    SUM(oi.quantity * oi.unit_price) AS category_amount_spent,
    ROW_NUMBER() OVER (PARTITION BY o.customer_id ORDER BY SUM(oi.quantity * oi.unit_price) DESC) AS category_rank
  FROM `project.dataset.orders` o
  JOIN `project.dataset.order_items` oi ON o.order_id = oi.order_id
  JOIN `project.dataset.products` p ON oi.product_id = p.product_id
  JOIN `project.dataset.product_categories` pc ON p.category_id = pc.category_id
  WHERE o.order_date BETWEEN '2024-01-01' AND '2024-12-31'
  AND o.order_status = 'COMPLETED'
  GROUP BY 
    o.customer_id,
    p.category_id,
    pc.category_name
),

seasonal_spending_patterns AS (
  SELECT
    c.customer_id,
    EXTRACT(QUARTER FROM o.order_date) AS quarter,
    EXTRACT(MONTH FROM o.order_date) AS month,
    EXTRACT(DAYOFWEEK FROM o.order_date) AS day_of_week,
    SUM(o.order_amount) AS period_spent,
    COUNT(DISTINCT o.order_id) AS period_order_count,
    AVG(o.order_amount) AS avg_order_value
  FROM `project.dataset.customers` c
  JOIN `project.dataset.orders` o ON c.customer_id = o.customer_id
  WHERE o.order_date BETWEEN '2024-01-01' AND '2024-12-31'
  AND o.order_status = 'COMPLETED'
  GROUP BY
    c.customer_id,
    EXTRACT(QUARTER FROM o.order_date),
    EXTRACT(MONTH FROM o.order_date),
    EXTRACT(DAYOFWEEK FROM o.order_date)
)

SELECT 
  cps.customer_id,
  cps.customer_name,
  cps.age_group,
  cps.gender,
  cps.region_name,
  cps.country,
  cps.total_spent,
  cps.order_count,
  cps.customer_tenure_days,
  -- Calculate customer lifetime value and segmentation
  CASE 
    WHEN cps.total_spent > 10000 THEN 'Platinum'
    WHEN cps.total_spent > 5000 THEN 'Gold'
    WHEN cps.total_spent > 1000 THEN 'Silver'
    ELSE 'Bronze'
  END AS customer_tier,
  -- Calculate purchase frequency metrics
  ROUND(cps.order_count / NULLIF(cps.customer_tenure_days / 30, 0), 2) AS monthly_purchase_frequency,
  -- Get preferred product categories
  MAX(CASE WHEN pcp.category_rank = 1 THEN pcp.category_name ELSE NULL END) AS top_category,
  MAX(CASE WHEN pcp.category_rank = 1 THEN pcp.category_amount_spent ELSE NULL END) AS top_category_spent,
  MAX(CASE WHEN pcp.category_rank = 2 THEN pcp.category_name ELSE NULL END) AS second_category,
  MAX(CASE WHEN pcp.category_rank = 2 THEN pcp.category_amount_spent ELSE NULL END) AS second_category_spent,
  -- Seasonal spending analysis
  MAX(CASE WHEN ssp.quarter = 1 THEN ssp.period_spent ELSE 0 END) AS q1_spent,
  MAX(CASE WHEN ssp.quarter = 2 THEN ssp.period_spent ELSE 0 END) AS q2_spent,
  MAX(CASE WHEN ssp.quarter = 3 THEN ssp.period_spent ELSE 0 END) AS q3_spent,
  MAX(CASE WHEN ssp.quarter = 4 THEN ssp.period_spent ELSE 0 END) AS q4_spent,
  -- Calculate quarter-over-quarter growth
  ROUND(
    (MAX(CASE WHEN ssp.quarter = 4 THEN ssp.period_spent ELSE 0 END) - 
     MAX(CASE WHEN ssp.quarter = 3 THEN ssp.period_spent ELSE 0 END)) / 
    NULLIF(MAX(CASE WHEN ssp.quarter = 3 THEN ssp.period_spent ELSE 0 END), 0) * 100, 
    2
  ) AS q4_q3_growth_pct,
  -- Weekend vs. weekday spending
  SUM(CASE WHEN ssp.day_of_week IN (1, 7) THEN ssp.period_spent ELSE 0 END) AS weekend_spent,
  SUM(CASE WHEN ssp.day_of_week NOT IN (1, 7) THEN ssp.period_spent ELSE 0 END) AS weekday_spent,
  -- Average order values
  AVG(ssp.avg_order_value) AS overall_aov,
  -- Recency calculation
  DATE_DIFF('2024-12-31', cps.last_purchase_date, DAY) AS days_since_last_purchase,
  -- Add RFM (Recency, Frequency, Monetary) scoring
  NTILE(5) OVER (ORDER BY DATE_DIFF('2024-12-31', cps.last_purchase_date, DAY)) AS recency_score,
  NTILE(5) OVER (ORDER BY cps.order_count) AS frequency_score,
  NTILE(5) OVER (ORDER BY cps.total_spent) AS monetary_score
FROM customer_purchase_summary cps
LEFT JOIN product_category_preferences pcp ON cps.customer_id = pcp.customer_id
LEFT JOIN seasonal_spending_patterns ssp ON cps.customer_id = ssp.customer_id
GROUP BY
  cps.customer_id,
  cps.customer_name,
  cps.age_group,
  cps.gender,
  cps.region_name,
  cps.country,
  cps.total_spent,
  cps.order_count,
  cps.first_purchase_date,
  cps.last_purchase_date,
  cps.customer_tenure_days
HAVING cps.total_spent > 500
ORDER BY cps.total_spent DESC
LIMIT 1000;
```

2. API Cost for this particular API call for the model in USD: $0.015