1. **Test Case List:**

| Test Case ID | Test Case Description                                                                 | Expected Outcome                                                                                     |
|--------------|---------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------|
| TC001        | Validate that the query correctly calculates total spent and order count per customer | The total_spent and order_count columns should match the sum and count of orders for each customer. |
| TC002        | Validate customer tier segmentation logic                                             | Customers with total_spent > 10000 are 'Platinum', > 5000 are 'Gold', > 1000 are 'Silver', else 'Bronze'. |
| TC003        | Validate NULL handling in customer_tenure_days calculation                           | If MIN or MAX order_date is NULL, customer_tenure_days should be NULL.                              |
| TC004        | Validate the ranking logic for product categories                                    | The top_category should be the category with the highest spending for each customer.                |
| TC005        | Validate seasonal spending patterns                                                  | The q1_spent, q2_spent, q3_spent, and q4_spent columns should match the sum of spending for each quarter. |
| TC006        | Validate weekend vs. weekday spending calculation                                    | weekend_spent should sum spending on days 1 and 7, weekday_spent on days 2-6.                      |
| TC007        | Validate RFM scoring logic                                                           | Recency, frequency, and monetary scores should be correctly partitioned into 5 NTILE groups.        |
| TC008        | Validate edge case with empty datasets                                               | The query should return an empty result set without errors.                                         |
| TC009        | Validate edge case with NULL values in key columns                                   | The query should handle NULL values gracefully without causing errors.                              |
| TC010        | Validate quarter-over-quarter growth calculation                                     | q4_q3_growth_pct should correctly calculate the percentage growth between Q3 and Q4 spending.       |

2. **Pytest Script for each test case:**

```python
import pytest
from google.cloud import bigquery
from google.cloud.bigquery import QueryJobConfig

# Initialize BigQuery client
client = bigquery.Client()

# Helper function to execute a query and return results
def execute_query(query):
    job_config = QueryJobConfig()
    query_job = client.query(query, job_config=job_config)
    return query_job.result()

# Test cases
@pytest.mark.parametrize("test_case_id, query, expected", [
    ("TC001", "SELECT customer_id, SUM(order_amount) AS total_spent, COUNT(DISTINCT order_id) AS order_count FROM orders WHERE order_status = 'COMPLETED' GROUP BY customer_id", [(1, 5000, 5)]),
    ("TC002", "SELECT customer_id, CASE WHEN total_spent > 10000 THEN 'Platinum' WHEN total_spent > 5000 THEN 'Gold' WHEN total_spent > 1000 THEN 'Silver' ELSE 'Bronze' END AS customer_tier FROM customer_purchase_summary", [(1, 'Gold')]),
    ("TC003", "SELECT customer_id, DATEDIFF(MAX(order_date), MIN(order_date)) AS customer_tenure_days FROM orders WHERE order_status = 'COMPLETED' GROUP BY customer_id", [(1, 365)]),
    ("TC004", "SELECT customer_id, category_name FROM product_category_preferences WHERE category_rank = 1", [(1, 'Electronics')]),
    ("TC005", "SELECT customer_id, SUM(CASE WHEN QUARTER(order_date) = 1 THEN order_amount ELSE 0 END) AS q1_spent FROM orders WHERE order_status = 'COMPLETED' GROUP BY customer_id", [(1, 2000)]),
    ("TC006", "SELECT customer_id, SUM(CASE WHEN DAYOFWEEK(order_date) IN (1, 7) THEN order_amount ELSE 0 END) AS weekend_spent FROM orders WHERE order_status = 'COMPLETED' GROUP BY customer_id", [(1, 1500)]),
    ("TC007", "SELECT customer_id, NTILE(5) OVER (ORDER BY DATEDIFF('2024-12-31', last_purchase_date)) AS recency_score FROM customer_purchase_summary", [(1, 3)]),
    ("TC008", "SELECT * FROM customer_purchase_summary WHERE 1=0", []),
    ("TC009", "SELECT customer_id, total_spent FROM customer_purchase_summary WHERE total_spent IS NULL", []),
    ("TC010", "SELECT customer_id, ROUND((q4_spent - q3_spent) / NULLIF(q3_spent, 0) * 100, 2) AS q4_q3_growth_pct FROM seasonal_spending_patterns", [(1, 20.0)]),
])
def test_bigquery_query(test_case_id, query, expected):
    """
    Test BigQuery SQL transformations for various scenarios.
    """
    # Execute the query
    results = execute_query(query)
    
    # Convert results to a list of tuples
    actual = [tuple(row.values()) for row in results]
    
    # Assert the results match the expected output
    assert actual == expected, f"Test case {test_case_id} failed. Expected {expected}, got {actual}"
```

**Cost Consumed by the API:** This call consumed 1 API call to list files and 1 API call to ask a coworker, totaling 2 API calls.