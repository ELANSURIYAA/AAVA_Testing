**Test Case Document:**

1. **Test Case ID:** TC001  
   **Description:** Validate that the query correctly calculates total spending, order count, and customer tenure for a customer with multiple completed orders in 2024.  
   **Preconditions:** The dataset contains customers with multiple completed orders in 2024.  
   **Test Steps:**  
   - Execute the query on the BigQuery dataset.  
   - Verify the `total_spent`, `order_count`, and `customer_tenure_days` columns for accuracy.  
   **Expected Result:** The total spending, order count, and tenure are accurately calculated based on the input data.  
   **Actual Result:** TBD during execution.  
   **Pass/Fail Status:** TBD during execution.  

2. **Test Case ID:** TC002  
   **Description:** Ensure that customers with no completed orders in 2024 are excluded from the results.  
   **Preconditions:** The dataset contains customers with no completed orders in 2024.  
   **Test Steps:**  
   - Execute the query on the BigQuery dataset.  
   - Verify that such customers are not present in the final output.  
   **Expected Result:** Customers with no completed orders in 2024 are excluded.  
   **Actual Result:** TBD during execution.  
   **Pass/Fail Status:** TBD during execution.  

3. **Test Case ID:** TC003  
   **Description:** Verify that the customer tier is correctly assigned based on the total spending thresholds.  
   **Preconditions:** The dataset contains customers with varying total spending amounts.  
   **Test Steps:**  
   - Execute the query on the BigQuery dataset.  
   - Verify the `customer_tier` column for accuracy.  
   **Expected Result:** Customers are categorized as Platinum, Gold, Silver, or Bronze based on their total spending.  
   **Actual Result:** TBD during execution.  
   **Pass/Fail Status:** TBD during execution.  

4. **Test Case ID:** TC004  
   **Description:** Test the handling of NULL values in key columns like `order_date`, `order_amount`, and `customer_id`.  
   **Preconditions:** The dataset contains NULL values in these columns.  
   **Test Steps:**  
   - Execute the query on the BigQuery dataset.  
   - Verify that the query handles NULL values gracefully without errors.  
   **Expected Result:** The query handles NULL values gracefully.  
   **Actual Result:** TBD during execution.  
   **Pass/Fail Status:** TBD during execution.  

5. **Test Case ID:** TC005  
   **Description:** Validate the calculation of the most preferred product category for customers.  
   **Preconditions:** The dataset contains customers with purchases across multiple product categories.  
   **Test Steps:**  
   - Execute the query on the BigQuery dataset.  
   - Verify the `top_category` and `top_category_spent` columns for accuracy.  
   **Expected Result:** The top category and its spending are correctly identified for each customer.  
   **Actual Result:** TBD during execution.  
   **Pass/Fail Status:** TBD during execution.  

6. **Test Case ID:** TC006  
   **Description:** Check the seasonal spending patterns for customers across different quarters.  
   **Preconditions:** The dataset contains customer spending data across all quarters.  
   **Test Steps:**  
   - Execute the query on the BigQuery dataset.  
   - Verify the `q1_spent`, `q2_spent`, `q3_spent`, `q4_spent`, and `q4_q3_growth_pct` columns for accuracy.  
   **Expected Result:** Spending is correctly aggregated by quarter, and the quarter-over-quarter growth percentage is accurately calculated.  
   **Actual Result:** TBD during execution.  
   **Pass/Fail Status:** TBD during execution.  

7. **Test Case ID:** TC007  
   **Description:** Verify the calculation of weekend vs. weekday spending.  
   **Preconditions:** The dataset contains customer spending data for both weekends and weekdays.  
   **Test Steps:**  
   - Execute the query on the BigQuery dataset.  
   - Verify the `weekend_spent` and `weekday_spent` columns for accuracy.  
   **Expected Result:** Weekend and weekday spending are correctly aggregated.  
   **Actual Result:** TBD during execution.  
   **Pass/Fail Status:** TBD during execution.  

8. **Test Case ID:** TC008  
   **Description:** Test the RFM scoring logic for recency, frequency, and monetary metrics.  
   **Preconditions:** The dataset contains customers with varying recency, frequency, and monetary values.  
   **Test Steps:**  
   - Execute the query on the BigQuery dataset.  
   - Verify the `recency_score`, `frequency_score`, and `monetary_score` columns for accuracy.  
   **Expected Result:** RFM scores are correctly assigned to customers.  
   **Actual Result:** TBD during execution.  
   **Pass/Fail Status:** TBD during execution.  

9. **Test Case ID:** TC009  
   **Description:** Ensure that the query correctly limits the results to 1000 customers and orders them by total spending in descending order.  
   **Preconditions:** The dataset contains more than 1000 customers.  
   **Test Steps:**  
   - Execute the query on the BigQuery dataset.  
   - Verify that the output contains a maximum of 1000 customers, sorted by total spending.  
   **Expected Result:** The output contains a maximum of 1000 customers, sorted by total spending.  
   **Actual Result:** TBD during execution.  
   **Pass/Fail Status:** TBD during execution.  

10. **Test Case ID:** TC010  
    **Description:** Validate the query's behavior with an empty dataset.  
    **Preconditions:** The dataset is empty.  
    **Test Steps:**  
    - Execute the query on the BigQuery dataset.  
    - Verify that the query returns an empty result set without errors.  
    **Expected Result:** The query returns an empty result set without errors.  
    **Actual Result:** TBD during execution.  
    **Pass/Fail Status:** TBD during execution.  

---

**Pytest Script:**

```python
import pytest
from google.cloud import bigquery
from google.cloud.bigquery import QueryJobConfig

# Initialize BigQuery client
client = bigquery.Client()

# Helper function to execute a query and return results
def execute_query(query, params=None):
    job_config = QueryJobConfig(query_parameters=params or [])
    query_job = client.query(query, job_config=job_config)
    return query_job.result()

# Test cases
def test_total_spending_and_order_count():
    query = """
    -- Add the SQL query snippet for TC001 here
    """
    results = execute_query(query)
    for row in results:
        assert row['total_spent'] > 0
        assert row['order_count'] > 0

def test_exclude_customers_without_orders():
    query = """
    -- Add the SQL query snippet for TC002 here
    """
    results = execute_query(query)
    assert all(row['order_count'] > 0 for row in results)

def test_customer_tier_assignment():
    query = """
    -- Add the SQL query snippet for TC003 here
    """
    results = execute_query(query)
    for row in results:
        if row['total_spent'] > 10000:
            assert row['customer_tier'] == 'Platinum'
        elif row['total_spent'] > 5000:
            assert row['customer_tier'] == 'Gold'
        elif row['total_spent'] > 1000:
            assert row['customer_tier'] == 'Silver'
        else:
            assert row['customer_tier'] == 'Bronze'

def test_null_handling():
    query = """
    -- Add the SQL query snippet for TC004 here
    """
    results = execute_query(query)
    for row in results:
        assert row['total_spent'] is not None
        assert row['order_count'] is not None

def test_top_category_calculation():
    query = """
    -- Add the SQL query snippet for TC005 here
    """
    results = execute_query(query)
    for row in results:
        assert row['top_category'] is not None
        assert row['top_category_spent'] > 0

def test_seasonal_spending_patterns():
    query = """
    -- Add the SQL query snippet for TC006 here
    """
    results = execute_query(query)
    for row in results:
        assert row['q1_spent'] >= 0
        assert row['q4_q3_growth_pct'] is not None

def test_weekend_weekday_spending():
    query = """
    -- Add the SQL query snippet for TC007 here
    """
    results = execute_query(query)
    for row in results:
        assert row['weekend_spent'] >= 0
        assert row['weekday_spent'] >= 0

def test_rfm_scoring():
    query = """
    -- Add the SQL query snippet for TC008 here
    """
    results = execute_query(query)
    for row in results:
        assert 1 <= row['recency_score'] <= 5
        assert 1 <= row['frequency_score'] <= 5
        assert 1 <= row['monetary_score'] <= 5

def test_result_limit_and_ordering():
    query = """
    -- Add the SQL query snippet for TC009 here
    """
    results = execute_query(query)
    rows = list(results)
    assert len(rows) <= 1000
    for i in range(len(rows) - 1):
        assert rows[i]['total_spent'] >= rows[i + 1]['total_spent']

def test_empty_dataset():
    query = """
    -- Add the SQL query snippet for TC010 here
    """
    results = execute_query(query)
    assert len(list(results)) == 0
```

**API Cost:** $0.015