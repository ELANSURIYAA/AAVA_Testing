**Test Case Document:**

1. **Test Case ID:** TC001  
   **Description:** Validate the `customer_purchase_summary` CTE for correct aggregation of total spent, order count, and tenure days.  
   **Preconditions:** Test data for customers, orders, and regions tables must exist in BigQuery.  
   **Test Steps:**  
      a. Execute the `customer_purchase_summary` CTE query.  
      b. Compare the aggregated results with expected values.  
   **Expected Result:** Aggregated values match the input data for given customer IDs.  
   **Actual Result:** (To be filled after execution)  
   **Pass/Fail Status:** (To be filled after execution)  

2. **Test Case ID:** TC002  
   **Description:** Validate the `product_category_preferences` CTE for correct ranking of product categories based on spending.  
   **Preconditions:** Test data for orders, order_items, products, and product_categories tables must exist in BigQuery.  
   **Test Steps:**  
      a. Execute the `product_category_preferences` CTE query.  
      b. Verify the ranking of product categories for each customer.  
   **Expected Result:** Categories are ranked correctly for each customer.  
   **Actual Result:** (To be filled after execution)  
   **Pass/Fail Status:** (To be filled after execution)  

3. **Test Case ID:** TC003  
   **Description:** Validate the `seasonal_spending_patterns` CTE for correct extraction of seasonal data.  
   **Preconditions:** Test data for customers and orders tables must exist in BigQuery.  
   **Test Steps:**  
      a. Execute the `seasonal_spending_patterns` CTE query.  
      b. Verify the grouping of spending data by quarter, month, and day of the week.  
   **Expected Result:** Spending data is correctly grouped by quarter, month, and day of the week.  
   **Actual Result:** (To be filled after execution)  
   **Pass/Fail Status:** (To be filled after execution)  

4. **Test Case ID:** TC004  
   **Description:** Validate the final query for correct customer segmentation based on spending tiers.  
   **Preconditions:** Test data for customers, orders, and regions tables must exist in BigQuery.  
   **Test Steps:**  
      a. Execute the final query.  
      b. Verify the segmentation of customers into Platinum, Gold, Silver, and Bronze tiers.  
   **Expected Result:** Customers are segmented into Platinum, Gold, Silver, and Bronze tiers accurately.  
   **Actual Result:** (To be filled after execution)  
   **Pass/Fail Status:** (To be filled after execution)  

5. **Test Case ID:** TC005  
   **Description:** Validate the `monthly_purchase_frequency` calculation for edge cases like zero tenure days.  
   **Preconditions:** Test data for customers and orders tables must exist in BigQuery.  
   **Test Steps:**  
      a. Execute the final query.  
      b. Verify the calculation of `monthly_purchase_frequency` for edge cases.  
   **Expected Result:** Frequency is calculated correctly, avoiding division by zero errors.  
   **Actual Result:** (To be filled after execution)  
   **Pass/Fail Status:** (To be filled after execution)  

6. **Test Case ID:** TC006  
   **Description:** Validate the `top_category` and `second_category` fields for correct identification of preferred categories.  
   **Preconditions:** Test data for orders, order_items, products, and product_categories tables must exist in BigQuery.  
   **Test Steps:**  
      a. Execute the final query.  
      b. Verify the identification of preferred categories for each customer.  
   **Expected Result:** Categories are identified correctly for each customer.  
   **Actual Result:** (To be filled after execution)  
   **Pass/Fail Status:** (To be filled after execution)  

7. **Test Case ID:** TC007  
   **Description:** Validate the `q4_q3_growth_pct` calculation for edge cases like zero spending in Q3.  
   **Preconditions:** Test data for customers and orders tables must exist in BigQuery.  
   **Test Steps:**  
      a. Execute the final query.  
      b. Verify the calculation of `q4_q3_growth_pct` for edge cases.  
   **Expected Result:** Growth percentage is calculated correctly, avoiding division by zero errors.  
   **Actual Result:** (To be filled after execution)  
   **Pass/Fail Status:** (To be filled after execution)  

8. **Test Case ID:** TC008  
   **Description:** Validate the `recency_score`, `frequency_score`, and `monetary_score` fields for correct RFM scoring.  
   **Preconditions:** Test data for customers and orders tables must exist in BigQuery.  
   **Test Steps:**  
      a. Execute the final query.  
      b. Verify the calculation of RFM scores.  
   **Expected Result:** Scores are calculated correctly based on the respective metrics.  
   **Actual Result:** (To be filled after execution)  
   **Pass/Fail Status:** (To be filled after execution)  

9. **Test Case ID:** TC009  
   **Description:** Validate the final query for correct filtering of customers with `total_spent > 500`.  
   **Preconditions:** Test data for customers and orders tables must exist in BigQuery.  
   **Test Steps:**  
      a. Execute the final query.  
      b. Verify that only customers meeting the criteria are included in the result.  
   **Expected Result:** Only customers meeting the criteria are included in the result.  
   **Actual Result:** (To be filled after execution)  
   **Pass/Fail Status:** (To be filled after execution)  

10. **Test Case ID:** TC010  
    **Description:** Validate the final query for correct ordering of customers by `total_spent`.  
    **Preconditions:** Test data for customers and orders tables must exist in BigQuery.  
    **Test Steps:**  
       a. Execute the final query.  
       b. Verify that customers are ordered in descending order of total spending.  
    **Expected Result:** Customers are ordered in descending order of total spending.  
    **Actual Result:** (To be filled after execution)  
    **Pass/Fail Status:** (To be filled after execution)  

---

**Pytest Script:**

```python
import pytest
from google.cloud import bigquery

@pytest.fixture(scope="module")
def bigquery_client():
    return bigquery.Client()

@pytest.fixture(scope="module")
def setup_test_data(bigquery_client):
    # Create mock datasets and tables for testing
    datasets = ["project.dataset.customers", "project.dataset.orders", "project.dataset.regions", "project.dataset.products", "project.dataset.product_categories"]
    for dataset in datasets:
        bigquery_client.query(f"CREATE OR REPLACE TABLE {dataset} AS SELECT * FROM UNNEST([])").result()
    yield
    # Teardown mock datasets
    for dataset in datasets:
        bigquery_client.query(f"DROP TABLE IF EXISTS {dataset}").result()

def test_customer_purchase_summary(bigquery_client, setup_test_data):
    query = """
    WITH customer_purchase_summary AS (
        SELECT 
            c.customer_id,
            SUM(o.order_amount) AS total_spent,
            COUNT(DISTINCT o.order_id) AS order_count,
            DATE_DIFF(MAX(o.order_date), MIN(o.order_date), DAY) AS customer_tenure_days
        FROM `project.dataset.customers` c
        JOIN `project.dataset.orders` o ON c.customer_id = o.customer_id
        WHERE o.order_date BETWEEN '2024-01-01' AND '2024-12-31'
        GROUP BY c.customer_id
    )
    SELECT * FROM customer_purchase_summary
    """
    result = bigquery_client.query(query).result()
    assert result.total_spent == 0  # Replace with expected value
    assert result.order_count == 0  # Replace with expected value
    assert result.customer_tenure_days == 0  # Replace with expected value

def test_product_category_preferences(bigquery_client, setup_test_data):
    query = """
    WITH product_category_preferences AS (
        SELECT 
            o.customer_id,
            p.category_id,
            ROW_NUMBER() OVER (PARTITION BY o.customer_id ORDER BY SUM(oi.quantity * oi.unit_price) DESC) AS category_rank
        FROM `project.dataset.orders` o
        JOIN `project.dataset.order_items` oi ON o.order_id = oi.order_id
        JOIN `project.dataset.products` p ON oi.product_id = p.product_id
        WHERE o.order_date BETWEEN '2024-01-01' AND '2024-12-31'
        GROUP BY o.customer_id, p.category_id
    )
    SELECT * FROM product_category_preferences
    """
    result = bigquery_client.query(query).result()
    assert result.category_rank == 1  # Replace with expected value

# Additional test cases for seasonal_spending_patterns, final query, and edge cases can be implemented similarly.

if __name__ == "__main__":
    pytest.main()
```

**API Cost:** $0.015