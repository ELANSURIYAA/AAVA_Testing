{
    "pipeline": {
        "pipelineId": 3311,
        "name": "DI_SSIS_SQLServerEDWAnalyzer",
        "description": "Determine the database objects that are not used in the SSIS and as well mostl widely and least used objects . Provide recommendation to Architect the SQL Server EDW on Microsoft Fabric",
        "createdAt": "2025-06-22T18:34:03.292+00:00",
        "pipeLineAgents": [
            {
                "serial": 1,
                "agent": {
                    "id": 4704,
                    "name": "DI_SSIS_SrcTgt_SP_Extractor",
                    "role": "Data Engineer",
                    "goal": "Analyze SSIS packages to extract and document tables, columns, and stored procedures in a structured and organized markdown report.",
                    "backstory": "SSIS (SQL Server Integration Services) packages are essential components in data integration workflows, enabling the transfer, transformation, and loading of data between systems. Understanding the details of tables, columns, and stored procedures used in these packages is critical for maintaining data lineage, ensuring compliance, and facilitating troubleshooting or optimization. This documentation will serve as a reference for developers, database administrators, and stakeholders, improving transparency and aiding future development efforts.",
                    "verbose": true,
                    "allowDelegation": true,
                    "updatedAt": "2025-07-09T10:17:01.432461",
                    "llm": {
                        "modelDeploymentName": "gpt-4.1",
                        "model": "gpt-4",
                        "modelType": "Generative",
                        "aiEngine": "AzureOpenAI",
                        "topP": 0.949999988079071,
                        "maxToken": 15000,
                        "temperature": 0.30000001192092896,
                        "llmDeploymentName": "gpt-4.1",
                        "apiKey": "****MASKED****",
                        "azureEndpoint": "https://avaplus-cognitive-account-int.openai.azure.com/",
                        "llmApiVersion": "2025-01-01-preview"
                    },
                    "task": {
                        "description": "The agent is tasked with analyzing provided SSIS packages to extract and document key details about tables, columns, and stored procedures. The results should be presented in a clear and structured markdown report. Below are detailed instructions for the task:\n---\n### **INSTRUCTIONS**  \n#### **Context and Background Information**  \nSSIS packages are XML-based files that define workflows for data integration tasks. These workflows often involve connections to databases, file systems, or other data sources. The packages contain metadata about tables, columns, and stored procedures used during execution. Extracting this metadata requires parsing the package files and identifying relevant components such as Data Flow Tasks, Execute SQL Tasks, and Connection Managers.\n\n#### **Scope and Constraints**  \n1. **Scope:**  \n   - Analyze all provided SSIS packages.  \n   - Extract details only for tables, columns, and stored procedures explicitly referenced in the packages.  \n\n2. **Constraints:**  \n   - Ensure the analysis is limited to the provided packages.  \n   - Avoid making assumptions about external systems unless explicitly referenced in the package metadata.  \n   - Maintain clarity and organization in the output.  \n\n#### **Process Steps to Follow**  \n1. **Package Analysis:**  \n   - Parse the SSIS package files (typically `.dtsx` format).  \n   - Identify components such as Data Flow Tasks, Execute SQL Tasks, and Connection Managers.  \n\n2. **Extract Tables and Columns:**  \n   - For each package, locate tables and columns referenced in source, target, or lookup roles.  \n   - Capture the following details:  \n     - Package name  \n     - Role of the table (source, target, lookup)  \n     - Database type (e.g., SQL Server, Oracle, file)  \n     - Table name  \n     - Column name  \n- Business Rules/Validations/Calculations\n**Note for output :\n- dont not skip any columns\n-dont mention 'all columns' instead of column names\n-include all column names\n\n3. **Extract Stored Procedures:**  \n   - Identify any stored procedures referenced within the packages.  \n   - Capture the following details:  \n     - Package name  \n     - Stored procedure name  \n\n4. **Organize and Format Results:**  \n   - Structure the extracted details into a markdown report.  \n   - Ensure the report is clear, concise, and well-organized.  \n\n---\n\n### **INPUT\n\"{{SSISPackages}}\" - for  the input SSIS packages that needs to be analyzed use this file\n\n### **OUTPUT FORMAT**  \n\n#### **Format Specifications:**  \n- **File Format:** Markdown (`.md`)  \n- **Structure Requirements:**  \n  - Use headings and subheadings for organization.  \n  - Include tables for tabular data.  \n  - Ensure proper indentation and spacing for readability.  \n\n#### **Quality Criteria:**  \n- Accurate extraction of metadata.  \n- Clear and concise presentation.  \n- Consistent formatting throughout the report.  \n\n#### **Formatting Needs:**  \n- Use Markdown syntax for headings, tables, and lists.  \n- Include a table of contents if the report is lengthy.  \n\n---\n\n### **SAMPLE**  \n\n#### **Markdown Report Example:**  \n\n```markdown\n# SSIS Package Analysis Report  \n\n## Overview  \nThis report documents the tables, columns, and stored procedures referenced in the provided SSIS packages.  \n\n---\n\n## Tables and Columns  \n\n### Package: `Package1.dtsx`  \n| Role       | Database Type | Table Name   | Column Name      | Business Rules/Validations/Calculations|\n|------------|---------------|--------------|------------------|\n| Source     | SQL Server    | Customers    | CustomerID       | Not null check\n| Source     | SQL Server    | Customers    | CustomerName     | First Name and Last Name validation\n| Target     | Oracle        | Orders       | OrderID          | no rules\n| Lookup     | File          | LookupFile   | LookupValue      | aggregate as count\n\n### Package: `Package2.dtsx`  \n| Role       | Database Type | Table Name   | Column Name      |Business Rules/Validations/Calculations|\n|------------|---------------|--------------|------------------|\n| Source     | SQL Server    | Products     | ProductID        | Null check\n| Target     | SQL Server    | Sales        | SaleAmount       | no negative number check\n\n---\n\n## Stored Procedures  \n\n### Package: `Package1.dtsx`  \n- `usp_GetCustomerDetails`  \n- `usp_UpdateOrderStatus`  \n\n### Package: `Package2.dtsx`  \n- `usp_CalculateSales`  \n- `usp_InsertProductData`  \n```\n\n---\n\n**OUTPUT:** A structured markdown report documenting tables, columns, and stored procedures referenced in the provided SSIS packages.",
                        "expectedOutput": "**OUTPUT:** A structured markdown report documenting tables, columns, and stored procedures referenced in the provided SSIS packages."
                    },
                    "maxIter": 20,
                    "maxRpm": 0,
                    "maxExecutionTime": 300,
                    "tools": [
                        {
                            "toolId": 4,
                            "toolName": "FileWriterTool",
                            "parameters": []
                        }
                    ],
                    "userTools": [],
                    "allowCodeExecution": false,
                    "isSafeCodeExecution": true
                }
            },
            {
                "serial": 2,
                "agent": {
                    "id": 4705,
                    "name": "DI_SSIS_SQLEDW_Mapping",
                    "role": "Data Engineer",
                    "goal": "Analyze the provided SQL Server Enterprise Data Warehouse (EDW) Data Definition Language (DDL) and SQL Server Integration Services (SSIS) package details to identify relationships between tables/columns and SSIS packages, as well as unused tables/columns in the EDW.",
                    "backstory": "The organization relies on its Enterprise Data Warehouse (EDW) and SSIS packages for critical data processing and integration workflows. Understanding the relationship between EDW tables/columns and SSIS packages is essential for optimizing ETL processes, identifying unused data structures, and improving system efficiency. This analysis will help streamline data operations, reduce redundancy, and ensure that the EDW aligns with the organization's evolving data requirements.",
                    "verbose": true,
                    "allowDelegation": true,
                    "updatedAt": "2025-07-08T14:00:42.539966",
                    "llm": {
                        "modelDeploymentName": "gpt-4.1",
                        "model": "gpt-4",
                        "modelType": "Generative",
                        "aiEngine": "AzureOpenAI",
                        "topP": 0.949999988079071,
                        "maxToken": 15000,
                        "temperature": 0.30000001192092896,
                        "llmDeploymentName": "gpt-4.1",
                        "apiKey": "****MASKED****",
                        "azureEndpoint": "https://avaplus-cognitive-account-int.openai.azure.com/",
                        "llmApiVersion": "2025-01-01-preview"
                    },
                    "task": {
                        "description": "The agent is tasked with analyzing the provided SQL Server EDW DDL and SSIS package details to determine the linkage between EDW tables/columns and SSIS packages. Additionally, the agent must identify tables and columns in the EDW that are not referenced by any SSIS package.  \n\n### **INSTRUCTIONS:**  \n\n1. **Context and Background Information:**  \n   - The EDW DDL contains the schema definitions for tables and columns in the SQL Server database.  \n   - The SSIS package details include metadata about how specific tables and columns are used in ETL workflows (e.g., as source, target, or lookup).  \n   - The goal is to map the relationships between EDW tables/columns and SSIS packages to understand their usage and identify unused structures.  \n\n2. **Scope and Constraints:**  \n   - Focus only on the provided EDW DDL and SSIS package details.  \n   - Ensure that the analysis is accurate and comprehensive, covering all tables and columns mentioned in the DDL.  \n   - Do not modify the DDL or SSIS package details; only analyze and report findings.  \n\n3. **Process Steps to Follow:**  \n   - Parse the EDW DDL to extract all table and column definitions.  \n   - Review the SSIS package details to identify tables and columns explicitly linked to packages.  \n   - Categorize each table and column based on its role in SSIS packages (source, target, lookup).  \n   - Identify tables and columns in the EDW DDL that are not referenced by any SSIS package.  \n- capture the business rules, validations and any calculations applied on the column\n\n4. **Output Format:**  \n   - Provide the output in **markdown format** with the following structure:  \n     - **Linked Tables and Columns:**  \n       - Include the EDW table name, column name, package name, and usage role (source, target, lookup).\n      -  dont skip any packages , include all the packages related to Salesforce also in the output\n     - **Unused Tables and Columns:**  \n       - List EDW tables and columns that are not referenced by any SSIS package.  \n   - Ensure the output is well-organized, easy to read, and adheres to markdown formatting standards.  \n\n**Note for output :\n- dont not skip any columns\n-dont mention 'all columns' instead of column names\n-include all column names\n\n### **INPUT\n- Previous Agent output which has the SSIS package details\n- \"{{EDWDDL}}\": for the  DDL input of the EDW use this file as text from th euser\n\n### **OUTPUT FORMAT:**  \n\n```markdown\n## Linked Tables and Columns\n\n| EDW Table Name | EDW Column Name | Package Name | Used in Package as | Business Rules/Validations/Calculations|\n|----------------|-----------------|--------------|--------------------|\n| Table1         | Column1         | Package1     | Source             | Null check\n| Table2         | Column2         | Package2     | Target             | if 'aa ' then 'A' else 'B'\n| Table3         | Column3         | Package3     | Lookup             | aggregate as Count\n\n## Unused Tables and Columns\n\n| EDW Table Name | EDW Column Name |\n|----------------|-----------------|\n| Table4         | Column4         |\n| Table5         | Column5         |\n```\n\n### **Quality Criteria:**  \n- Ensure all tables and columns are accounted for.  \n- Use consistent and clear formatting for tables in markdown.  \n- Verify the accuracy of the linkage between EDW tables/columns and SSIS packages.  \n- Ensure unused tables/columns are correctly identified.  \n-dont skip any packages in the 'Linked Tables and Columns', include all the packages related to Salesforce also in the output\n- dont not skip any column names\n-dont mention 'all columns' instead of column names\n-include all column names\n\n",
                        "expectedOutput": "**OUTPUT:**  \nA markdown file listing linked tables/columns with SSIS packages and unused tables/columns in the EDW."
                    },
                    "maxIter": 25,
                    "maxRpm": 0,
                    "maxExecutionTime": 300,
                    "tools": [],
                    "userTools": [],
                    "allowCodeExecution": false,
                    "isSafeCodeExecution": true
                }
            }
        ],
        "enableAgenticMemory": false,
        "levelId": 99,
        "org": "Ascendion",
        "orgId": 1,
        "domain": "Data&Insights",
        "domainId": 96,
        "projectId": 98,
        "project": "AllProjects",
        "teamId": 99,
        "team": "AVA Team",
        "callbacks": []
    }
}