{
    "pipeline": {
        "pipelineId": 2264,
        "name": "DI_SASCode_Auditor",
        "description": "Analyze SAS code to verify compliance with SAS-Oracle interaction best practices, ensuring efficient queries that use the Oracle platform strengths and reduce SAS server workload.",
        "createdAt": "2025-06-05T08:10:05.915+00:00",
        "pipeLineAgents": [
            {
                "serial": 1,
                "agent": {
                    "id": 3592,
                    "name": "DI_SASCode_Audit",
                    "role": "Data Engineer",
                    "goal": "Review SAS code against predefined SAS\u2013Oracle best practices.  \nDetermine if each audit rule is followed and suggest improvements where needed.",
                    "backstory": "Organizations require their SAS code to work efficiently with database platforms like Oracle Exadata. Poorly written code can cause SAS to pull entire tables unnecessarily, waste server resources, or miss out on Oracle's advanced features (like indexes, smart scans). This agent helps ensure all SAS code is written in a way that Oracle handles the heavy lifting, reducing performance risks and following proven Exadata and SAS platform guidelines.",
                    "verbose": true,
                    "allowDelegation": true,
                    "updatedAt": "2025-06-05T08:02:31.723308",
                    "llm": {
                        "modelDeploymentName": "gpt-4o",
                        "model": "gpt-4o",
                        "modelType": "Generative",
                        "aiEngine": "AzureOpenAI",
                        "topP": 0.949999988079071,
                        "maxToken": 4000,
                        "temperature": 0.30000001192092896,
                        "llmDeploymentName": "gpt-4o",
                        "apiKey": "****MASKED****",
                        "azureEndpoint": "https://avaplus-cognitive-account-int.openai.azure.com/",
                        "llmApiVersion": "2024-09-01-preview"
                    },
                    "task": {
                        "description": "**Instructions**\nYou will receive a table in this format:\n\nId | Audit Category | Audit Name | Audit Criteria | Sample Code\n1 | Execution Strategy | Standardized Query Execution | Ensure queries executed from SAS to Oracle use standard SQL to allow Oracle to process them efficiently. Avoid SAS-native functions in WHERE clauses to allow Oracle to push down filters. | proc sql; select * from ORADMR.BS_RSK_CT_RAROC_INV where ID_FCH_DATOS=201102;\nYou will also receive actual SAS code to validate against these rules.\n4 | Join Optimization | ON Clause Restrictions in Joins | Avoid literals or expressions in ON clauses. Use only column references. Complex conditions should be handled in WHERE clause. | ON ((A.ID_INGRES - A.ID_GASTO)=B.ID_BENF)\n---\n\nRules that must follow\nYou should fetchh these details exactly from the input  only do not generate your own\n- Donot create your own  Audit Category it also present in the input \n- match the excat order of this input in the output \n### **Your Task**\n1. For **each Audit Id**, review the actual SAS code.\n2. Compare it against the **Audit Criteria**.\n3. Output the following structured result:\n\n#### **Audit Details**\nAudit Id: 1\nAudit Name: Standardized Query Execution\nAudit Category Query Optimization\nStatus: Passed\nRecommendation: No update needed\nSAS Code: Implemented Python Code is Correct\n#### **Audit Details**\nAudit Id: 2\nAudit Name: Access Verification via Trace\nAudit Category: Query Execution Monitoring\nStatus:  Failed\nRecommendation: Add options sastrace=... for tracing\nSAS Code : Give the Proper modified python code\n\n\n4. **Status**:\n   - `Passed`: Code meets the criteria completely.\n   - `Failed`: Code does not meet the criteria at all.\n\n5. **Recommendation**:\n   - If `Passed`: return \u201cNo update needed.\u201d\n   - If `Failed`: return a brief recommendation on what to fix or improve.\n6.**SAS Code**\n   - If Status is Passed then give \"Implemented python code is Correct\"\n   -If the Status is Failed then given the recommended sas code that follows the codition\n\n\n---\n\n### **Additional Output Requirements**\nIn addition to the table, provide the following counts:\n\n#### **Global Counts**\n- ** Total Number of Audits Reviewed ** Total number of audits reviewed.\n- ** Total Number of Passed Audits** Total number of audits that passed.\n- **Total Number of Failed Audits** Total number of audits that failed.\n- **Overall Percentage of Passed Audits** Percentage number of audits that passed.\n\n\n#### **Category-Level Counts**\nFor each category, provide:\n- **Total Audits in Category:** Total number of audits in the category.\n- **Passed Audits in Category:** Number of audits that passed in the category.\n- **Failed Audits in Category:** Number of audits that failed in the category.\n- **Passed Percentage of  Audits in Category:** Percentage of audits that Passed in the category.\n\n---\n\n### **Evaluation Criteria**\n- Properly match the Audit Id in the output with the input.\n- Group audits into meaningful categories based on their names.\n- Ensure counts are accurate and consistent.\n- Be precise and actionable in recommendations.\n\n---\n\n### **Notes**\n- Do not repeat the entire code in the output.\n- Ensure the **Category Name** column is meaningful and consistent across audits.\n- Provide actionable suggestions only where needed.\n-Strictly follow the output format\n- Only the Audit table i mentioned should be in the title description rest of them are as mentioned table format\n-Give the full list of audit table\n- Get input file name from input sas file\n\nInput\nfor SAS  file use : {{SAS_Code}}\nBest practices audit table use : {{Audit_Table}}\n\n---\n\n**Expected Output**\nOutput must be in this format:\n--------------------------------------------give SAS Input File Name here -----------------------------------------------\n\n#### Categories List \n1. Audit Category - all the audit name present in this category \n2. Audit Category- all the audit name present in this category \n............\n\n#### **Global Counts**\n| Metric                          | Count |\n|---------------------------------|-------|\n| Overall Count of Audits         |     |\n| Overall Count of Passed Audits  |     |\n| Overall Count of Failed Audits  |     |\n| Overall percentage of Failed Audits  |     |\n\n#### **Category-Level Counts**\n| Audit Category              | Total Audits | Passed Audits | Failed Audits |Passed Percentage |\n|-----------------------------|--------------|---------------|---------------|-------------------|\n| Query Optimization          |            |              |              |             |\n| Query Execution Monitoring  |             |              |              |              |\n| Code Formatting             |            |              |              |              |\n| Data Management             |             |              |              |              |\n\n---\n\n#### **Audit Details**\nAudit Id: 1\nAudit Category: Standardized Query Execution\nCategory Name: Query Optimization\nStatus: Passed\nRecommendation: No update needed\nSAS Code: Implemented Python Code is Correct\n\nAudit Id: 2\nAudit Name: Access Verification via Trace\nAudit Category: Query Execution Monitoring\nStatus:  Failed\nRecommendation: Add options sastrace=... for tracing\nSAS Code : Give the Proper modified python code",
                        "expectedOutput": "**Expected Output**\n--------------------------------------------give SAS Input File Name here -----------------------------------------------\nOutput must be in this format:\n#### Categories List \n#### **Global Counts**\n#### **Category-Level Counts**\n#### **Audit Details**"
                    },
                    "maxIter": 20,
                    "maxRpm": 0,
                    "maxExecutionTime": 0,
                    "tools": [],
                    "userTools": [],
                    "allowCodeExecution": false,
                    "isSafeCodeExecution": true
                }
            },
            {
                "serial": 2,
                "agent": {
                    "id": 3593,
                    "name": "DI_SASCode_Audit_Review",
                    "role": "Data Engineer",
                    "goal": "Verify the completeness and accuracy of the previous agent's validation of SAS code against Oracle best practices.",
                    "backstory": "This agent plays the role of a second-level reviewer to ensure that automated auditing of SAS\u2013Oracle standards was done correctly. It checks whether the audit table entries were all considered and verified against the SAS code, and flags any missing, misclassified, or incorrectly passed/failed audits.\n",
                    "verbose": true,
                    "allowDelegation": true,
                    "updatedAt": "2025-06-05T08:03:14.062331",
                    "llm": {
                        "modelDeploymentName": "gpt-4o",
                        "model": "gpt-4o",
                        "modelType": "Generative",
                        "aiEngine": "AzureOpenAI",
                        "topP": 0.949999988079071,
                        "maxToken": 4000,
                        "temperature": 0.30000001192092896,
                        "llmDeploymentName": "gpt-4o",
                        "apiKey": "****MASKED****",
                        "azureEndpoint": "https://avaplus-cognitive-account-int.openai.azure.com/",
                        "llmApiVersion": "2024-09-01-preview"
                    },
                    "task": {
                        "description": "## Instructions\nYou will receive:\n1. The original SAS code\n2. The original audit table with rules\n3. The output from the previous validation agent\n\nYour task is to verify whether the previous agent correctly evaluated all audit rules against the SAS code.\n\n## Verification Process\n1. Compare each audit rule from the audit table with the corresponding evaluation in the agent's output\n2. Verify that all audit rules were checked\n3. Confirm the accuracy of pass/fail determinations\n4. Validate that recommendations for failed audits are appropriate\n\n## Output Format\nProvide a simple, structured output with:\n\n### Verification Summary\n- Total audit rules in original table: [number]\n- Total audit rules evaluated by agent: [number]\n- Missing audit evaluations: [number]\n- Incorrect evaluations: [number]\n\n### Missing Evaluations\nList any audit IDs that were in the original table but not evaluated by the agent.\n\n### Incorrect Evaluations\nList any audit IDs where the agent's evaluation (pass/fail) appears incorrect based on the SAS code and audit criteria.\n\n### Recommendation Quality\nComment on whether the recommendations for failed audits are clear, specific, and actionable.\n\n### Overall Assessment\nProvide a brief statement on the overall quality and completeness of the previous agent's validation.\n\n## Input\n- Previous agent (DI_SAS_Oracle_Standards_Validator_with_Audit_Table) output as input for this agent which has the evaluated review of the sas code\n- Original SAS code: {{SAS_Code}}\n- Original audit table: {{Audit_Table}}\n",
                        "expectedOutput": "### Verification Summary\n### Missing Evaluations\n### Incorrect Evaluations\n### Recommendation Quality\n### Overall Assessment"
                    },
                    "maxIter": 20,
                    "maxRpm": 0,
                    "maxExecutionTime": 0,
                    "tools": [],
                    "userTools": [],
                    "allowCodeExecution": false,
                    "isSafeCodeExecution": true
                }
            }
        ],
        "enableAgenticMemory": false,
        "levelId": 99,
        "org": "Ascendion",
        "orgId": 1,
        "domain": "Data&Insights",
        "domainId": 96,
        "projectId": 98,
        "project": "AllProjects",
        "teamId": 99,
        "team": "AVA Team",
        "callbacks": []
    }
}