{
    "pipeline": {
        "pipelineId": 608,
        "name": " Fabric Data Engineer Bronze Layer",
        "description": "DE Pipeline for Bronze Layer",
        "createdAt": "2025-03-27T04:27:55.410+00:00",
        "pipeLineAgents": [
            {
                "serial": 1,
                "agent": {
                    "id": 322,
                    "name": "Fabric Bronze DE Pipeline",
                    "role": "Data Engineer",
                    "goal": "Define a detailed ingestion strategy for moving data from Source to the Bronze layer in Microsoft Fabric, ensuring efficient data ingestion, metadata tracking, and audit logging.",
                    "backstory": "The Bronze layer serves as a landing zone where raw, unprocessed data is stored in its original format. This layer ensures data availability for future reprocessing, auditing, and troubleshooting. Since data comes from multiple sources with different structures and formats, this agent must handle various ingestion scenarios while maintaining data integrity. The Bronze layer must also include metadata tracking for lineage and debugging.",
                    "verbose": true,
                    "allowDelegation": true,
                    "updatedAt": "2025-08-05T06:05:11.016644",
                    "llm": {
                        "modelDeploymentName": "gpt-4.1",
                        "model": "gpt-4",
                        "modelType": "Generative",
                        "aiEngine": "AzureOpenAI",
                        "topP": 0.949999988079071,
                        "maxToken": 8000,
                        "temperature": 0.30000001192092896,
                        "llmDeploymentName": "gpt-4.1",
                        "apiKey": "****MASKED****",
                        "azureEndpoint": "https://avaplus-cognitive-account-int.openai.azure.com/",
                        "llmApiVersion": "2025-01-01-preview"
                    },
                    "embedding": [
                        {
                            "aiEngine": "AzureOpenAI",
                            "chroma_end_point": "http://chromadb.da.svc.cluster.local",
                            "chroma_port": "80",
                            "index_collection": "fabricsparklimitations",
                            "embedding_model": "text-embedding-ada-002",
                            "embedding_deployment_name": "ava-text-embedding-ada-002",
                            "embedding_api_version": "2024-09-01-preview",
                            "embedding_api_key": "****MASKED****",
                            "embedding_azure_endpoint": "https://da-cognitive-account-demo.openai.azure.com/"
                        }
                    ],
                    "task": {
                        "description": "****MASKED****",
                        "expectedOutput": "Write the output in the Github and then fetch the file content in github and create the fabric notebook \n1. PySpark code for ingesting data into the Bronze layer.\n2. Logging details for data ingestion failures.\n3. Metadata tracking in the Bronze table.\n\n4. apiCost: float  // Cost consumed by the API for this call (in USD).\n    - Ensure the cost consumed by the API is mentioned with inclusive of all decimal value"
                    },
                    "maxIter": 0,
                    "maxRpm": 0,
                    "maxExecutionTime": 0,
                    "tools": [],
                    "userTools": [
                        {
                            "toolId": 300,
                            "toolName": "DI_Github_File_Writer_Z",
                            "toolClassName": "GitHubFileWriterTool",
                            "toolClassDef": "****MASKED****",
                            "isApproved": false
                        },
                        {
                            "toolId": 434,
                            "toolName": "DI_GitHub_To_Fabric_Notebook_Tool",
                            "toolClassName": "GitHubFabricNotebookTool",
                            "toolClassDef": "****MASKED****",
                            "isApproved": false
                        }
                    ],
                    "allowCodeExecution": false,
                    "isSafeCodeExecution": true
                }
            },
            {
                "serial": 2,
                "agent": {
                    "id": 814,
                    "name": "Fabric Pyspark Unit Test Case",
                    "role": "Data Engineer",
                    "goal": "Ensure the reliability and performance of PySpark applications in Microsoft Fabric by generating comprehensive unit test cases and a corresponding Pytest script. This will validate key functionalities, edge cases, and error handling in the provided PySpark code.",
                    "backstory": "Effective unit testing is essential for maintaining high-quality data pipelines in Microsoft Fabric. By implementing robust test cases, we can catch potential issues early in the development cycle, enhance maintainability, and prevent production failures. This testing framework will help validate data transformations and processing logic, ensuring that PySpark code runs efficiently in Fabric\u2019s Spark environment.",
                    "verbose": true,
                    "allowDelegation": true,
                    "updatedAt": "2025-06-25T09:19:08.530764",
                    "llm": {
                        "modelDeploymentName": "gpt-4.1",
                        "model": "gpt-4",
                        "modelType": "Generative",
                        "aiEngine": "AzureOpenAI",
                        "topP": 0.949999988079071,
                        "maxToken": 8000,
                        "temperature": 0.30000001192092896,
                        "llmDeploymentName": "gpt-4.1",
                        "apiKey": "****MASKED****",
                        "azureEndpoint": "https://avaplus-cognitive-account-int.openai.azure.com/",
                        "llmApiVersion": "2025-01-01-preview"
                    },
                    "task": {
                        "description": "You are tasked with creating unit test cases and a Pytest script for the given PySpark code that runs in Microsoft Fabric. Your expertise in PySpark testing methodologies, best practices, and Fabric-specific optimizations will be crucial in ensuring comprehensive test coverage.\n\nInstructions:\n1. Analyze the provided PySpark code to identify:\n* Key data transformations\n* Edge cases (e.g., empty DataFrames, null values, boundary conditions)\n* Error handling scenarios\n2. Design test cases covering:\n* Happy path scenarios\n* Edge cases (handling missing/null values, schema mismatches, etc.)\n* Exception scenarios (invalid data types, incorrect transformations)\n3. Use Microsoft Fabric-compatible PySpark testing techniques, including:\n* SparkSession setup and teardown in Fabric\u2019s distributed environment\n* Mocking external data sources within Fabric\u2019s Lakehouse\n* Performance testing in Fabric\u2019s Spark pools\n* Implement test cases using Pytest and Fabric-compatible PySpark testing utilities.\n* Ensure Fabric SparkSession is properly initialized and closed in test setup/teardown.\n* Use assertions to validate expected DataFrame outputs.\n* Follow PEP 8 coding style and ensure test scripts are well-commented.\n* Group related test cases into logical sections for maintainability.\n* Implement helper functions or fixtures to support Fabric-based Spark testing.\n\nGuideline:\n*Additionally, calculate and include the cost consumed by the API for this call in the output, explicitly mentioning the cost in USD. Don't consider the API cost as input and retrieve the cost of this API. \n*Ensure the cost consumed by the API is reported as a precise floating-point value, without rounding or truncation, until the first non-zero digit appears.\n*If the API returns the same cost across multiple calls, fetch real-time cost data or validate the calculation method.\n*Ensure that cost computation considers different agents and their unique execution parameters.\n*Mention the API Cost after the PySpark code ends.\n\ninput :\nUse the output of the previous agents PySpark code as input",
                        "expectedOutput": "1. Test Case List\nEach test case should include:\n*Test Case ID\n*Test Case Description\n*Expected Outcome\n2. Pytest Script\n*Fabric-optimized Pytest script with unit test cases for the PySpark code.\n*Ensures compatibility with Microsoft Fabric\u2019s Spark execution environment.\n\n* apiCost: float  // Cost consumed by the API for this call (in USD)\n*Ensure the cost consumed by the API is mentioned with inclusive of all decimal value"
                    },
                    "maxIter": 0,
                    "maxRpm": 0,
                    "maxExecutionTime": 0,
                    "tools": [],
                    "userTools": [],
                    "allowCodeExecution": false,
                    "isSafeCodeExecution": true
                }
            }
        ],
        "enableAgenticMemory": false,
        "levelId": 4,
        "org": "Ascendion",
        "orgId": 1,
        "domain": "Platform Engineering",
        "domainId": 2,
        "projectId": 3,
        "project": "AVA",
        "teamId": 4,
        "team": "Digital Ascender",
        "callbacks": []
    }
}