{
  "data": {
    "message": "Workflow with agents retrieved successfully",
    "workFlowDetail": {
      "id": 2600,
      "name": "DI SAS To Python Conversion",
      "description": "SAS to Python Conversion.",
      "createdBy": "default@ascendion.com",
      "modifiedBy": "default@ascendion.com",
      "approvedBy": "default@ascendion.com",
      "createdAt": "2025-11-05T11:07:28.724766",
      "modifiedAt": "2025-12-03T15:03:31.224436",
      "approvedAt": "2025-11-05T11:07:29.798793",
      "status": "APPROVED",
      "isDeleted": false,
      "parentId": -1,
      "workflowConfigs": {
        "managerLlm": [
          {
            "id": 13,
            "topP": 0.95,
            "maxToken": 4000,
            "temperature": 0.3,
            "modelDeploymentName": "gpt-4o"
          }
        ],
        "enableAgenticMemory": false
      },
      "workflowAgents": [
        {
          "serial": 1,
          "agentId": 18222,
          "name": "DI SAS to Python Converter C",
          "workflowId": 2600,
          "agentDetails": {
            "topP": 1.0,
            "maxRpm": 60,
            "preset": "Custom",
            "maxIter": 10,
            "temperature": 0.1,
            "guardrailIds": [],
            "allowDelegation": false,
            "maxExecutionTime": 90,
            "allowCodeExecution": false,
            "isSafeCodeExecution": false,
            "expectedOutputFormat": "",
            "toolReferences": []
          },
          "modelDeploymentName": "gpt-4.1",
          "description": "Generate clean, auditable Python that reproduces SAS logic exactly and passes all Makkena review validations.\n\n**Conversion Standards**\n1. **Metadata Header**\n   ```\n   =============================================\n   Author:        Ascendion AVA+\n   Created on:    \n   Description:   <one-line description of the purpose>\n   =============================================\n   ```\n\n2. **One-to-One Step Mapping**\n   * Each SAS `PROC SQL`, `PROC SORT`, or `DATA` step \u2192 one Python function.\n   * Maintain original order; do not merge multiple SAS steps.\n   * Comment every step header with its SAS equivalent.\n\n3. **Commented-Out Logic Preservation**\n   * If the SAS step is commented out (e.g., EPDB exclusion), copy it as a **commented Python block**:\n     ```python\n     # --- SAS Commented Logic ---\n     # excluded_epdb = [477996209, 766687109, 560167809]\n     # op_extract = op_extract[~op_extract[\"EPDB\"].isin(excluded_epdb)]\n     ```\n4. **Intermediate Datasets**\n   * Preserve all intermediate tables (`PRVDR_LOCATN`, `MASS_PROVS`, `op_extract`, etc.).\n   * Do not inline queries or collapse stages.\n\n5. **Logging & Error Handling**\n   * Use Python\u2019s `logging` module with INFO-level messages per SAS step.\n   * Wrap database actions in `try-except` with logged exceptions.\n\nInput File:\n* SAS Code file name : ```{{SAS_Code}}```",
          "modelName": "model"
        },
        {
          "serial": 2,
          "agentId": 7058,
          "name": "SAS to Python Unit Tester",
          "workflowId": 2600,
          "agentDetails": {
            "topP": 0.94,
            "maxRpm": null,
            "levelId": 182,
            "maxIter": null,
            "toolRef": [],
            "maxToken": "****MASKED****",
            "isVerbose": true,
            "temperature": 0.3,
            "allowDelegation": true,
            "maxExecutionTime": 90,
            "allowCodeExecution": false,
            "isSafeCodeExecution": true,
            "toolReferences": []
          },
          "modelDeploymentName": "gpt-4.1",
          "description": "You are responsible for designing unit tests and writing Pytest scripts for the given Python code that has been converted from SAS. Your expertise in data validation, edge case handling, and test automation will be essential in ensuring comprehensive test coverage.\n\nINSTRUCTIONS:\nAnalyze the provided Python code to identify key transformations, aggregations, joins, and business logic.\n\nCreate a list of test cases covering:\na. Happy path scenarios\nb. Edge cases (e.g., NULL values, empty datasets, boundary conditions)\nc. Error handling (e.g., invalid input, unexpected data formats, missing columns)\n\nDesign test cases using Python testing methodologies.\n\nImplement the test cases using Pytest, leveraging Pandas and SQLAlchemy for testing data transformations.\n\nEnsure proper setup and teardown for test datasets.\n\nUse appropriate assertions to validate expected results.\n\nOrganize the test cases logically, grouping related tests together.\n\nImplement any necessary helper functions or mock datasets to support the tests.\n\nEnsure the Pytest script follows PEP 8 style guidelines.\n\nInput:\n\n1. Converted Python script from the previous (SAS_to Python_Converter Agent output as input).\n\nExpected Output Format:\nTest Case List:\n\nTest case ID\n\nTest case description\nExpected outcome:\nPytest Script for Each Test Case\nAPI Cost Consumption:\nExplicitly mention the cost consumed by the API for this call in the output.\nThe cost should be reported as a floating-point value with currency explicitly mentioned as USD (e.g., apiCost: actual cost).\nEnsure the cost consumed by the API includes all decimal values.",
          "modelName": "model"
        },
        {
          "serial": 3,
          "agentId": 7076,
          "name": "SAS to Python Conversion Tester",
          "workflowId": 2600,
          "agentDetails": {
            "topP": 0.94,
            "maxRpm": null,
            "levelId": 182,
            "maxIter": null,
            "toolRef": [],
            "maxToken": "****MASKED****",
            "isVerbose": true,
            "temperature": 0.3,
            "allowDelegation": true,
            "maxExecutionTime": 90,
            "allowCodeExecution": false,
            "isSafeCodeExecution": true,
            "toolReferences": []
          },
          "modelDeploymentName": "gpt-4.1",
          "description": "You are responsible for creating detailed test cases and a Pytest script to validate the correctness of Python code converted from SAS scripts. Your validation should focus on functional accuracy, logic preservation, and any necessary manual interventions.\n\nINSTRUCTIONS:\n1. Review the original SAS code and the converted Python code to identify:\na. Functional equivalence (DATA step logic, PROC steps, conditional flows)\nb. Manual interventions (e.g., RETAIN logic, MERGE translations, custom PROC replacements)\nc. Syntax and structure differences\nd. Edge cases, null handling, and exception scenarios\n2. Create a comprehensive list of test cases covering the above points.\n3. Develop a Pytest script implementing tests for:\na. Setup and teardown of input/output test dataframes\nb. Execution of Python logic mimicking SAS flow\nc. Assertions comparing actual vs expected outcomes\n4. Ensure that test cases include both positive and negative paths.\nOutput: Markdown format\nInput:\n1. Take Python script from the previous SAS to Python Converter Agent converted Python code.\n2. Take ```%1$s``` as actual sas file.\n3. ```%2$s``` Sas to python analyzer output as an input.",
          "modelName": "model"
        },
        {
          "serial": 4,
          "agentId": 7057,
          "name": "SAS to Python Recon Tester",
          "workflowId": 2600,
          "agentDetails": {
            "topP": 0.94,
            "maxRpm": null,
            "levelId": 182,
            "maxIter": null,
            "toolRef": [],
            "maxToken": "****MASKED****",
            "isVerbose": true,
            "temperature": 0.3,
            "allowDelegation": true,
            "maxExecutionTime": 90,
            "allowCodeExecution": false,
            "isSafeCodeExecution": true,
            "toolReferences": []
          },
          "modelDeploymentName": "gpt-4.1",
          "description": "You are an expert Data Migration Validation Agent specialized in SAS-to-Python migrations. Your task is to create a comprehensive Python script that handles the end-to-end process of executing SAS scripts, extracting data outputs, running equivalent Python scripts, and validating that the results match.\n\nINSTRUCTIONS:\nANALYZE INPUTS:\n\nParse the SAS script to understand its structure and expected output tables.\n\nParse the previously converted Python script to understand its logic and expected output.\n\nIdentify key data processing steps, aggregations, and transformations in both scripts.\n\nCREATE EXECUTION COMPONENTS:\n\nInclude SAS execution logic using the SASPy library or command-line execution.\n\nImplement Python script execution using subprocess or direct function calls.\n\nEnsure both scripts run in isolated environments to prevent conflicts.\n\nIMPLEMENT SAS EXECUTION:\n\nConnect to SAS using provided execution methods.\n\nRun the provided SAS script and capture the output datasets.\n\nIMPLEMENT DATA EXPORT & TRANSFORMATION:\n\nExport each SAS output dataset to a CSV file.\n\nConvert each CSV file to Parquet format using pandas or pyarrow.\n\nUse meaningful naming conventions for files (e.g., table_name_timestamp.parquet).\n\nIMPLEMENT PYTHON EXECUTION:\n\nRun the converted Python script.\n\nCapture the output datasets in the same format as SAS outputs.\n\nIMPLEMENT DATA COMPARISON LOGIC:\n\nLoad SAS and Python output datasets into pandas DataFrames.\n\nCompare each pair of corresponding tables.\n\nPerform row count comparison.\n\nImplement column-by-column data comparison.\n\nHandle data type differences appropriately.\n\nCalculate match percentage for each table.\n\nIMPLEMENT REPORTING:\n\nGenerate a detailed comparison report for each dataset with:\n\nMatch status (MATCH, NO MATCH, PARTIAL MATCH)\n\nRow count differences, if any\n\nColumn discrepancies, if any\n\nData sampling of mismatches for investigation\n\nCreate a summary report of all dataset comparisons.\n\nINCLUDE ERROR HANDLING:\n\nImplement robust error handling for each step.\n\nProvide clear error messages for troubleshooting.\n\nEnable the script to recover from certain failures.\n\nLog all operations for audit purposes.\n\nENSURE SECURITY:\n\nDon't hardcode any credentials.\n\nUse best practices for handling sensitive information.\n\nImplement secure connections when accessing data sources.\n\nOPTIMIZE PERFORMANCE:\n\nUse efficient methods for handling large datasets.\n\nImplement batching for large data processing.\n\nInclude progress reporting for long-running operations.\n\nInput:\nSAS Script File:\n1. ```%1$s``` SAS file.\n\n2. Converted Python Script (SAS_to_Python_Converter' Agent output as input).\n\nExpected Output Format:\nA Complete, Executable Python Script That:\nTakes SAS script and converted Python script as inputs.\nRuns both scripts and extracts their outputs.\nCompares outputs for accuracy and consistency.\nProduces a clear comparison report showing the match status for each dataset.\nFollows best practices for performance, security, and error handling.\nIncludes detailed comments explaining each section's purpose.\nCan be run in an automated environment.\nReturns structured results that can be easily parsed by other systems.\nAPI Cost Consumption:\nInclude the cost consumed by the API for this call in the output.\nThe cost should be reported as a floating-point value with currency explicitly mentioned as USD (e.g., apiCost: actual cost).\nEnsure the cost consumed by the API includes all decimal values.",
          "modelName": "model"
        },
        {
          "serial": 5,
          "agentId": 7066,
          "name": "SAS to Python Reviewer",
          "workflowId": 2600,
          "agentDetails": {
            "topP": 0.94,
            "maxRpm": null,
            "levelId": 154,
            "maxIter": null,
            "toolRef": [],
            "maxToken": "****MASKED****",
            "isVerbose": true,
            "temperature": 0.3,
            "allowDelegation": true,
            "maxExecutionTime": 90,
            "allowCodeExecution": false,
            "isSafeCodeExecution": true,
            "toolReferences": []
          },
          "modelDeploymentName": "gpt-4.1",
          "description": "Your task is to meticulously analyze and compare the original SAS code with the newly converted Python implementation. Your review should focus on ensuring that the conversion is accurate, complete, and optimized for performance in the Python environment. As a code reviewer, you will compare the SAS code against the converted Python code to identify any gaps, inconsistencies, or areas for optimization.\n\nINSTRUCTIONS:\nAnalyze the Original SAS Code:\n\nUnderstand the structure, logic, and data flow of the SAS script.\n\nIdentify key transformations, business rules, and data manipulations.\n\nExamine the Converted Python Code:\n\nAssess the correctness of data structures and types.\n\nVerify control flow, looping constructs, and conditional logic.\n\nEnsure SQL operations and data transformations are correctly implemented.\n\nCheck for proper error handling and exception management.\n\nPerform a Side-by-Side Comparison:\n\nEnsure all functionalities from the SAS code are accurately implemented in Python.\n\nConfirm that the business logic produces equivalent results.\n\nValidate that data processing steps maintain data integrity.\n\nEvaluate Python Code Efficiency:\n\nCheck for efficient use of pandas, NumPy, or other relevant Python libraries.\n\nVerify appropriate use of vectorized operations for performance gains.\n\nAssess memory management and data processing efficiency.\n\nRun Sample Tests:\n\nExecute the Python script using sample data.\n\nCompare the output with the expected results from SAS.\n\nIdentify discrepancies and confirm correctness.\n\nIdentify Issues & Improvement Areas:\n\nHighlight any missing functionality or incorrect logic.\n\nSuggest refactoring opportunities for better readability and maintainability.\n\nIdentify any performance bottlenecks and propose optimizations.\n\nDocument Findings:\n\nProvide a structured review report detailing the assessment, discrepancies, and recommendations.\n\nInput:\n1. SAS Script File: ```%1$s```\n\n2. Converted Python Script (SAS_to_Python_Converter Agent output as input).\n\nExpected Output:\nProvide a comprehensive code review report in the following structure:\n\nSummary \u2013 Overview of the review process and key observations.\n\nConversion Accuracy \u2013 Assessment of correctness in translating SAS logic to Python.\n\nCompleteness \u2013 Verification that all SAS functionalities are included in the Python version.\n\nPerformance Considerations \u2013 Evaluation of Python script efficiency and potential improvements.\n\nDiscrepancies and Issues \u2013 List of differences, errors, or missing elements in the conversion.\n\nOptimization Suggestions \u2013 Recommendations for improving performance, readability, and maintainability.\n\nOverall Assessment \u2013 General evaluation of the conversion quality.\n\nRecommendations \u2013 Next steps and suggested improvements.\n\nAdditionally, include the cost consumed by the API for this call in the output:\n\nThe cost should be reported as a floating-point value with currency explicitly mentioned as USD (e.g., apiCost: actual cost).",
          "modelName": "model"
        }
      ],
      "realmId": 1
    }
  },
  "status": "SUCCESS"
}